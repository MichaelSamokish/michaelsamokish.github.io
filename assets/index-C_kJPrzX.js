var as=Object.defineProperty;var rs=(o,e,t)=>e in o?as(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var l=(o,e,t)=>rs(o,typeof e!="symbol"?e+"":e,t);import{d as H,g as xt,c as ae,r as ie,a as q,b as v,o as h,u as re,R as ls,e as w,f as p,_ as W,v as Mt,h as Ct,i as $,j as pt,k as De,w as ge,l as j,m as E,t as P,n as te,p as Se,F as J,q as Pe,s as O,x as Oe,y as Ye,z as Ot,T as us,A as ds,B as Gt,C as Lt,D as Qe,E as mt,G as Yt,H as $t,I as We,J as cs,K as hs,L as Pt,M as fs,N as ps,O as ms,P as vs,Q as gs,S as ws,V as Vs}from"./vendor-BstUOP3V.js";import{w as Et,F as T,i as ve,f as d,v as V,L as Ht,a as vt,b as Ee,d as Ze,m as U,n as Ut,c as tt,s as Ke,u as x,e as dt,g as yt,h as F,j as Wt,k as ue,p as ys,l as Je,o as Ss,q as st,r as ee,t as zt,M as Ft,D as It,P as qt,x as Nt,y as _s,z as bs,A as nt,B as Re,S as xs,C as Ms,E as Cs,G as Be,H as je,I as it,J as Ps,K as Is,W as Ns,N as ks,O as Os,Q as Ls,R as $s,T as Ts,U as Tt,V as Rs,X as at,Y as Ds,Z as ke,_ as ut,$ as As,a0 as ze,a1 as Bs,a2 as ye,a3 as Xs,a4 as St,a5 as Zt,a6 as ct,a7 as Fe,a8 as rt,a9 as qe,aa as Rt,ab as wt,ac as Gs,ad as Kt}from"./three-CJGEr-Sp.js";import{i as Ys}from"./icons-CNPGi31y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const Es={key:1,class:"gpu-error-box disable-user-select"},Hs={class:"gpu-error-message-box"},Us={style:{"font-size":"100px","text-align":"center",color:"var(--vt-c-red)"}},Ws=H({__name:"App",setup(o){const e=xt(),t=localStorage.getItem("userLang");t&&e!=null&&(e.appContext.config.globalProperties.$i18n.locale=t);const s=ae(()=>navigator.gpu);return(i,n)=>{const r=ie("font-awesome-icon");return s.value?(h(),q(re(ls),{key:0})):(h(),v("div",Es,[w("div",Hs,[w("div",Us,[p(r,{icon:["fas","circle-xmark"]})]),n[0]||(n[0]=w("h1",null,"WebGPU is not supported on this browser.",-1))])]))}}}),zs=W(Ws,[["__scopeId","data-v-286205d8"]]);class jt{constructor(){l(this,"Id",Mt());l(this,"In",null);l(this,"Out",null);l(this,"IsSelected",!1)}SetSelected(e){var s,i,n;var t=this.In!=null?(s=this.In.ParentNode)==null?void 0:s.ParentGraph:(n=(i=this.Out)==null?void 0:i.ParentNode)==null?void 0:n.ParentGraph;t!=null&&e==!0&&t.DeselectAll(),this.IsSelected=e}DeleteLinkFromTerminals(){var s,i;var e=(s=this.In)==null?void 0:s.Links.indexOf(this);e!=null&&this.In!=null&&this.In.Links.splice(e,1);var t=(i=this.Out)==null?void 0:i.Links.indexOf(this);t!=null&&this.Out!=null&&this.Out.Links.splice(t,1)}}class L{constructor(e,t){l(this,"X",0);l(this,"Y",0);this.X=e,this.Y=t}get Length(){return Math.sqrt(this.X*this.X+this.Y*this.Y)}get Normalized(){return L.Div(this,this.Length)}Reset(){this.X=0,this.Y=0}static Add(e,t){return t instanceof L?new L(e.X+t.X,e.Y+t.Y):typeof t=="number"?new L(e.X+t,e.Y+t):e}static Sub(e,t){return t instanceof L?new L(e.X-t.X,e.Y-t.Y):typeof t=="number"?new L(e.X-t,e.Y-t):e}static Mul(e,t){return t instanceof L?new L(e.X*t.X,e.Y*t.Y):typeof t=="number"?new L(e.X*t,e.Y*t):e}static Div(e,t){return t instanceof L?new L(e.X/t.X,e.Y/t.Y):typeof t=="number"?new L(e.X/t,e.Y/t):e}}var Jt=(o=>(o[o.none=0]="none",o[o.Buffer=1]="Buffer",o[o.Primitives=2]="Primitives",o[o.GeoPrimitives=3]="GeoPrimitives",o[o.Warps=4]="Warps",o[o.Adjastments=5]="Adjastments",o[o.Profile=6]="Profile",o[o.Filters=7]="Filters",o[o.Erosion=8]="Erosion",o[o.Snow=9]="Snow",o[o.Water=10]="Water",o[o.Data=11]="Data",o[o.Color=12]="Color",o[o.Render=13]="Render",o[o.Output=14]="Output",o))(Jt||{}),Ge=(o=>(o[o.NotCalculated=0]="NotCalculated",o[o.Calculation=1]="Calculation",o[o.Calculated=2]="Calculated",o))(Ge||{});class M{constructor(e,t,s,i=0,n=0,r="",u=""){l(this,"Name","");l(this,"Description","");l(this,"Value");l(this,"Min",-10);l(this,"Max",10);l(this,"Suffix");l(this,"Category");l(this,"Step");l(this,"valueList");l(this,"Default");this.Name=e,this.Value=t,this.Default=t,this.Min=typeof s=="number"?s:0,this.Max=i,this.Suffix=u,this.Category=r,this.Step=n,this.valueList=s instanceof Array?s:void 0}Reset(){this.Value=this.Default}}class ne{constructor(){l(this,"Id",Mt());l(this,"Position",new L(0,0));l(this,"LastPosition",new L(0,0));l(this,"Name","");l(this,"Category",Jt.none);l(this,"Properties");l(this,"Inputs",[]);l(this,"Outputs",[]);l(this,"IsSelected",!1);l(this,"Height",0);l(this,"Width",0);l(this,"IsCalculated",!1);l(this,"ParentGraph",null);l(this,"CalculationState",Ge.NotCalculated);l(this,"IsRealtimeUpdate",!1);l(this,"DefaultOutput",0)}Move(e,t){this.Position=new L(e,t)}SetSize(e,t){this.Height=e,this.Width=t}SetSelected(e){this.IsSelected=e;const t=Ce();e?t.SelectedNode=this:t.SelectedNode==this&&(t.SelectedNode=null)}SetLastPosition(e,t){this.LastPosition.X=e,this.LastPosition.Y=t}BaseCalculate(){this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,i;(i=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||i.SetNotCalculated()})}),this.Inputs.forEach(e=>{var t,s,i,n;e.IsConnected&&((s=(t=e.Links[0].In)==null?void 0:t.ParentNode)==null||s.Calculate(),(n=(i=e.Links[0].In)==null?void 0:i.ParentNode)==null||n.SetCalculated())})}SetNotCalculated(){this.CalculationState=Ge.NotCalculated,this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,i;(i=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||i.SetNotCalculated()})})}SetCalculated(){this.CalculationState=Ge.Calculated}Calculate(){}}class G{constructor(e,t,s){l(this,"Guid",Mt());l(this,"Links",new Array);l(this,"IsInput",!1);l(this,"ParentNode",null);l(this,"Position",new L(0,0));l(this,"OffsetPosition",new L(0,0));l(this,"Value",null);l(this,"Name","");this.ParentNode=t,this.IsInput=e,this.Name=s}get IsConnected(){return this.Links.length>0}SetOffset(e,t){this.OffsetPosition=new L(e,t)}SetPosition(e,t){this.Position=new L(e,t)}}const ht=Ct("drag",()=>{const o=$(!1),e=$(),t=$(),s=$();function i(r){s.value=r}function n(){return s.value}return{setNode:i,getNode:n,SourceTerminal:e,DestinationTerminal:t,IsDragging:o}}),Ce=Ct("nodes",()=>{const o=$(),e=$();return{SelectedNode:o,LockedNode:e}}),_e=Ct("renderer",()=>{const o=$(!1),e=$(),t=n=>{e.value=n},s=()=>e.value,i=$();return{ChangeEvent:o,Resolution:i,SetRenderer:t,GetRenderer:s}}),Fs=H({__name:"HeapMonitor",setup(o){const e=$(0),t=$(0),s=()=>{setInterval(i,1e3)};pt(()=>{s()});const i=()=>{performance&&performance.memory&&(e.value=performance.memory.usedJSHeapSize/1024/1024/1024,t.value=performance.memory.jsHeapSizeLimit/1024/1024/1024)};return(n,r)=>{const u=ie("font-awesome-icon"),c=De("tooltip");return h(),v("div",{onContextmenu:r[0]||(r[0]=ge(()=>{},["prevent"])),class:"memory-usage"},[j((h(),v("span",null,[p(u,{icon:["fas","memory"]}),E(" "+P(e.value.toFixed(2))+" / "+P(t.value.toFixed(2))+" ",1),r[1]||(r[1]=w("span",null," GB",-1))])),[[c,"Heap memory usage",void 0,{up:!0}]])],32)}}}),qs=W(Fs,[["__scopeId","data-v-72365581"]]),Zs={class:"status-bar-grid disable-user-select"},Ks={class:"working-status"},js=H({__name:"StatusBar",setup(o){_e();const e=$(0);return ae(()=>e.value),(t,s)=>{const i=ie("font-awesome-icon");return h(),v("div",Zs,[w("div",Ks,[p(i,{icon:["fas","bars-progress"]}),s[0]||(s[0]=E(" Idle "))]),w("div",null,[p(qs)])])}}}),Js=W(js,[["__scopeId","data-v-ddd0f7cf"]]),Qs={class:"collapse"},eo={class:"carete"},to={key:0,class:"collapse-body"},so=H({__name:"Collapse",setup(o){var e=$(!1);const t=()=>{e.value=!e.value};return(s,i)=>{const n=ie("font-awesome-icon");return h(),v("div",Qs,[w("div",{onClick:t,class:"header"},[w("div",eo,[re(e)?(h(),q(n,{key:0,icon:["fas","angle-right"]})):(h(),q(n,{key:1,icon:["fas","angle-down"]}))]),Se(s.$slots,"header",{},void 0,!0)]),re(e)?te("",!0):(h(),v("div",to,[Se(s.$slots,"default",{},void 0,!0)]))])}}}),Qt=W(so,[["__scopeId","data-v-ed8ad461"]]),lt=T(([o])=>{const e=V(o).toVar();e.assign(e.modInt(d(289)));const t=d(d(34).mul(e.x).add(1).mul(e.x).modInt(289).add(e.y)).toVar();return t.assign(d(34).mul(t).add(d(1)).mul(t).modInt(289)),t.assign(Ee(t.div(d(41))).mul(d(2)).sub(1)),Ut(V(t.sub(vt(t.add(.5))),tt(t).sub(.5)))}).setLayout({name:"gradientNoiseDir",type:"vec2",inputs:[{name:"p",type:"vec2"}]}),oo=T(([o])=>{const e=V(o).toVar(),t=V(vt(e)).toVar(),s=V(Ee(e)).toVar(),i=d(Ze(lt(t),s)).toVar(),n=d(Ze(lt(t.add(V(d(0),d(1)))),s.sub(V(d(0),d(1))))).toVar(),r=d(Ze(lt(t.add(V(d(1),d(0)))),s.sub(V(d(1),d(0))))).toVar(),u=d(Ze(lt(t.add(V(d(1),d(1)))),s.sub(V(d(1),d(1))))).toVar();return s.assign(s.mul(s).mul(s).mul(s.mul(s.mul(d(6)).sub(d(15))).add(d(10)))),U(U(i,n,s.y),U(r,u,s.y),s.x)}).setLayout({name:"gradientNoise",type:"float",inputs:[{name:"p",type:"vec2"}]}),es=T(([o])=>oo(o).add(.5)),kt=T(([o,e,t,s])=>{const i=ve(e).toVar(),n=d(s).toVar(),r=V(t.x,t.y).toVar(),u=V(o.x,o.y).sub(d(.5)).mul(n).toVar();u.addAssign(r);const c=d(0).toVar(),a=d(1).div(2).toVar();return Ht(i,({i:f})=>{const m=u.mul(d(2).pow(d(f))).toVar(),g=es(m).mul(a).toVar();a.divAssign(2),c.addAssign(g)}),c}).setLayout({name:"perlinNoise",type:"float",inputs:[{name:"UV",type:"vec2"},{name:"octaves",type:"int"},{name:"offset",type:"vec2"},{name:"scale",type:"float"}]}),no=Et(`
fn cracks(uv: vec2<f32>, angle: f32, scale: f32, thickness: f32) -> f32  {
	let st: vec2<f32> = (uv - 0.5) * scale;
	let i_st: vec2<f32> = floor(st);
	let f_st: vec2<f32> = fract(st);
	var m1: f32 = 1.;
	var m2: f32 = 1.;

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let neighbor: vec2<f32> = vec2<f32>(x, y);
			var point: vec2<f32> = random2(i_st + neighbor);
			point = 0.5 + 0.5 * sin(angle + 6.2831 * point);
			let diff: vec2<f32> = neighbor + point - f_st;
			let dist: f32 = length(diff);
			let cond: f32 = step(dist, m1);
			m2 = mix(min(max(m1, dist), m2), m1, cond);
			m1 = mix(m1, dist, cond);
		}

	}

	let edge: f32 = smoothstep(0.01, thickness, m2 - m1);
	return edge;
} 

fn random2(p: vec2<f32>) -> vec2<f32> {
	return fract(sin(vec2<f32>(dot(p, vec2<f32>(127.1, 311.7)), dot(p, vec2<f32>(269.5, 183.3)))) * 43758.547);
} 
`),Vt=Et(`
fn voronoi(UV: vec2<f32>, angleOffset: f32, cellDensity: f32) -> vec2<f32> {
	let g: vec2<f32> = floor((UV - 0.5) * cellDensity);
	let f: vec2<f32> = fract((UV - 0.5) * cellDensity);
	var res: vec3<f32> = vec3<f32>(8., 0., 0.);

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let lattice: vec2<f32> = vec2<f32>(x, y);
			let offset: vec2<f32> = voronoiNoiseRandomVector(lattice + g, angleOffset);
			let d: f32 = distance(lattice + offset, f);
			res = mix(res, vec3<f32>(d, offset.x, offset.y), step(d, res.x));
		}

	}

	return vec2<f32>(res.x, res.y);
} 

fn voronoiNoiseRandomVector(UV: vec2<f32>, offset: f32) -> vec2<f32> {
	var UV_var = UV;
	let m: mat2x2<f32> = mat2x2<f32>(15.27, 47.63, 99.41, 89.98);
	UV_var = fract(sin(UV_var * m) * 46839.32);
	return vec2<f32>(sin(UV_var.y * offset) * 0.5 + 0.5, cos(UV_var.x * offset) * 0.5 + 0.5);
}
`);class io extends ne{constructor(){super(...arguments);l(this,"Name","nodes.perlinNoise");l(this,"Outputs",[new G(!1,this,"Output")]);l(this,"Properties",[new M("Scale",10,0,100,0,"Transform","%"),new M("Octaves Count",10,1,50,1,"Noise",""),new M("Offset X",0,-100,100,0,"Transform",""),new M("Offset Y",0,-100,100,0,"Transform",""),new M("Warp Scale",0,0,1,.001,"Warp","%"),new M("Seed",0,0,99999,0,"Random",""),new M("Height",.4,0,1,0,"Noise","")]);l(this,"IsRealtimeUpdate",!0);l(this,"DefaultOutput",0);l(this,"Random",T(([t])=>{const s=V(t).toVar();return Ee(Ke(Ze(s,V(12.9898,78.233))).mul(43758.5453))}))}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value);x(this.Properties[4].Value);const r=x(this.Properties[5].Value),u=x(this.Properties[6].Value);this.Outputs[0].Value=T(([c])=>{const a=V(c.x,c.y).toVar();return a.addAssign(this.Random(V(r).mul(r))),kt(a,s,V(i,n),t).mul(u)})}}const ao=H({__name:"DraggableNode",props:{GraphNode:{type:Function,required:!0}},setup(o){const e=ht(),t=o,s=$(),i=a=>{var m;if((m=a.dataTransfer)==null||m.setData("string","1"),t.GraphNode!=null&&t.GraphNode!=null){var f=t.GraphNode;e.setNode(new f)}};var n=void 0;const r=a=>{var g;n=(g=s.value)==null?void 0:g.cloneNode(!0);var f=n.getBoundingClientRect();if(n.style.position="fixed",n.style.left=`${a.touches[0].pageX-f.width/2}px`,n.style.top=`${a.touches[0].pageY-f.height/2}px`,n.style.zIndex="1000",document.body.appendChild(n),t.GraphNode!=null&&t.GraphNode!=null){var m=t.GraphNode;e.setNode(new m)}},u=a=>{if(n!=null){var f=n.getBoundingClientRect();n.style.left=`${a.touches[0].pageX-f.width/2}px`,n.style.top=`${a.touches[0].pageY-f.height/2}px`}},c=a=>{if(n!=null){document.body.removeChild(n),n=void 0,a.preventDefault(),a.stopPropagation();var f=a.changedTouches[0],m=document.elementFromPoint(f.clientX,f.clientY);console.log(m)}};return window.addEventListener("touchmove",u),window.addEventListener("touchend",c),(a,f)=>(h(),v("div",{onTouchstart:r,onDragstart:i,draggable:"true",class:"node",ref_key:"selfEl",ref:s},[Se(a.$slots,"default",{},void 0,!0)],544))}}),ro=W(ao,[["__scopeId","data-v-ee47cd3c"]]);class Q{static register(e){var t=new e;this.classMap.set(t.constructor.name,e)}static registerStr(e,t,s){this.classMap.set(e,s),this.groupsMap.has(t)||this.groupsMap.set(t,new Map);var i=this.groupsMap.get(t);i==null||i.set(e,s)}static create(e,...t){const s=this.classMap.get(e);if(!s)throw new Error(`Class ${e} not registered`);return new s(...t)}static getGroups(){return this.groupsMap}}l(Q,"classMap",new Map),l(Q,"groupsMap",new Map);const lo={class:"node-list"},uo=H({__name:"NodeList",setup(o){var e=Q.getGroups();return(t,s)=>{const i=ie("font-awesome-icon");return h(),v("div",lo,[(h(!0),v(J,null,Pe(re(e),([n,r])=>(h(),v(J,null,[n!=""?(h(),q(Qt,{key:0},{header:O(()=>[E(P(t.$t(n)),1)]),default:O(()=>[(h(!0),v(J,null,Pe(r,([u,c])=>(h(),q(ro,{"-graph-node":c},{default:O(()=>[p(i,{icon:["fas","circle-nodes"]}),E(" "+P(t.$t(u)),1)]),_:2},1032,["-graph-node"]))),256))]),_:2},1024)):te("",!0)],64))),256))])}}}),co=W(uo,[["__scopeId","data-v-ff1a0b3e"]]),ho={class:"padding"},fo={class:"header disable-user-select"},po={class:"body disable-user-select"},mo=H({__name:"FrameTab",props:{wheelFocus:{type:Boolean,default:!0}},setup(o){const e=o,t=$(),s=i=>{t.value&&e.wheelFocus&&t.value.focus()};return(i,n)=>(h(),v("div",ho,[w("div",{class:"main",tabindex:"0",ref_key:"selfEl",ref:t,onWheel:s},[w("div",fo,[Se(i.$slots,"header",{},void 0,!0)]),w("div",po,[Se(i.$slots,"default",{},void 0,!0)])],544)]))}}),ft=W(mo,[["__scopeId","data-v-bce70494"]]);class Dt{static pathExists(e,t){if(e===t)return!0;const s=new Set;return this.dfs(e,t,s)}static dfs(e,t,s){if(e===t)return!0;if(s.has(e))return!1;s.add(e);for(const i of e.Outputs)for(const n of i.Links)if(n.Out!=null&&n.Out!=null){const r=n.Out.ParentNode;if(this.dfs(r,t,s))return!0}return!1}}const vo=H({__name:"TerminalRenderer",props:{Term:{type:G,required:!0}},setup(o,{expose:e}){const t=ht(),s=o,i=f=>{t.SourceTerminal=s.Term,t.IsDragging=!0,window.addEventListener("mouseup",n)},n=f=>{var S,y,b;window.removeEventListener("mouseup",n),t.IsDragging=!1;var m=t.DestinationTerminal,g=t.SourceTerminal;if(m!=null&&m!=g&&!(g!=null&&g.IsInput&&m.IsInput)&&(g==null?void 0:g.ParentNode)!=m.ParentNode){if(g!=null&&g.IsInput){if(Dt.pathExists(g==null?void 0:g.ParentNode,m.ParentNode))return;g.Links.forEach(I=>{var B,oe;(oe=(B=g==null?void 0:g.ParentNode)==null?void 0:B.ParentGraph)==null||oe.DeleteLink(I)})}if(m.IsInput){if(Dt.pathExists(m==null?void 0:m.ParentNode,g==null?void 0:g.ParentNode))return;m.Links.forEach(I=>{var B,oe;(oe=(B=m==null?void 0:m.ParentNode)==null?void 0:B.ParentGraph)==null||oe.DeleteLink(I)})}(y=(S=s.Term.ParentNode)==null?void 0:S.ParentGraph)==null||y.AddLink(m,g);var C=_e();(b=s.Term.ParentNode)!=null&&b.IsRealtimeUpdate&&(C.ChangeEvent=!C.ChangeEvent)}},r=f=>{t.IsDragging&&(t.DestinationTerminal=s.Term)},u=f=>{t.IsDragging&&(t.DestinationTerminal=null)},c=$();pt(()=>{Oe(()=>{a()})});const a=()=>{var g,C,S,y;var f=((g=c.value)==null?void 0:g.offsetLeft)+((C=c.value)==null?void 0:C.offsetWidth)/2+2,m=((S=c.value)==null?void 0:S.offsetTop)+((y=c.value)==null?void 0:y.offsetHeight)/2+2;s.Term.SetOffset(f,m)};return e({SetOffset:a}),(f,m)=>{const g=De("tooltip");return j((h(),v("div",{class:Ye(["node-terminal",{connected:s.Term.IsConnected},"disable-user-select"]),onMousedown:[m[0]||(m[0]=ge(()=>{},["right","stop"])),ge(i,["left"])],onMouseover:r,onMouseleave:u,ref_key:"selfEl",ref:c},null,34)),[[g,{content:s.Term.Name,placement:s.Term.IsInput?"left":"right"}]])}}}),At=W(vo,[["__scopeId","data-v-278bc81c"]]);class Xe extends ne{constructor(){super(...arguments);l(this,"Name","nodes.buffer");l(this,"Inputs",[new G(!0,this,"")]);l(this,"Outputs",[new G(!1,this,"")])}Calculate(){this.BaseCalculate();var t=this.Inputs[0].Links[0].In,s=this.Outputs[0];s.Value=t==null?void 0:t.Value}}const go={},wo={class:"loader"};function Vo(o,e){return h(),v("span",wo)}const ts=W(go,[["render",Vo],["__scopeId","data-v-8c5c5c6f"]]);class ss{constructor(){l(this,"IsSubGraph",!1);l(this,"Nodes",new Array);l(this,"Links",new Array)}get HasSelected(){return this.Nodes.some(e=>e.IsSelected)||this.Links.some(e=>e.IsSelected)}AddNode(e,t=!0){var s=this.Nodes.indexOf(e);s==-1&&(e.ParentGraph=this,this.Nodes.push(e),t&&Ve.PushState(this))}DeleteLink(e,t=!0){var s=this.Links.indexOf(e);s!=-1&&(e.DeleteLinkFromTerminals(),this.Links.splice(s,1),t&&Ve.PushState(this))}AddLink(e,t,s=!0){if(!(e.IsInput&&t.IsInput||!e.IsInput&&!t.IsInput)){var i=new jt;e.IsInput?(i.In=t,i.Out=e):(i.In=e,i.Out=t),t.Links.push(i),e.Links.push(i),this.Links.push(i),s&&Ve.PushState(this)}}DeleteNode(e,t=!0){if(e!=null){var s=Ce();s.SelectedNode==e&&(s.SelectedNode=null),s.LockedNode==e&&(s.LockedNode=null),e.Inputs.forEach(n=>{var r=n.Links.map(u=>u);r.forEach(u=>{this.DeleteLink(u)})}),e.Outputs.forEach(n=>{var r=n.Links.map(u=>u);r.forEach(u=>{this.DeleteLink(u)})});var i=this.Nodes.indexOf(e);i!=-1&&this.Nodes.splice(i,1),t&&Ve.PushState(this)}}DeleteSelected(e=!0){this.Nodes.filter(s=>s.IsSelected).forEach(s=>this.DeleteNode(s,!1));var t=Ce();t.SelectedNode=void 0,this.Links.filter(s=>s.IsSelected).forEach(s=>this.DeleteLink(s,!1)),e&&Ve.PushState(this)}DeselectAll(){var e=Ce();e.SelectedNode=void 0,this.Nodes.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1)),this.Links.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1))}SelectAll(){this.Nodes.forEach(e=>e.SetSelected(!0))}}class et{static Serialize(e){var r,u,c,a,f,m,g,C;var t=new yo;if(e.Nodes!=null&&e.Nodes.length>0)for(const S of e.Nodes){var s=new So;if(s.NodeType=S.Name,s.NodeGuid=S.Id,s.NodePostition=S.Position,S.Properties!=null&&S.Properties.length>0)for(const y of S.Properties){var i=new _o;i.Value=y.Value,s.Properties==null&&(s.Properties=new Array),s.Properties.push(i)}t.Nodes==null&&(t.Nodes=new Array),t.Nodes.push(s)}if(e.Links!=null&&e.Links.length>0)for(const S of e.Links){var n=new bo;n.FromNodeGuid=(u=(r=S.In)==null?void 0:r.ParentNode)==null?void 0:u.Id,n.ToNodeGuid=(a=(c=S.Out)==null?void 0:c.ParentNode)==null?void 0:a.Id,n.FromTerminalIndex=(m=(f=S.In)==null?void 0:f.ParentNode)==null?void 0:m.Outputs.indexOf(S.In),n.ToTerminalIndex=(C=(g=S.Out)==null?void 0:g.ParentNode)==null?void 0:C.Inputs.indexOf(S.Out),t.Links==null&&(t.Links=new Array),t.Links.push(n)}return t}static Deserialize(e){var t=new ss;if(e.Nodes!=null&&e.Nodes.length>0)for(var s of e.Nodes){var i=Q.create(s.NodeType);if(i.Id=s.NodeGuid,i.Move(s.NodePostition.X,s.NodePostition.Y),s.Properties!=null&&s.Properties.length>0)for(var n=0;n<s.Properties.length;n++)i.Properties[n].Value=s.Properties[n].Value;t.AddNode(i,!1)}if(e.Links!=null&&e.Links.length>0)for(var r of e.Links){var u=Ot(t.Nodes).firstOrDefault(a=>a.Id==r.FromNodeGuid),c=Ot(t.Nodes).firstOrDefault(a=>a.Id==r.ToNodeGuid);u==null||c==null||t.AddLink(u.Outputs[r.FromTerminalIndex],c.Inputs[r.ToTerminalIndex],!1)}return t}}class yo{constructor(){l(this,"Nodes");l(this,"Links")}static ToJson(e){return JSON.stringify(e)}}class So{constructor(){l(this,"NodeGuid");l(this,"NodeType");l(this,"NodePostition");l(this,"Properties")}}class _o{constructor(){l(this,"Value")}}class bo{constructor(){l(this,"FromNodeGuid");l(this,"ToNodeGuid");l(this,"FromTerminalIndex");l(this,"ToTerminalIndex")}}class xo{constructor(e){l(this,"buffer");l(this,"capacity");l(this,"head",0);l(this,"tail",0);l(this,"size",0);l(this,"poppedItems",[]);if(e<=0)throw new Error("Capacity must be greater than 0");this.capacity=e,this.buffer=new Array(e)}get hasValues(){return this.size>0}get hasPoppedItems(){return this.poppedItems.length>0}push(e){this.poppedItems=[],this.size===this.capacity?(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.head=(this.head+1)%this.capacity):(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++)}pop(){if(!this.hasValues)return;this.tail=(this.tail-1+this.capacity)%this.capacity;const e=this.buffer[this.tail];return this.size--,this.poppedItems.push(e),e}unpop(){if(!this.hasPoppedItems)return;const e=this.poppedItems.pop();return this.size===this.capacity&&(this.head=(this.head+1)%this.capacity),this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++,e}toArray(){const e=[];for(let t=0;t<this.size;t++){const s=(this.head+t)%this.capacity;e.push(this.buffer[s])}return e}peek(){if(this.hasValues)return this.buffer[(this.tail-1+this.capacity)%this.capacity]}get length(){return this.size}}class Ve{static get HasValues(){return this.ActionHistoryBuffer.hasValues}static get HasPopped(){return this.ActionHistoryBuffer.hasPoppedItems}static PushState(e){this.ActionHistoryBuffer.push(et.Serialize(e))}static UnpopState(){if(this.ActionHistoryBuffer.hasPoppedItems){var e=this.ActionHistoryBuffer.unpop();return et.Deserialize(e)}return null}static PopState(){if(this.ActionHistoryBuffer.hasValues){var e=this.ActionHistoryBuffer.pop();return et.Deserialize(e)}return null}}l(Ve,"ActionHistoryBuffer",new xo(25));class _t{constructor(e,t,s,i){l(this,"X",0);l(this,"Y",0);l(this,"Height",0);l(this,"Width",0);this.X=e,this.Y=t,this.Height=s,this.Width=i}ContainsRect(e){return this.X<=e.X&&e.X+e.Width<=this.X+this.Width&&this.Y<=e.Y&&e.Y+e.Height<=this.Y+this.Height}ContainsPoint(e,t){return this.X<=e&&e<this.X+this.Width&&this.Y<=t&&t<this.Y+this.Height}IntersectsWith(e){return e.X<this.X+this.Width&&this.X<e.X+e.Width&&e.Y<this.Y+this.Height&&this.Y<e.Y+e.Height}static Intersects(e,t){return e.X<t.X+t.Width&&t.X<e.X+e.Width&&e.Y<t.Y+t.Height&&t.Y<e.Y+e.Height}}const Mo=H({__name:"ContextMenu",props:{CloseOnAnyClick:{type:Boolean,default:!0},CloseOnMouseOut:{type:Boolean,default:!0}},emits:["lost-focus"],setup(o,{expose:e,emit:t}){const s=$(!1),i=$(),n=t,r=o,u=y=>{s.value=!0,Oe(()=>{i.value!=null&&i.value!=null&&(i.value.style.left=y.pageX+"px",i.value.style.top=y.pageY+"px",a(),window.addEventListener("mousedown",S))})},c=y=>{Oe(()=>{i.value!=null&&(i.value.style.width=y+"px")})},a=()=>{if(i.value!=null&&i.value!=null){const b=i.value.getBoundingClientRect();if(b.y+b.height>window.innerHeight){var y=b.y+b.height-window.innerHeight;i.value.style.top=b.y-y+"px"}if(b.y<0&&(i.value.style.top="0px"),b.x+b.width>window.innerWidth){var y=b.x+b.width-window.innerWidth;i.value.style.left=b.x-y+"px"}b.x<0&&(i.value.style.left="0px")}},f=y=>{s.value=!0,Oe(()=>{if(i.value!=null&&i.value!=null){var b=y.getBoundingClientRect();i.value.style.left=b.x+"px",i.value.style.top=b.y+b.height+"px",a(),window.addEventListener("mousedown",S)}})},m=y=>{s.value=!0,Oe(()=>{if(i.value!=null&&i.value!=null){var b=y.getBoundingClientRect(),I=i.value.getBoundingClientRect();i.value.style.left=b.x-I.width+"px",i.value.style.top=b.y+"px",a(),window.addEventListener("mousedown",S)}})},g=y=>{s.value=!0,Oe(()=>{if(i.value!=null&&i.value!=null){var b=y.getBoundingClientRect();i.value.style.left=b.x+b.width+"px",i.value.style.top=b.y+"px",a(),window.addEventListener("mousedown",S)}})},C=()=>{window.removeEventListener("mousedown",S),s.value=!1},S=y=>{if(r.CloseOnMouseOut&&i.value!=null){var b=i.value.getBoundingClientRect(),I=new _t(b.x,b.y,b.height,b.width);I.ContainsPoint(y.clientX,y.clientY)||(s.value=!1,window.removeEventListener("mousedown",S),n("lost-focus"))}};return e({Open:u,Close:C,OpenUnder:f,OpenLeft:m,OpenRight:g,SetWidth:c,isOpened:s}),(y,b)=>(h(),q(ds,{name:"open"},{default:O(()=>[(h(),q(us,{to:"body"},[s.value?(h(),v("div",{key:0,onContextmenu:b[0]||(b[0]=ge(()=>{},["prevent"])),onMousedown:b[1]||(b[1]=ge(()=>{},["stop"])),ref_key:"ContextMenu",ref:i,class:"context-menu disable-user-select"},[Se(y.$slots,"default",{},void 0,!0)],544)):te("",!0)]))]),_:3}))}}),ot=W(Mo,[["__scopeId","data-v-bc41e1a3"]]),Co=H({__name:"ContextMenuItem",props:{Active:{type:Boolean,default:!1}},setup(o){return(e,t)=>(h(),v("button",{class:Ye([["btn",{active:o.Active}],"btn"]),style:{padding:"5px"}},[Se(e.$slots,"default",{},void 0,!0)],2))}}),we=W(Co,[["__scopeId","data-v-3e13e567"]]),Po={class:"node-container"},Io={class:"node-terminals left"},No={class:"node-center"},ko={class:"node-name"},Oo={class:"node-terminals right"},Lo=H({props:{Offset:{type:L,required:!0},Zoom:{type:Number,required:!0},Node:{type:ne,required:!0},AllNodes:{type:Array,default:new Array}},data(){return{LastMousePosition:new L(0,0),IsDragging:!1,ContextMenu:!1}},created:function(){window.addEventListener("mousemove",this.OnMouseMove),window.addEventListener("mouseup",this.OnMouseUp)},mounted:function(){this.$nextTick(()=>{var o=this.$el;this.Node.SetSize(o.offsetHeight,o.offsetWidth),this.Node.Move(this.Node.Position.X-this.Node.Width/2,this.Node.Position.Y-this.Node.Height/2);var e=new ResizeObserver(this.OnNodeResize);e.observe(this.$refs.node)})},computed:{PriviewLocked:function(){var o=Ce();return o.LockedNode==this.Node},Top:function(){var o=this.Node.Position.Y;return o+"px"},Left:function(){var o=this.Node.Position.X;return o+"px"},Cursor:function(){return this.IsDragging?"grabbing":"default"},ZIndex:function(){return this.Node.IsSelected?"1":"0"},Blur:function(){return 4/this.Zoom+"px"},Border:function(){return this.Node.IsCalculated?"solid":"dashed"},IsNodeLocked:function(){var o=Ce(),e=o.LockedNode;return e!=null&&e==this.Node}},methods:{OpenContextMenu(o){this.$refs.contextMenu.Open(o)},CloseContextMenu(){this.$refs.contextMenu.Close()},OnNodeResize:function(){if(this.$refs.terminals!=null){var o=this.$refs.terminals;o.forEach(e=>{e.SetOffset()})}},LockNode:function(){var o=Ce(),e=_e();o.LockedNode==this.Node?o.LockedNode=null:(o.LockedNode=this.Node,this.Node.SetSelected(!0),e.ChangeEvent=!e.ChangeEvent)},Down:function(o,e,t){var i,n,r,u,c;if(this.IsDragging=!0,this.LastMousePosition.X=o,this.LastMousePosition.Y=e,t)this.Node.SetSelected(!((i=this.Node)!=null&&i.IsSelected));else{var s=(n=this.Node.ParentGraph)==null?void 0:n.Nodes.filter(a=>a.IsSelected);s.length>1?this.Node.IsSelected==!1&&((r=this.Node.ParentGraph)==null||r.DeselectAll(),this.Node.SetSelected(!0)):((u=this.Node.ParentGraph)==null||u.DeselectAll(),this.Node.SetSelected(!0))}(c=this.Node.ParentGraph)==null||c.Nodes.filter(a=>a.IsSelected).forEach(a=>{a.SetLastPosition(a.Position.X,a.Position.Y)}),Ve.PushState(this.Node.ParentGraph)},OnTouchDown:function(o){if(this.$refs.terminals!=null&&this.$refs.terminals.some(s=>s.$el==o.target||s==o.target))return;let e=o.touches[0].clientX,t=o.touches[0].clientY;this.Down(e,t,!1)},OnMouseDown:function(o){this.$refs.terminals!=null&&this.$refs.terminals.some(e=>e.$el==o.target||e==o.target)||this.Down(o.clientX,o.clientY,o.shiftKey)},OnMouseUp:function(o){this.IsDragging=!1},OnTouchUp:function(o){this.IsDragging=!1},OnTouchMove:function(o){let e=o.touches[0].clientX,t=o.touches[0].clientY;this.Move(e,t)},Move:function(o,e){var i;if(this.IsDragging){var t=(o-this.LastMousePosition.X)/this.Zoom,s=(e-this.LastMousePosition.Y)/this.Zoom;(i=this.Node.ParentGraph)==null||i.Nodes.filter(n=>n.IsSelected).forEach(n=>{n.Move(n.LastPosition.X+t,n.LastPosition.Y+s)})}},OnMouseMove:function(o){this.Move(o.clientX,o.clientY)}}}),$o=H({...Lo,__name:"NodeRenderer",setup(o){return Gt(e=>({"565ed938":e.Cursor,f3d0d29a:e.Top,"3cd77669":e.Left,"7b303a5a":e.ZIndex})),(e,t)=>{const s=ie("font-awesome-icon"),i=De("tooltip");return h(),v("div",{class:Ye([{node:!(e.Node instanceof re(Xe))},{"node-buffer":e.Node instanceof re(Xe)},"disable-user-select",{"not-calculated":e.Node.CalculationState==re(Ge).NotCalculated&&!(e.Node instanceof re(Xe))},{selected:e.Node.IsSelected},{lockedPreview:e.PriviewLocked},{"node-without-inputs":e.Node.Inputs.length==0}]),ref:"node",onMousedown:[t[3]||(t[3]=ge((...n)=>e.OnMouseDown&&e.OnMouseDown(...n),["left"])),t[7]||(t[7]=ge((...n)=>e.OpenContextMenu&&e.OpenContextMenu(...n),["right"]))],onTouchmove:t[4]||(t[4]=(...n)=>e.OnTouchMove&&e.OnTouchMove(...n)),onTouchstart:t[5]||(t[5]=(...n)=>e.OnTouchDown&&e.OnTouchDown(...n)),onTouchend:t[6]||(t[6]=(...n)=>e.OnTouchUp&&e.OnTouchUp(...n))},[w("div",Po,[w("div",Io,[(h(!0),v(J,null,Pe(e.Node.Inputs,n=>(h(),q(At,{ref_for:!0,ref:"terminals",key:n.Guid,Term:n},null,8,["Term"]))),128))]),w("div",No,[e.Node instanceof re(Xe)?te("",!0):(h(),v(J,{key:0},[j((h(),v("a",{class:"lock-icon",onClick:t[0]||(t[0]=n=>e.LockNode())},[e.IsNodeLocked?(h(),q(s,{key:0,icon:["fas","lock"]})):(h(),q(s,{key:1,icon:["fas","lock-open"]}))])),[[i,{content:e.$t("tt.lockPreview"),placement:"bottom"}]]),w("div",ko,P(e.$t(e.Node.Name)),1),e.Node.CalculationState==re(Ge).Calculation?(h(),q(ts,{key:0})):te("",!0)],64))]),w("div",Oo,[(h(!0),v(J,null,Pe(e.Node.Outputs,n=>(h(),q(At,{ref_for:!0,ref:"terminals",key:n.Guid,Term:n},null,8,["Term"]))),128))])]),p(ot,{ref:"contextMenu",CloseOnAnyClick:!0},{default:O(()=>[p(we,null,{default:O(()=>[p(s,{icon:["far","copy"]}),E(" "+P(e.$t("tt.copy")),1)]),_:1}),p(we,{onClick:t[1]||(t[1]=n=>{var r,u;(r=e.Node.ParentGraph)==null||r.DeleteNode(e.Node),(u=e.Node.ParentGraph)==null||u.DeleteSelected(),e.CloseContextMenu()}),style:{color:"var(--vt-c-red)"}},{default:O(()=>[p(s,{icon:["far","trash-can"]}),E(" "+P(e.$t("tt.delete")),1)]),_:1}),t[8]||(t[8]=w("hr",null,null,-1)),p(we,{onClick:t[2]||(t[2]=n=>{e.LockNode(),e.CloseContextMenu()})},{default:O(()=>[e.IsNodeLocked?(h(),q(s,{key:0,icon:["fas","lock"]})):(h(),q(s,{key:1,icon:["fas","lock-open"]})),e.IsNodeLocked?(h(),v(J,{key:2},[E("  "+P(e.$t("tt.unlockPreview")),1)],64)):(h(),v(J,{key:3},[E("  "+P(e.$t("tt.lockPreview")),1)],64))]),_:1})]),_:1,__:[8]},512)],34)}}}),Bt=W($o,[["__scopeId","data-v-1d778793"]]),To={},Ro={class:"canvas",xmlns:"http://www.w3.org/2000/svg"};function Do(o,e){return h(),v("svg",Ro,[Se(o.$slots,"default",{},void 0,!0)])}const Ao=W(To,[["render",Do],["__scopeId","data-v-81940268"]]),Bo=["points"],Xo=H({computed:{Points(){var t,s,i,n,r,u;var o=L.Add((s=(t=this.Link.In)==null?void 0:t.ParentNode)==null?void 0:s.Position,(i=this.Link.In)==null?void 0:i.OffsetPosition),e=L.Add((r=(n=this.Link.Out)==null?void 0:n.ParentNode)==null?void 0:r.Position,(u=this.Link.Out)==null?void 0:u.OffsetPosition);return`${o.X},${o.Y} ${o.X+20},${o.Y} ${e.X-20},${e.Y} ${e.X},${e.Y}`}}}),Go=H({...Xo,__name:"LinkRenderer",props:{Link:{type:jt,required:!0}},setup(o){const e=o,t=()=>{e.Link.SetSelected(!0)},s=i=>{var a;var n=e.Link.In,r=e.Link.Out;if(!(n==null||r==null)){var u=new Xe;u.Move(i.offsetX,i.offsetY);var c=(a=n.ParentNode)==null?void 0:a.ParentGraph;c!=null&&(c.DeleteLink(e.Link),c.AddNode(u),c.AddLink(n,u.Inputs[0]),c.AddLink(u.Outputs[0],r))}};return(i,n)=>(h(),v("polyline",{onClick:t,onDblclick:s,points:i.Points,class:Ye(["line",{selected:e.Link.IsSelected}])},null,42,Bo))}}),Yo=W(Go,[["__scopeId","data-v-a61d9acd"]]),Eo={},Ho={class:"tool-bar-container"};function Uo(o,e){return h(),v("div",Ho,[Se(o.$slots,"default",{},void 0,!0)])}const bt=W(Eo,[["render",Uo],["__scopeId","data-v-b20ca96b"]]),Wo={},zo={class:"tool-bar-body"};function Fo(o,e){return h(),v("div",zo,[Se(o.$slots,"default")])}const Ne=W(Wo,[["render",Fo]]);class os extends ne{constructor(){super(...arguments);l(this,"Name","nodes.fake");l(this,"Position",new L(1e3,1e3))}}const qo={key:0,class:"selection-box"},Zo={class:"offset-container",ref:"offset_container"},Ko=["points"],jo={key:1,style:{"pointer-events":"none",height:"100%",width:"100%",padding:"30px"}},Jo=H({props:{MinScale:{type:Number,default:.5},MaxScale:{type:Number,default:2}},data(){return{Offset:new L(0,0),SelectionBox:new _t(0,0,0,0),SelectionBoxVisibility:!1,LastMouse:new L(0,0),LastOffset:new L(0,0),Zoom:1,isDragging:!1,_Graph:new ss,dragStore:ht(),points:"",GridSize:20,isDragOver:!1,fakeNode:new os}},computed:{Nodes:function(){return this._Graph.Nodes},OffsetXStyle:function(){return this.Offset.X+"px"},OffsetYStyle:function(){return this.Offset.Y+"px"},EditorCursor:function(){return this.isDragging?"grabbing":"default"},SelectionBoxX:function(){return this.SelectionBox.X+"px"},SelectionBoxY:function(){return this.SelectionBox.Y+"px"},SelectionBoxHeight:function(){return this.SelectionBox.Height+"px"},SelectionBoxWidth:function(){return this.SelectionBox.Width+"px"},OffsetStyle:function(){var o=this.GridSize/2*this.Zoom;return this.Offset.X-o+"px "+(this.Offset.Y-o)+"px"},ScaleGridStyle:function(){var o=(this.GridSize*this.Zoom).toString();return`${o}px ${o}px`}},created(){window.addEventListener("mousemove",this.OnMouseMove),window.addEventListener("mouseup",this.OnMouseUp)},mounted(){this.$nextTick(()=>{var e;this.$el;var o=((e=this.$parent)==null?void 0:e.$el).parentElement;o!=null&&(o.onkeydown=this.KeysHandler)})},methods:{SaveGraph(){var o=et.Serialize(this._Graph),e=JSON.stringify(o);console.log(e);var t=JSON.parse(e);console.log(t);var s=et.Deserialize(t);console.log(s)},Undo(){var o=Ve.PopState();o!=null&&(this._Graph=o)},Redo(){var o=Ve.UnpopState();o!=null&&(this._Graph=o)},isChild(o,e){for(var t=e.parentNode;t!=null;){if(t==o)return!0;t=t.parentNode}return!1},dragenter(){this.isDragOver=!0},dragleave(o){var e=this.$el,t=o.target;this.isChild(e,t)||(this.isDragOver=!1)},drop(o){this.isDragOver=!1;var e=ht(),t=e.getNode();if(t!=null){var s=this.$refs.editor,i=s.getBoundingClientRect();if(i!=null){Ve.PushState(this._Graph);var n=L.Div(new L(o.clientX-i.x-this.Offset.X,o.clientY-i.y-this.Offset.Y),this.Zoom);t==null||t.Move(n.X,n.Y),this._Graph.AddNode(t)}}},KeysHandler(o){o.key=="Delete"&&(Ve.PushState(this._Graph),this._Graph.DeleteSelected())},UpdateOffsetStyle(){var o=this.$refs.offset_container;o.style.left=this.OffsetXStyle,o.style.top=this.OffsetYStyle,o.style.scale=this.Zoom.toString()},OnMouseDownLeft:function(o){this.DrawGhostLine(o),o.target==this.$refs.editor&&(this.LastMouse=new L(o.clientX,o.clientY),this.SelectionBox.X=0,this.SelectionBox.Y=0,this.SelectionBox.Width=0,this.SelectionBox.Height=0,this.SelectionBoxVisibility=!0,this._Graph.DeselectAll())},OnMouseDownMiddle:function(o){this.isDragging=!0,this.LastMouse=new L(o.clientX,o.clientY),this.LastOffset={...this.Offset}},OnMouseMove:function(o){if(this.isDragging){o.preventDefault();var e=o.clientX-this.LastMouse.X,t=o.clientY-this.LastMouse.Y;this.Offset.X=this.LastOffset.X+e,this.Offset.Y=this.LastOffset.Y+t,this.UpdateOffsetStyle()}if(this.SelectionBoxVisibility){o.preventDefault();var s=new L(o.clientX,o.clientY),i=new L(Math.min(this.LastMouse.X,s.X),Math.min(this.LastMouse.Y,s.Y)),n=new L(Math.abs(this.LastMouse.X-s.X),Math.abs(this.LastMouse.Y-s.Y)),r=this.$refs.editor,u=r.getBoundingClientRect();this.SelectionBox.X=i.X-u.left,this.SelectionBox.Y=i.Y-u.top,this.SelectionBox.Width=n.X,this.SelectionBox.Height=n.Y,this._Graph.Nodes.forEach(c=>{var a=new _t(this.Offset.X+c.Position.X*this.Zoom,this.Offset.Y+c.Position.Y*this.Zoom,c.Height*this.Zoom,c.Width*this.Zoom);this.SelectionBox.IntersectsWith(a)?c.SetSelected(!0):c.SetSelected(!1)})}this.DrawGhostLine(o)},OnMouseUp:function(o){this.isDragging=!1,this.SelectionBoxVisibility=!1},OnWheel:function(o){let t=this.$refs.editor.getBoundingClientRect(),s=o.deltaY*.001,i=this.Zoom;this.Zoom=this.Clamp(this.Zoom-s,this.MinScale,this.MaxScale);let n=new L(o.clientX-t.left,o.clientY-t.top),r=(i-this.Zoom)/i;this.Offset=L.Add(this.Offset,L.Mul(L.Sub(n,this.Offset),r)),this.UpdateOffsetStyle()},DisableContextMenu(o){o.preventDefault()},Clamp:function(o,e,t){return Math.min(Math.max(o,e),t)},DrawGhostLine(o){var c;if(this.dragStore.IsDragging){var e=this.$refs.editor,t=e.getBoundingClientRect();if(o.preventDefault(),t!=null){var s=this.dragStore.SourceTerminal,i=L.Add((c=s.ParentNode)==null?void 0:c.Position,s.OffsetPosition),n=L.Div(new L(o.clientX-t.x-this.Offset.X,o.clientY-t.y-this.Offset.Y),this.Zoom),r=s.IsInput?n:i,u=s.IsInput?i:n;this.points=`${r.X},${r.Y} ${r.X+20},${r.Y} ${u.X-20},${u.Y} ${u.X},${u.Y}`}}}}}),Qo=H({...Jo,__name:"GraphRenderer",setup(o){return Gt(e=>({"215df84a":e.EditorCursor,"37cbc353":e.SelectionBoxY,"37cbc352":e.SelectionBoxX,"2676868d":e.SelectionBoxHeight,"1ad8f3a0":e.SelectionBoxWidth,57915170:e.ScaleGridStyle,cc90e252:e.OffsetStyle})),(e,t)=>{const s=ie("font-awesome-icon"),i=De("tooltip");return h(),v("div",{class:"graph-renderer dot",ref:"editor",onWheel:t[4]||(t[4]=(...n)=>e.OnWheel&&e.OnWheel(...n)),onMousedown:[t[5]||(t[5]=ge((...n)=>e.OnMouseDownLeft&&e.OnMouseDownLeft(...n),["left"])),t[6]||(t[6]=ge((...n)=>e.OnMouseDownMiddle&&e.OnMouseDownMiddle(...n),["middle"]))],onContextmenu:ge(()=>!1,["prevent","right"]),onDragover:t[7]||(t[7]=ge(()=>{},["prevent"])),onDragenter:t[8]||(t[8]=(...n)=>e.dragenter&&e.dragenter(...n)),onDragleave:t[9]||(t[9]=(...n)=>e.dragleave&&e.dragleave(...n)),onDrop:t[10]||(t[10]=(...n)=>e.drop&&e.drop(...n))},[p(bt,{class:"top-left"},{default:O(()=>[p(Ne,null,{default:O(()=>[j((h(),v("a",{onClick:t[0]||(t[0]=n=>e.Undo())},[p(s,{icon:["fas","rotate-left"]})])),[[i,e.$t("tt.undo"),void 0,{bottom:!0}]]),j((h(),v("a",{onClick:t[1]||(t[1]=n=>e.Redo())},[p(s,{icon:["fas","rotate-right"]})])),[[i,e.$t("tt.redo"),void 0,{bottom:!0}]])]),_:1}),p(Ne,null,{default:O(()=>[j((h(),v("a",null,[p(s,{icon:["far","copy"]})])),[[i,e.$t("tt.copy"),void 0,{bottom:!0}]]),j((h(),v("a",null,[p(s,{icon:["far","paste"]})])),[[i,e.$t("tt.paste"),void 0,{bottom:!0}]]),j((h(),v("a",{class:Ye([{disabled:!e._Graph.HasSelected}]),style:{color:"var(--vt-c-red)"},onClick:t[2]||(t[2]=n=>e._Graph.DeleteSelected())},[p(s,{icon:["far","trash-can"]})],2)),[[i,e.$t("tt.delete"),void 0,{bottom:!0}]])]),_:1}),p(Ne,null,{default:O(()=>[j((h(),v("a",null,[p(s,{icon:["fas","expand"]})])),[[i,e.$t("tt.fullscreen"),void 0,{bottom:!0}]])]),_:1})]),_:1}),p(bt,{class:"bottom-left"},{default:O(()=>[p(Ne,null,{default:O(()=>[w("span",null,[e.Zoom<1?(h(),q(s,{key:0,icon:["fas","magnifying-glass-minus"]})):(h(),q(s,{key:1,icon:["fas","magnifying-glass-plus"]})),E(" "+P((e.Zoom*100).toFixed(0))+"%",1)])]),_:1}),p(Ne,null,{default:O(()=>[w("span",null,[p(s,{icon:["fas","up-down-left-right"]}),E(" X: "+P(e.Offset.X.toFixed())+" Y: "+P(e.Offset.Y.toFixed()),1)])]),_:1}),p(Ne,null,{default:O(()=>[j((h(),v("a",{onClick:t[3]||(t[3]=n=>{e.Offset.Reset(),e.Zoom=1,e.UpdateOffsetStyle()})},[p(s,{icon:["fas","arrows-rotate"]})])),[[i,e.$t("tt.resetView")]])]),_:1}),p(Ne,null,{default:O(()=>[w("span",null,[p(s,{icon:["fas","circle-info"]}),E(" "+P(e.$t("hints.graphLmb")),1)])]),_:1}),p(Ne,null,{default:O(()=>[w("span",null,[p(s,{icon:["fas","circle-info"]}),E(" "+P(e.$t("hints.graphWheel")),1)])]),_:1})]),_:1}),e.SelectionBoxVisibility?(h(),v("div",qo)):te("",!0),w("div",Zo,[p(Ao,{id:"links-container"},{default:O(()=>[p(Lt,{name:"link"},{default:O(()=>[(h(!0),v(J,null,Pe(e._Graph.Links,n=>(h(),q(Yo,{key:n.Id,Link:n},null,8,["Link"]))),128))]),_:1}),e.dragStore.IsDragging?(h(),v("polyline",{key:0,class:"ghost-line",points:e.points},null,8,Ko)):te("",!0)]),_:1}),p(Lt,{name:"delete",tag:"div"},{default:O(()=>[(h(!0),v(J,null,Pe(e.Nodes,n=>(h(),q(Bt,{key:n.Id,Offset:e.Offset,Zoom:e.Zoom,Node:n},null,8,["Offset","Zoom","Node"]))),128))]),_:1}),p(Bt,{Offset:e.Offset,Zoom:e.Zoom,Node:e.fakeNode},null,8,["Offset","Zoom","Node"])],512),e.isDragOver?(h(),v("div",jo,t[11]||(t[11]=[w("div",{style:{height:"100%",width:"100%","border-radius":"50px",border:"4px dashed var(--vt-c-black-mute)"}},null,-1)]))):te("",!0)],544)}}}),en=W(Qo,[["__scopeId","data-v-a00ad599"]]),tn={style:{height:"100%",display:"flex","flex-direction":"row"}},sn={style:{"margin-left":"5px"}},on={style:{"margin-left":"5px"}},nn=H({__name:"EditorView",setup(o){return(e,t)=>{const s=ie("font-awesome-icon");return h(),v("div",tn,[p(ft,{style:{width:"20%","min-width":"300px"}},{header:O(()=>[p(s,{icon:["fas","list"]}),t[0]||(t[0]=E()),w("span",sn,P(e.$t("windows.nodesList")),1)]),default:O(()=>[p(co)]),_:1}),p(ft,{style:{width:"80%"}},{header:O(()=>[p(s,{icon:["fas","circle-nodes"]}),t[1]||(t[1]=E()),w("span",on,P(e.$t("windows.graph")),1)]),default:O(()=>[p(en)]),_:1})])}}}),an={style:{display:"flex","flex-direction":"row"}},rn={style:{width:"100%","font-weight":"bold","text-align":"left","margin-left":"10px"}},ln={style:{width:"100%","font-weight":"bold","text-align":"right","margin-right":"10px"}},un={style:{width:"10px","margin-right":"10px"}},dn={key:0,class:"dropdown"},cn=["onClick"],hn=H({__name:"SelectDropdown",props:{options:{type:Array,required:!1,default:[]},title:{type:String,required:!1,default:""},default:{type:String,required:!1,default:null},modelValue:{type:String,default:""},RealtimeChange:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(o,{emit:e}){$(!1);const t=o,s=$(t.default?t.default:t.options.length>0?t.options[0]:null),i=$(!1);Qe(()=>t.modelValue,r=>{s.value=r});const n=()=>{var r=_e();t.RealtimeChange&&(r.ChangeEvent=!r.ChangeEvent)};return(r,u)=>{const c=ie("font-awesome-icon");return h(),v("div",{class:"dropdown-head input-element value",tabindex:"0",onBlur:u[1]||(u[1]=a=>i.value=!1),style:{width:"100%",position:"relative"}},[w("div",{onClick:u[0]||(u[0]=a=>i.value=!i.value),style:{height:"100%"}},[w("div",an,[w("div",rn,P(t.title)+P(t.title==""?"":":"),1),w("div",ln,P(s.value),1),w("div",un,[i.value?(h(),q(c,{key:1,icon:["fas","angle-up"]})):(h(),q(c,{key:0,icon:["fas","angle-down"]}))])])]),i.value?(h(),v("ul",dn,[(h(!0),v(J,null,Pe(o.options,(a,f)=>(h(),v("li",{class:Ye({selected:a==s.value}),key:f,onClick:m=>{s.value=a,i.value=!1,r.$emit("update:modelValue",s.value),n()}},P(a),11,cn))),128))])):te("",!0)],32)}}}),fn=W(hn,[["__scopeId","data-v-61887904"]]),pn=H({__name:"LangSwitch",setup(o){const e=xt(),t=$("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);const s=c=>{e!=null&&(e.appContext.config.globalProperties.$i18n.locale=c,localStorage.setItem("userLang",c),t.value=c)},i=mt("langContextMenu"),n=$(),r=c=>{var a;(n!=null||n!=null)&&((a=i.value)==null||a.OpenUnder(n.value))};var u=new Map;return u.set("en","English"),u.set("ru","Русский"),(c,a)=>{const f=ie("flag");return h(),v(J,null,[w("button",{ref_key:"langSwitchBtn",ref:n,class:"btn disable-user-select",onClick:r},[p(f,{iso:t.value=="en"?"gb":t.value},null,8,["iso"]),E(" "+P(re(u).get(t.value)),1)],512),p(ot,{ref:"langContextMenu"},{default:O(()=>[w("button",{class:"btn btnContextMenuPadding",onClick:a[0]||(a[0]=m=>{var g;s("ru"),(g=i.value)==null||g.Close()})},[p(f,{iso:"ru"}),a[2]||(a[2]=E(" Русский"))]),w("button",{class:"btn btnContextMenuPadding",onClick:a[1]||(a[1]=m=>{var g;s("en"),(g=i.value)==null||g.Close()})},[p(f,{iso:"gb"}),a[3]||(a[3]=E(" English"))])]),_:1},512)],64)}}}),mn=H({__name:"ToggleButton",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const e=Yt(o,"modelValue");return(t,s)=>(h(),v("button",{class:Ye(["btn",{toggled:e.value}]),onClick:s[0]||(s[0]=i=>e.value=!e.value)},[Se(t.$slots,"default",{},void 0,!0)],2))}}),vn=W(mn,[["__scopeId","data-v-4a53f642"]]),gn=H({__name:"ResolutionSwitcher",setup(o){const e=xt(),t=$("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);var s=_e();const i=mt("contextMenu"),n=$(),r=m=>{var C,S,y;if(n!=null||n!=null){var g=(C=n.value)==null?void 0:C.getBoundingClientRect();(S=i.value)==null||S.OpenUnder(n.value),g!=null&&((y=i.value)==null||y.SetWidth(g.width))}},u=["0.5K","1K","2K","4K","8K"],c=[512,1024,2048,4096,8192],a=$(0),f=m=>{a.value=m;var g=s.GetRenderer();g!=null&&(g.ChangeResolution(c[m]),requestAnimationFrame(()=>g==null?void 0:g.Render()))};return(m,g)=>{const C=ie("font-awesome-icon"),S=De("tooltip");return h(),v(J,null,[j((h(),v("button",{ref_key:"switcher",ref:n,class:"btn disable-user-select",onClick:r},[p(C,{icon:["fas","vector-square"]}),E(" "+P(u[a.value])+" ",1),p(C,{icon:["fas","angle-down"]})])),[[S,m.$t("tt.mesh_resolution"),void 0,{bottom:!0}]]),p(ot,{ref_key:"contextMenu",ref:i},{default:O(()=>[(h(),v(J,null,Pe(u,(y,b)=>(h(),v(J,null,[b>2?j((h(),q(we,{key:0,class:"waringText",Active:b==a.value,onClick:I=>{var B;f(b),(B=i.value)==null||B.Close()}},{default:O(()=>[p(C,{icon:["fas","vector-square"]}),E(" "+P(y),1)]),_:2},1032,["Active","onClick"])),[[S,{content:m.$t("tt.resolutionWarning"),html:!0,distance:15},void 0,{right:!0}]]):(h(),q(we,{key:1,Active:b==a.value,onClick:I=>{var B;f(b),(B=i.value)==null||B.Close()}},{default:O(()=>[p(C,{icon:["fas","vector-square"]}),E(" "+P(y),1)]),_:2},1032,["Active","onClick"]))],64))),64))]),_:1},512)],64)}}}),Xt=W(gn,[["__scopeId","data-v-97dd3ce3"]]),wn={style:{height:"100%",width:"100%",position:"relative"}},Vn=["value"],yn=H({__name:"ProjectNameEditor",props:$t({modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:$t(["update:modelValue"],["update:modelValue"]),setup(o,{emit:e}){const t=Yt(o,"modelValue"),s=e,i=$(!1),n=$(),r=$(),u=()=>{i.value=!0,Oe(()=>{var m;r.value=t.value,(m=n.value)==null||m.focus()})},c=m=>{s("update:modelValue",r.value),i.value=!1},a=m=>{m.target!=null&&(r.value=m.target.value,s("update:modelValue",r.value))},f=m=>{m.key=="Enter"&&(m.target!=null&&(r.value=m.target.value,s("update:modelValue",r.value)),i.value=!1)};return(m,g)=>{const C=ie("font-awesome-icon");return h(),v("div",wn,[i.value?(h(),v("input",{key:0,ref_key:"input",ref:n,onFocusout:c,onInput:a,onKeypress:f,class:"editor",value:t.value},null,40,Vn)):(h(),v("div",{key:1,class:"label",onClick:u},P(t.value),1)),p(C,{class:"icon",icon:["fas","pen"]})])}}}),Sn=W(yn,[["__scopeId","data-v-1b5ff080"]]),_n={style:{"margin-left":"auto",right:"0px",height:"100%","white-space":"nowrap",overflow:"hidden"}},bn={class:"btn"},xn={class:"btn"},Mn={class:"btn"},Cn={class:"btn"},Pn={class:"btn"},In={class:"btn"},Nn={class:"btn"},kn={class:"btn"},On=450,Ln=H({__name:"ActionButtonsBar",setup(o){const e=$(),t=mt("contextMenu"),s=$(),i=$(),n=u=>{var c;(s!=null||s!=null)&&((c=t.value)==null||c.OpenUnder(s.value))},r=()=>{var a;var u=(a=e.value)==null?void 0:a.getBoundingClientRect();if(u!=null){var c=u==null?void 0:u.width;c!=null&&c<On?i.value=!0:i.value=!1}};return pt(()=>{Oe(()=>{r(),window.addEventListener("resize",()=>{r()})})}),(u,c)=>{const a=ie("font-awesome-icon"),f=De("tooltip");return h(),v("div",{ref_key:"menuContainer",ref:e,style:{display:"flex",height:"100%",width:"100%","white-space":"nowrap",overflow:"hidden"}},[w("div",_n,[i.value?(h(),v(J,{key:0},[p(Xt),c[3]||(c[3]=w("div",{class:"separator"},null,-1)),j((h(),v("button",{onClick:n,ref_key:"contextMenuButton",ref:s,class:"btn"},[p(a,{icon:["fas","fa-bars"]})])),[[f,u.$t("tt.menu"),void 0,{bottom:!0}]]),p(ot,{ref_key:"contextMenu",ref:t},{default:O(()=>[p(we,null,{default:O(()=>[p(a,{icon:["fas","file"]}),E(" "+P(u.$t("tt.new")),1)]),_:1}),p(we,null,{default:O(()=>[p(a,{icon:["fas","floppy-disk"]}),E(" "+P(u.$t("tt.save")),1)]),_:1}),p(we,null,{default:O(()=>[p(a,{icon:["fas","folder-open"]}),E(" "+P(u.$t("tt.load")),1)]),_:1}),c[0]||(c[0]=w("hr",null,null,-1)),p(we,null,{default:O(()=>[p(a,{icon:["fas","rotate-left"]}),E(" "+P(u.$t("tt.undo")),1)]),_:1}),p(we,null,{default:O(()=>[p(a,{icon:["fas","rotate-right"]}),E(" "+P(u.$t("tt.redo")),1)]),_:1}),c[1]||(c[1]=w("hr",null,null,-1)),p(we,null,{default:O(()=>[p(a,{icon:["fas","gear"]}),E(" "+P(u.$t("tt.settings")),1)]),_:1}),c[2]||(c[2]=w("hr",null,null,-1)),p(we,null,{default:O(()=>[p(a,{icon:["fas","expand"]}),E(" "+P(u.$t("tt.fullscreen")),1)]),_:1})]),_:1,__:[0,1,2]},512),c[4]||(c[4]=w("div",{class:"separator"},null,-1)),j((h(),v("button",bn,[p(a,{icon:["fas","rotate-left"]})])),[[f,u.$t("tt.undo"),void 0,{bottom:!0}]]),j((h(),v("button",xn,[p(a,{icon:["fas","rotate-right"]})])),[[f,u.$t("tt.redo"),void 0,{bottom:!0}]])],64)):(h(),v(J,{key:1},[p(Xt),c[5]||(c[5]=w("div",{class:"separator"},null,-1)),j((h(),v("button",Mn,[p(a,{icon:["fas","file"]})])),[[f,u.$t("tt.new"),void 0,{bottom:!0}]]),j((h(),v("button",Cn,[p(a,{icon:["fas","floppy-disk"]})])),[[f,u.$t("tt.save"),void 0,{bottom:!0}]]),j((h(),v("button",Pn,[p(a,{icon:["fas","folder-open"]})])),[[f,u.$t("tt.load"),void 0,{bottom:!0}]]),c[6]||(c[6]=w("div",{class:"separator"},null,-1)),j((h(),v("button",In,[p(a,{icon:["fas","rotate-left"]})])),[[f,u.$t("tt.undo"),void 0,{bottom:!0}]]),j((h(),v("button",Nn,[p(a,{icon:["fas","rotate-right"]})])),[[f,u.$t("tt.redo"),void 0,{bottom:!0}]]),c[7]||(c[7]=w("div",{class:"separator"},null,-1)),j((h(),v("button",kn,[p(a,{icon:["fas","gear"]})])),[[f,u.$t("tt.settings"),void 0,{bottom:!0}]]),c[8]||(c[8]=w("div",{class:"separator"},null,-1)),j((h(),q(vn,null,{default:O(()=>[p(a,{icon:["fas","expand"]})]),_:1})),[[f,u.$t("tt.fullscreen"),void 0,{bottom:!0}]])],64))])],512)}}}),$n=W(Ln,[["__scopeId","data-v-d512614f"]]),Tn={class:"disable-user-select left-section",style:{display:"flex","flex-direction":"row"}},Rn={class:"logo disable-user-select",style:{"text-transform":"uppercase"}},Dn={class:"padding"},An={class:"middle-actions",style:{}},Bn={style:{display:"flex","flex-direction":"row"}},Xn=H({__name:"MainMenuBar",setup(o){const e=$(!1);Qe(e,(s,i)=>{s?document.documentElement.requestFullscreen():document.exitFullscreen()});const t=$("Untitled");return(s,i)=>(h(),v("div",{class:"main",onContextmenu:i[1]||(i[1]=ge(()=>{},["prevent"]))},[w("div",Tn,[w("div",Rn,P(s.$t("logo")),1),p($n)]),w("div",Dn,[w("div",An,[p(Sn,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=n=>t.value=n)},null,8,["modelValue"])])]),w("div",Bn,[p(pn)])],32))}}),Gn=W(Xn,[["__scopeId","data-v-58738f50"]]),Yn={style:{height:"100%"}},En={style:{display:"flex","flex-direction":"row"}},Hn={style:{width:"100%","font-weight":"bold","text-align":"left","margin-left":"10px"}},Un={style:{width:"100%","font-weight":"bold","text-align":"right","margin-right":"10px",padding:"3px"}},Wn={style:{display:"flex"}},zn={style:{padding:"3px",display:"flex","flex-direction":"row","align-items":"center"}},Fn={class:"colorValue",style:{"background-color":"red"}},qn={class:"colorValue",style:{"background-color":"green"}},Zn={class:"colorValue",style:{"background-color":"blue"}},Kn={class:"colorValue"},jn={class:"colorValue"},Jn={class:"colorValue"},Qn={style:{"text-align":"center"}},ei={key:0},ti={key:1},si={key:2},oi=H({__name:"ColorPicker",props:{title:{type:String,required:!1,default:""},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(o,{emit:e}){const t=o,s=()=>{i.value++,i.value>2&&(i.value=0)},i=$(0),n=$(0),r=$(0),u=$(0),c=ae(()=>{var _=Ie(n.value,r.value,u.value);return _}),a=ae(()=>Ue(n.value,r.value,u.value)),f=ae(()=>Me(n.value,r.value,u.value)),m=ae(()=>((1-n.value/360)*200).toString()+"px"),g=ae(()=>(r.value*200).toString()+"px"),C=ae(()=>((1-u.value)*200).toString()+"px"),S=ae(()=>{var _=Te(n.value),R=_[0]*255,k=_[1]*255,N=_[2]*255;return"linear-gradient(0deg, #000, #fff ), linear-gradient(to left, rgb("+R+","+k+","+N+"), #fff )"}),y=ae(()=>{var _=Ie(n.value,r.value,u.value),R=_[0],k=_[1],N=_[2];return"rgb("+R+","+k+","+N+")"}),b=ae(()=>{var _=Te(n.value),R=_[0]*255,k=_[1]*255,N=_[2]*255;return"rgb("+R+","+k+","+N+")"}),I=$(!1),B=mt("contextMenu"),oe=$(),Le=_=>{(oe!=null||oe!=null)&&B.value!=null&&(I.value?(B.value.Close(),I.value=!1):(B.value.OpenUnder(oe.value),I.value=B.value.isOpened))},be=$();var pe=!1;const Z=_=>{if(be.value!=null){var R=be.value.getBoundingClientRect();if(R!=null){var k=_.clientY-R.top,N=_.clientX-R.left;k<0&&(k=0),k>200&&(k=200),N<0&&(N=0),N>200&&(N=200),r.value=N/200,u.value=1-k/200}}},z=_=>{pe=!0,window.addEventListener("mousemove",Y),window.addEventListener("mouseup",X),Z(_)},Y=_=>{pe&&Z(_)},X=_=>{pe=!1,window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",X)},A=$();var se=!1;const K=_=>{n.value=(1-_/200)*360},me=_=>{if(A.value!=null){var R=A.value.getBoundingClientRect();if(R!=null){var k=_.clientY-R.top;k<0&&(k=0),k>200&&(k=200),K(k)}}},de=_=>{se=!0,window.addEventListener("mousemove",xe),window.addEventListener("mouseup",$e),me(_)},xe=_=>{se&&me(_)},$e=_=>{se=!1,window.removeEventListener("mousemove",xe),window.removeEventListener("mouseup",$e)},Te=_=>{_=_%360,_<0&&(_+=360),_=_/60;const R=1,k=R*(1-Math.abs(_%2-1));let N,D,le;return _>=0&&_<1?[N,D,le]=[R,k,0]:_>=1&&_<2?[N,D,le]=[k,R,0]:_>=2&&_<3?[N,D,le]=[0,R,k]:_>=3&&_<4?[N,D,le]=[0,k,R]:_>=4&&_<5?[N,D,le]=[k,0,R]:[N,D,le]=[R,0,k],[N,D,le]},Ie=(_,R,k)=>{const N=k*R,D=_/60,le=N*(1-Math.abs(D%2-1));let ce,he,fe;D>=0&&D<1?[ce,he,fe]=[N,le,0]:D>=1&&D<2?[ce,he,fe]=[le,N,0]:D>=2&&D<3?[ce,he,fe]=[0,N,le]:D>=3&&D<4?[ce,he,fe]=[0,le,N]:D>=4&&D<5?[ce,he,fe]=[le,0,N]:[ce,he,fe]=[N,0,le];const Ae=k-N,gt=Math.round((ce+Ae)*255),ns=Math.round((he+Ae)*255),is=Math.round((fe+Ae)*255);return[gt,ns,is]};function Ue(_,R,k){_=_%360/60,R=Math.max(0,Math.min(1,R)),k=Math.max(0,Math.min(1,k));const N=k*R,D=N*(1-Math.abs(_%2-1)),le=k-N;let ce,he,fe;_<1?[ce,he,fe]=[N,D,0]:_<2?[ce,he,fe]=[D,N,0]:_<3?[ce,he,fe]=[0,N,D]:_<4?[ce,he,fe]=[0,D,N]:_<5?[ce,he,fe]=[D,0,N]:[ce,he,fe]=[N,0,D];const Ae=gt=>Math.round((gt+le)*255).toString(16).padStart(2,"0");return`#${Ae(ce)}${Ae(he)}${Ae(fe)}`.toUpperCase()}const Me=(_,R,k)=>{const N=k*(1-R/2),D=N===0||N===1?0:(k-N)/Math.min(N,1-N);return{h:_%360,s:Math.max(0,Math.min(1,D)),l:Math.max(0,Math.min(1,N))}};return(_,R)=>{const k=ie("font-awesome-icon");return h(),v("div",{ref_key:"pickerButton",ref:oe,onClick:Le,class:"dropdown-head input-element value",style:{width:"100%",position:"relative"}},[w("div",Yn,[w("div",En,[w("div",Hn,P(t.title)+P(t.title==""?"":":"),1),w("div",Un,[w("div",{class:"color-square",style:We({"background-color":y.value})},null,4)]),p(ot,{onLostFocus:R[0]||(R[0]=N=>I.value=!1),ref_key:"contextMenu",ref:B},{default:O(()=>[w("div",Wn,[w("div",{ref_key:"gradientSquare",ref:be,class:"gradient-square",style:We({"background-image":S.value}),onMousedown:z},[w("div",{class:"color-circle-slider",style:We({left:g.value,top:C.value})},R[1]||(R[1]=[w("div",null,null,-1)]),4)],36),w("div",{ref_key:"hueBar",ref:A,class:"colors-line",onMousedown:de,onMouseup:$e},[w("div",{class:"colors-line-slider",style:We({top:m.value})},[w("div",{style:We({"background-color":b.value})},null,4)],4)],544)]),w("div",zn,[i.value==0?(h(),v(J,{key:0},[w("div",Fn,P((c.value[0]/255).toFixed(2)),1),w("div",qn,P((c.value[1]/255).toFixed(2)),1),w("div",Zn,P((c.value[2]/255).toFixed(2)),1)],64)):te("",!0),i.value==2?(h(),v("div",{key:1,class:"colorValue",style:We({"background-color":y.value})},P(a.value),5)):te("",!0),i.value==1?(h(),v(J,{key:2},[w("div",Kn," H:"+P(f.value.h.toFixed(1)),1),w("div",jn," S:"+P((f.value.s*100).toFixed(0))+"% ",1),w("div",Jn," L:"+P((f.value.l*100).toFixed(0))+"% ",1)],64)):te("",!0),w("button",{class:"btn",onClick:s,style:{margin:"4px",padding:"7px"}},[p(k,{icon:"fa-solid fa-sort"})])]),w("div",Qn,[i.value==2?(h(),v("span",ei," HEX ")):te("",!0),i.value==1?(h(),v("span",ti," HSL ")):te("",!0),i.value==0?(h(),v("span",si," RGB ")):te("",!0)])]),_:1},512)])])],512)}}}),ni=W(oi,[["__scopeId","data-v-aa3918e2"]]),ii=H({props:{Min:Number,Max:Number,Suffix:String,Title:String,RealtimeChange:{type:Boolean,default:!0},Step:{type:Number,default:0},modelValue:{type:Number,default:0}},emits:["update:modelValue"],data(){return{IsDragging:!1,Value:0,lastPosition:new L(0,0),lastValue:0,IsInputVisible:!1,moveDistance:0}},created(){document.addEventListener("mousemove",this.OnMouseMove),document.addEventListener("mouseup",this.OnMouseUp),this.Value=this.modelValue},watch:{modelValue(o,e){this.Value=o}},methods:{ClickValue(o){this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+o,this.Min,this.Max):this.Value=this.Clamp(this.Value+(o>0?this.Step:-this.Step),this.Min,this.Max):this.Step==0?this.Value+=o:this.Value+=o>0?this.Step:-this.Step,this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnInput(o){this.Value=Number(o.target.value),this.Min!=null&&this.Max!=null&&(this.Value=this.Clamp(this.Value,this.Min,this.Max)),this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnMouseDown(o){this.IsInputVisible||(this.$el.requestPointerLock(),this.IsDragging=!0,this.lastPosition=new L(o.clientX,o.clientY),this.lastValue=this.Value,this.moveDistance=0)},OnMouseMove(o){this.IsDragging&&(this.moveDistance+=o.movementX,this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+o.movementX/(o.shiftKey?25:50),this.Min,this.Max):o.movementX!=0&&Math.abs(this.moveDistance)>=(o.shiftKey?25:50)&&(this.moveDistance=0,this.Value=this.Clamp(this.Value+(o.movementX>0?this.Step:-this.Step),this.Min,this.Max)):this.Step==0?this.Value+=o.movementX/(o.shiftKey?25:50):o.movementX!=0&&Math.abs(this.moveDistance)>=(o.shiftKey?25:50)&&(this.moveDistance=0,this.Value+=o.movementX>0?this.Step:-this.Step),this.$emit("update:modelValue",this.Value),this.UpdateEvent())},OnMouseUp(o){var e=new L(o.clientX,o.clientY);e.X==this.lastPosition.X&&e.Y==this.lastPosition.Y&&this.Value==this.lastValue&&(this.IsInputVisible=!0,this.$nextTick(()=>{var t=this.$refs.input;t.focus(),t.select()})),this.IsDragging=!1,document.exitPointerLock()},UpdateEvent(){var o=_e();this.RealtimeChange&&(o.ChangeEvent=!o.ChangeEvent)},validate(o){o.key=="Enter"&&o.target.blur();var e=/[0-9-]|\./;e.test(o.key)||o.preventDefault()},Clamp(o,e,t){return Math.min(Math.max(o,e),t)}}}),ai={ref:"inputRange",class:"input-range"},ri=["value"],li={class:"title"},ui={class:"valueText"};function di(o,e,t,s,i,n){const r=ie("font-awesome-icon");return h(),v("div",ai,[w("div",{class:"button",onClick:e[0]||(e[0]=u=>o.ClickValue(-.1))},[p(r,{icon:["fas","caret-left"]})]),w("div",{class:"value",onMousedown:e[4]||(e[4]=ge((...u)=>o.OnMouseDown&&o.OnMouseDown(...u),["left"]))},[o.IsInputVisible?(h(),v("input",{key:0,onKeypress:e[1]||(e[1]=(...u)=>o.validate&&o.validate(...u)),ref:"input",class:"input-element",value:o.modelValue,onInput:e[2]||(e[2]=(...u)=>o.OnInput&&o.OnInput(...u)),onBlur:e[3]||(e[3]=u=>o.IsInputVisible=!1)},null,40,ri)):(h(),v(J,{key:1},[w("div",li,P(o.Title)+": ",1),w("div",ui,P(Number(o.Value.toFixed(4)))+" "+P(o.Suffix),1)],64))],32),w("div",{class:"button",onClick:e[5]||(e[5]=u=>o.ClickValue(.1))},[p(r,{icon:["fas","caret-right"]})])],512)}const ci=W(ii,[["render",di],["__scopeId","data-v-85813c7d"]]),hi={class:"properties"},fi={key:0,class:"not-selected"},pi={class:"header"},mi={style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},vi={class:"buttons",style:{display:"flex","font-weight":"bold"}},gi={class:"btn"},wi={key:0,style:{margin:"0px 10px"}},Vi={class:"input-group",style:{width:"100%",padding:"0px"}},yi={key:1,style:{padding:"10px"}},Si={class:"notice"},_i=H({__name:"PropertiesView",setup(o){const e=Ce();var t=ae(()=>e.SelectedNode),s=ae(()=>e.SelectedNode==null||e.SelectedNode instanceof Xe),i=ae(()=>{var u;return r((u=t.value)==null?void 0:u.Properties)});const n=()=>{if(e.SelectedNode!=null&&e.SelectedNode!=null&&e.SelectedNode){for(var u of e.SelectedNode.Properties)u.Reset();var c=_e();c.ChangeEvent=!c.ChangeEvent}};var r=u=>{var c=new Map;return u==null||u.length==0||u.forEach(a=>{var f;c.has(a.Category)||c.set(a.Category,new Array),(f=c.get(a.Category))==null||f.push(a)}),c};return(u,c)=>{var m;const a=ie("font-awesome-icon"),f=De("tooltip");return h(),v("div",hi,[re(s)?(h(),v("div",fi,[p(a,{icon:["fas","sliders"]})])):te("",!0),re(s)?te("",!0):(h(),v(J,{key:1},[w("div",pi,[w("div",mi,P(u.$t((m=re(t))==null?void 0:m.Name)),1),w("div",vi,[j((h(),v("button",gi,[p(a,{icon:["fas","sliders"]})])),[[f,u.$t("tt.presets"),void 0,{bottom:!0}]]),j((h(),v("button",{class:"btn",onClick:n},[p(a,{icon:["fas","arrows-rotate"]})])),[[f,u.$t("tt.resetParams"),void 0,{bottom:!0}]])])]),re(t).Name?(h(),v("hr",wi)):te("",!0),(h(!0),v(J,null,Pe(re(i),([g,C])=>(h(),q(Qt,{style:{"background-color":"transparent",padding:"0px"}},{header:O(()=>[E(P(g),1)]),default:O(()=>[w("div",Vi,[p(ni,{title:"Color"}),(h(!0),v(J,null,Pe(C,S=>(h(),v(J,null,[typeof S.Value=="number"?(h(),q(ci,{key:0,modelValue:S.Value,"onUpdate:modelValue":y=>S.Value=y,Min:S.Min,Max:S.Max,Step:S.Step,Suffix:S.Suffix,Title:S.Name},null,8,["modelValue","onUpdate:modelValue","Min","Max","Step","Suffix","Title"])):te("",!0),S.valueList!=null?(h(),q(fn,{key:1,modelValue:S.Value,"onUpdate:modelValue":y=>S.Value=y,default:S.Value,title:S.Name,options:S.valueList},null,8,["modelValue","onUpdate:modelValue","default","title","options"])):te("",!0)],64))),256))])]),_:2},1024))),256)),re(t).IsRealtimeUpdate==!1?(h(),v("div",yi,[c[1]||(c[1]=w("button",{class:"btn apply-btn"}," Apply changes ",-1)),w("div",Si,[p(a,{icon:["fas","circle-exclamation"]}),c[0]||(c[0]=E(' This node performs a heavy operation, so the update occurs when you click the "Apply Changes" button and is cached. '))])])):te("",!0)],64))])}}}),bi=W(_i,[["__scopeId","data-v-949ea120"]]);function xi(o){return new Worker("/assets/MeshGenerationWorker-DdK6sfo-.js",{name:o==null?void 0:o.name})}class Mi{constructor(){l(this,"GridMaterial");l(this,"GridMesh");const e=d(.5).toVar(),t=d(5).toVar(),s=d(1*window.devicePixelRatio).toVar(),i=d(500).toVar(),n=d(200).toVar(),r=dt(.2,.2,.2,.2).toVar(),u=dt(.05,.05,.05,.2).toVar(),c=ys,a=Ss,f=T(([Y,X])=>{const A=yt(Y,X),se=tt(F(Ee(F(A,.5)),.5)),K=yt(se,Wt(A));return ue(K.x,K.y)}),m=f(c.xz,e),g=f(c.xz,t),C=F(1,Je(0,s,m)),S=F(1,Je(0,s,g)),y=F(c,a),b=st(y),I=Je(d(i),d(0),b),B=Je(d(n),d(0),b),oe=ee(r,ee(C,B)).toVar(),Le=ee(u,ee(S,I)).toVar(),be=zt(Le,oe),pe=new Ft;pe.colorNode=be,pe.transparent=!0,pe.side=It,pe.lights=!1;const Z=new qt(1e3,1e3,1,1);Z.rotateX(-Math.PI/2);const z=new Nt(Z,pe);this.GridMesh=z,this.GridMaterial=pe}}class Ci{constructor(){l(this,"Mesh");const e=T(([n,r,u])=>{const c=V(n.x,n.y).toVar(),a=V(tt(c.mul(2).sub(1)).sub(V(r,u))).toVar();return a.assign(d(1).sub(a.div(Wt(a)))),_s(ue(a.x,a.y))});var t=new bs({color:"#fff",transparent:!0,side:It});t.colorNode=T(()=>{const n=e(nt(),1,1).toVar(),r=e(nt(),.9,1).toVar(),u=e(nt(),1,.9).toVar(),c=e(nt(),.98,.98).toVar(),a=Re(0,1,n.sub(r).sub(u).sub(c)).toVar();return dt(.8,.8,.8,a)})();var s=new qt(1,1,1,1);s.rotateX(-Math.PI/2);var i=new Nt(s,t);i.castShadow=!1,i.receiveShadow=!1,i.scale.set(10,1,10),i.position.set(0,.005,0),this.Mesh=i}}class Pi{constructor(){l(this,"Height",2);l(this,"GPURenderer");l(this,"HeightTexture");l(this,"TerrainMaterial");l(this,"IsMeshGenerated",$(!1));l(this,"Scene");l(this,"Camera");l(this,"Controls");l(this,"TerrainMesh");l(this,"GridMesh");l(this,"DirectionalLight");l(this,"DirectionalLight2");l(this,"_resolution",512);l(this,"_textureResolution",512);l(this,"_canvas");l(this,"_isColorized",!1);this.CreateRenderer(),this.Scene=new xs,this.Scene.environmentNode=Ms("#ffffff"),this.Scene.environmentIntensity=.05,this.Camera=new Cs(75,1,.01,1e3),this.Camera.position.z=10,this.Camera.position.y=10,this.CreateMaterial(),this.CreateTexture(this._resolution),this.CreateTerrainMesh(this.Resolution),this.CreateLight();const e=new Mi;this.GridMesh=e.GridMesh,this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2),this.Scene.add(this.GridMesh);var t=new Ci;this.Scene.add(t.Mesh);const s=_e();s.SetRenderer(this),s.Resolution=this.Resolution}get Resolution(){return this._resolution}get TextureResolution(){return this._textureResolution}CreateMaterial(){this.TerrainMaterial=new Ft({color:"#a2a2a2"}),this.TerrainMaterial.side=It,this.TerrainMaterial.needsUpdate=!0,this.TerrainMaterial.metalness=0,this.TerrainMaterial.roughness=1,this.TerrainMaterial.positionNode=T(()=>{const e=d(1/this.Resolution),t=d(1).sub(e).toVar(),s=Be.xyz.toVar(),i=je(this.HeightTexture,Be.xz.add(.5).mul(t)).mul(this.Height);return s.y.addAssign(i),s})(),this.TerrainMaterial.normalNode=T(()=>{const e=d(1/this.TextureResolution).toVar(),t=d(1).sub(e).toVar(),s=Be.xyz.add(it(e,0,0)).toVar(),i=Be.xyz.add(it(0,0,e.negate())).toVar(),n=Be.xyz.toVar(),r=je(this.HeightTexture,Be.xz.add(.5).mul(t)).mul(this.Height);n.y.addAssign(r),s.y.addAssign(je(this.HeightTexture,s.xz.add(.5)).mul(t).mul(this.Height)),i.y.addAssign(je(this.HeightTexture,i.xz.add(.5)).mul(t).mul(this.Height));const u=s.sub(n).normalize(),c=i.sub(n).normalize();return Ps(Is(u,c))})(),this.TerrainMaterial.colorNode=T(()=>{const e=d(1/this.TextureResolution).toVar(),t=d(1).sub(e).toVar(),s=je(this.HeightTexture),i=d(this.Height).toVar(),n=d(.01).toVar(),r=it(0,.2,0).toVar(),u=it(.6,.4,.2).toVar(),c=V(this.TextureResolution),a=yt(1,V(c)),f=Be.xz.add(.5).mul(t).toVar(),m=s.sample(f.add(V(a.x.negate(),a.y.negate()))).r.toVar(),g=s.sample(f.add(V(0,a.y.negate()))).r.toVar(),C=s.sample(f.add(V(a.x,a.y.negate()))).r.toVar(),S=s.sample(f.add(V(a.x.negate(),0))).r.toVar(),y=s.sample(f).r.toVar(),b=s.sample(f.add(V(a.x,0))).r.toVar(),I=s.sample(f.add(V(a.x.negate(),a.y))).r.toVar(),B=s.sample(f.add(V(0,a.y))).r.toVar(),oe=s.sample(f.add(V(a.x,a.y))).r.toVar(),Le=C.add(ee(2,b)).add(oe).sub(m.add(ee(2,S)).add(I)).toVar(),be=I.add(ee(2,B)).add(oe).sub(m.add(ee(2,g)).add(C)).toVar();Le.mulAssign(i),be.mulAssign(i);const pe=st(V(Le,be)),Z=Je(0,n,pe),z=U(r,u,Z).toVar(),Y=y;return z.mulAssign(zt(.8,ee(.4,Y))),dt(z,1)})()}CreateRenderer(){this.GPURenderer=new Ns({alpha:!0,antialias:!0}),this.GPURenderer.shadowMap.enabled=!0,this.GPURenderer.shadowMap.type=ks,this.GPURenderer.toneMapping=Os,this.GPURenderer.setClearColor(0,0),this.GPURenderer.setPixelRatio(window.devicePixelRatio)}CreateTexture(e){this.HeightTexture=new Ls(Math.floor(this.TextureResolution),Math.floor(this.TextureResolution)),this.HeightTexture.format=$s,this.HeightTexture.type=Ts}CreateLight(){const e=new Tt(16777215,2);e.position.set(-10,10,0),e.castShadow=!0,e.shadow.autoUpdate=!0,e.shadow.camera.near=.1,e.shadow.camera.far=30,e.shadow.camera.top=8,e.shadow.camera.right=8,e.shadow.camera.bottom=-8,e.shadow.camera.left=-8,e.shadow.mapSize.set(8192,8192),e.shadow.radius=5,e.shadow.blurSamples=25,e.shadow.normalBias=.05,this.DirectionalLight=e;const t=new Tt(16777215,.5);t.position.set(10,10,0),this.DirectionalLight2=t}SetIsMeshGenerated(e){this.IsMeshGenerated.value=e}CreateTerrainMesh(e){this.SetIsMeshGenerated(!1);let t=new xi;t.onmessage=async s=>{var i=new Rs;i.setIndex(new at(new Uint32Array(s.data.indices),1)),i.setAttribute("position",new at(new Float32Array(s.data.position),3)),i.setAttribute("normal",new at(new Float32Array(s.data.normal),3)),i.setAttribute("uv",new at(new Float32Array(s.data.uv),2)),this.TerrainMesh=new Nt(i,this.TerrainMaterial),this.TerrainMesh.castShadow=!0,this.TerrainMesh.receiveShadow=!0,this.TerrainMesh.scale.set(10,1,10),this.TerrainMesh.position.set(0,.006,0),this.Scene.add(this.TerrainMesh),this.SetIsMeshGenerated(!0)},t.postMessage(e)}ChangeResolution(e){this._textureResolution=e,this.TerrainMaterial.dispose(),this.HeightTexture.dispose(),this.CreateTexture(this.TextureResolution),this.CreateMaterial(),this.TerrainMesh.material=this.TerrainMaterial,this.Scene.remove(this.DirectionalLight),this.Scene.remove(this.DirectionalLight2),this.DirectionalLight.dispose(),this.DirectionalLight2.dispose(),this.CreateLight(),this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2);const t=_e();t.Resolution=this.TextureResolution;const s=Ce();s.LockedNode!=null?this.Recalculate(s.LockedNode):s.SelectedNode!=null&&this.Recalculate(s.SelectedNode),requestAnimationFrame(()=>this.Render())}OnWindowResize(){if(this.GPURenderer==null||this.Camera==null||this._canvas==null)return;var e=this._canvas.offsetHeight,t=this._canvas.offsetWidth;this.GPURenderer.setSize(t,e);const s=t/e;this.Camera.aspect=s,this.Camera.updateProjectionMatrix(),requestAnimationFrame(()=>this.Render())}async Render(){await this.GPURenderer.renderAsync(this.Scene,this.Camera)}Mount(e){this._canvas=e;var t=this._canvas.offsetHeight,s=this._canvas.offsetWidth;this._canvas.appendChild(this.GPURenderer.domElement),this.GPURenderer.setSize(s,t),this.Camera.aspect=s/t,this.Controls=new Ds(this.Camera,this.GPURenderer.domElement),this.Controls.enablePan=!1,this.Controls.update(),window.addEventListener("resize",()=>this.OnWindowResize()),this.Render(),requestAnimationFrame(()=>this.Render)}RequestRender(){requestAnimationFrame(()=>this.Render)}async Recalculate(e,t=!1){t||e.Calculate();var s=e.Outputs[e.DefaultOutput].Value;const n=T(()=>{const r=ke.modInt(this.TextureResolution),u=ke.div(this.TextureResolution),c=ut(r,u),a=V(c.x,c.y).div(this.TextureResolution).toVar(),f=s(a).toVar();f.assign(Re(f,0,1)),As(this.HeightTexture,c,f).toWriteOnly()})().compute(this.TextureResolution*this.TextureResolution);this.GPURenderer.computeAsync(n).then(()=>{e.CalculationState=Ge.Calculated,requestAnimationFrame(()=>this.Render())})}SetGridVisible(e){this.GridMesh.visible=e,requestAnimationFrame(()=>this.Render())}}const Ii={class:"container"},Ni={key:0,style:{position:"relative",height:"100%",width:"100%"}},ki=H({__name:"Preview3D",setup(o){const e=$();e.value=new Pi;const t=$();var s=_e();const i=ae(()=>s.ChangeEvent);var n=Ce();const r=ae(()=>n.SelectedNode),u=ae(()=>{var y;return(y=e.value)==null?void 0:y.IsMeshGenerated});Qe(u,async(y,b)=>{requestAnimationFrame(()=>{var I;return(I=e.value)==null?void 0:I.Render()})}),Qe(i,async(y,b)=>{var I,B;n.LockedNode!=null?(I=e.value)==null||I.Recalculate(n.LockedNode,!1):r.value!=null&&((B=e.value)==null||B.Recalculate(r.value,!1))}),Qe(r,async y=>{var I,B;if(n.LockedNode!=null)(I=e.value)==null||I.Recalculate(n.LockedNode);else if(y!=null){var b=y;await((B=e.value)==null?void 0:B.Recalculate(b))}}),pt(()=>{Oe(()=>{var y;(y=e.value)==null||y.Mount(t.value)})});let c=!1;const a=()=>{c=!0},f=()=>{c=!1};window.addEventListener("mouseup",f),window.addEventListener("pointerup",f);const m=()=>{c&&requestAnimationFrame(()=>{var y;return(y=e.value)==null?void 0:y.Render()})},g=()=>{requestAnimationFrame(()=>{var y;return(y=e.value)==null?void 0:y.Render()})},C=$(!0),S=()=>{var y;C.value=!C.value,(y=e.value)==null||y.SetGridVisible(C.value)};return(y,b)=>{var oe;const I=ie("font-awesome-icon"),B=De("tooltip");return h(),v("div",Ii,[(oe=e.value)!=null&&oe.IsMeshGenerated?te("",!0):(h(),v("div",Ni,[p(ts,{style:{scale:"2"}}),b[0]||(b[0]=w("span",{style:{position:"absolute !important",top:"calc(50% + 20px)",width:"100%","text-align":"center"}}," Initializing mesh...",-1))])),w("div",{onMousedown:a,onMousemove:m,onWheel:g,onPointerdown:a,onPointermove:m,ref_key:"canvas",ref:t,style:{height:"100%",width:"100%"}},[p(bt,{class:"top-left"},{default:O(()=>[p(Ne,null,{default:O(()=>[j((h(),v("a",{onClick:S},[p(I,{icon:["fas","hashtag"]})])),[[B,"Switch Grid visibility",void 0,{bottom:!0}]])]),_:1})]),_:1})],544)])}}}),Oi=W(ki,[["__scopeId","data-v-f4b894cd"]]),Li={style:{width:"100%",height:"100%"}},$i={style:{height:"calc(100% - 80px)",display:"flex","flex-direction":"row"}},Ti={style:{width:"80%",height:"100%"}},Ri={style:{height:"50%",width:"100%",display:"block"}},Di={style:{"margin-left":"5px"}},Ai={style:{height:"50%"}},Bi={style:{width:"20%",height:"100%"}},Xi={style:{"margin-left":"5px"}},Gi=H({__name:"LayoutView",setup(o){return(e,t)=>{const s=ie("font-awesome-icon");return h(),v("div",Li,[p(Gn,{style:{height:"50px"}}),w("div",$i,[w("div",Ti,[w("div",Ri,[p(ft,{style:{display:"inline-block",width:"100%"}},{header:O(()=>[p(s,{icon:["fas","mountain-sun"]}),w("span",Di,P(e.$t("windows.thirdPreview")),1)]),default:O(()=>[p(Oi)]),_:1})]),w("div",Ai,[p(nn)])]),w("div",Bi,[p(ft,{style:{width:"100%"},"wheel-focus":!1},{header:O(()=>[p(s,{icon:["fas","sliders"]}),w("span",Xi,P(e.$t("windows.properties")),1)]),default:O(()=>[p(bi)]),_:1})])]),p(Js,{style:{height:"30px"}})])}}}),Yi=W(Gi,[["__scopeId","data-v-415e308f"]]),Ei=cs({history:hs("/"),routes:[{path:"/",name:"home",component:Yi}]});class Hi extends ne{constructor(){super(...arguments);l(this,"Name","nodes.clamp");l(this,"Inputs",[new G(!0,this,"Source")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Min",0,0,1),new M("Max",1,0,1)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value);this.Outputs[0].Value=T(([i])=>{var r;if(!this.Inputs[0].IsConnected)return d(0);const n=(r=this.Inputs[0].Links[0].In)==null?void 0:r.Value(i);return Re(n,t,s)})}}class Ui extends ne{constructor(){super(...arguments);l(this,"Name","nodes.combine");l(this,"Inputs",[new G(!0,this,"Source 1"),new G(!0,this,"Source 2")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Mode","Burn",["Burn","Darken","Difference","Dodge","Divide","Exclusion","HardLight","HardMix","Lighten","LinearBurn","LinearDodge","LinearLight","LinearLightAddSub","Multiply","Negation","Overlay","PinLight","Screen","SoftLight","Subtract","VividLight","Overwrite"]),new M("Strength",0,0,1)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=this.Properties[0].Value,s=x(this.Properties[1].Value);this.Outputs[0].Value=T(([i])=>{var u,c;if(!this.Inputs[0].IsConnected||!this.Inputs[1].IsConnected)return d(0);const n=(u=this.Inputs[0].Links[0].In)==null?void 0:u.Value(i).toVar(),r=(c=this.Inputs[1].Links[0].In)==null?void 0:c.Value(i).toVar();switch(t){case"Burn":{const a=d(1).sub(d(1).sub(r).div(n)).toVar();return U(n,a,s)}case"Darken":{const a=ue(n,r).toVar();return U(n,a,s)}case"Difference":{const a=tt(r.sub(n)).toVar();return U(n,a,s)}case"Dodge":{const a=n.div(r.add(d(1e-12))).toVar();return U(n,a,s)}case"Divide":{const a=n.div(d(1).sub(r)).toVar();return U(n,a,s)}case"Exclusion":{const a=r.add(n).sub(d(2).mul(r).mul(n)).toVar();return U(n,a,s)}case"HardLight":{const a=d(F(1,ee(2,F(1,n)).mul(F(1,r)))).toVar(),f=d(ee(2,n).mul(r)).toVar(),m=d(ze(r,.5)).toVar(),g=d(f.mul(m).add(d(1).sub(m).mul(a))).toVar();return U(n,g,s)}case"HardMix":{const a=d(ze(d(1).sub(n),r)).toVar();return U(n,a,s)}case"Lighten":{const a=ye(r,n).toVar();return U(n,a,s)}case"LinearBurn":{const a=d(n.add(r.sub(1))).toVar();return U(n,a,s)}case"LinearDodge":{const a=n.add(r).toVar();return U(n,a,s)}case"LinearLight":{const a=d(Xs(r.lessThan(.5),ye(n.add(d(2).mul(r).sub(d(1))),d(0)),ue(n.add(d(2).mul(r.sub(.5))),d(1)))).toVar();return U(n,a,s)}case"LinearLightAddSub":{const a=d(r.add(ee(2,n).sub(1))).toVar();return U(n,a,s)}case"Multiply":{const a=n.mul(r).toVar();return U(n,a,s)}case"Negation":{const a=d(F(1,tt(F(1,r).sub(n)))).toVar();return U(n,a,s)}case"Overlay":{const a=d(F(1,ee(2,F(1,n)).mul(F(1,r)))).toVar(),f=d(ee(2,n).mul(r)).toVar(),m=d(ze(n,.5)).toVar(),g=d(f.mul(m).add(d(1).sub(m).mul(a))).toVar();return U(n,g,s)}case"PinLight":{const a=d(ze(.5,r)).toVar(),f=d(a.mul(ye(ee(2,n.sub(.5)),r))).toVar(),m=d(f.add(F(1,a).mul(ue(ee(2,n),r)))).toVar();return U(n,m,s)}case"Screen":{const a=d(F(1,F(1,r).mul(F(1,n)))).toVar();return U(n,a,s)}case"SoftLight":{const a=d(F(1,ee(2,F(1,n)).mul(F(1,r)))).toVar(),f=d(Bs(n).mul(ee(2,r).sub(1)).add(ee(2,n).mul(F(1,r)))).toVar(),m=d(ze(r,.5)).toVar(),g=d(f.mul(m).add(d(1).sub(m).mul(a))).toVar();return U(n,g,s)}case"Subtract":{const a=n.sub(r).toVar();return U(n,a,s)}case"VividLight":{const a=d(F(1,F(1,r).div(ee(2,n)))).toVar(),f=d(r.div(ee(2,F(1,n)))).toVar(),m=d(ze(.5,n)).toVar(),g=d(f.mul(m).add(d(1).sub(m).mul(a))).toVar();return U(n,g,s)}case"Overwrite":return U(n,r,s)}return d(0)})}}class Wi extends ne{constructor(){super(...arguments);l(this,"Name","nodes.constant");l(this,"Outputs",[new G(!1,this,"Output")]);l(this,"Properties",[new M("Height",0,0,1)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=T(([s])=>d(t))}}class zi extends ne{constructor(){super(...arguments);l(this,"Name","nodes.cracks");l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Scale",10,0,100,0,"Transform","%"),new M("Angle",0,0,100,0,"Noise",""),new M("Thickness",.03,0,1,0,"Noise",""),new M("Distortion",0,0,100,0,"Distortion",""),new M("Octaves",10,0,100,1,"Distortion",""),new M("Scale",10,0,100,0,"Distortion",""),new M("Offset X",0,-100,100,0,"Distortion",""),new M("Offset Y",0,-100,100,0,"Distortion","")]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value),r=x(this.Properties[4].Value),u=x(this.Properties[5].Value),c=x(this.Properties[6].Value),a=x(this.Properties[7].Value);this.Outputs[0].Value=T(([f])=>{const m=V(f.x,f.y).toVar(),g=V(kt(m.mul(2).mul(.5),r,V(c,a),u)).mul(n).mul(.2);return no({uv:m.add(g),angle:s,scale:t,thickness:i})})}}const Fi=T(([o,e,t])=>{const s=d(t).toVar(),i=d(e).toVar(),n=d(o).toVar();s.assign(ye(0,s));const r=d(ye(0,ue(1,i.sub(n).add(s).div(d(2).mul(s))))).toVar();return n.mul(r).add(i.mul(d(1).sub(r)).sub(s.mul(r).mul(d(1).sub(r))))}).setLayout({name:"smoothMin",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),qi=T(([o,e,t])=>{const s=d(t).toVar(),i=d(e).toVar(),n=d(o).toVar();s.assign(ue(0,s.negate()));const r=d(ye(0,ue(1,i.sub(n).add(s).div(d(2).mul(s))))).toVar();return n.mul(r).add(i.mul(d(1).sub(r)).sub(s.mul(r).mul(d(1).sub(r))))}).setLayout({name:"smoothMax",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),Zi=T(([o])=>{const e=V(o).toVar();return Ee(Ke(Ze(e.xy,V(12.9898,78.233))).mul(43758.5453123))}).setLayout({name:"random",type:"float",inputs:[{name:"st",type:"vec2"}]}),Ki=T(([o,e,t])=>{const s=d(t).toVar(),i=d(e).toVar(),n=V(o).toVar(),r=V(n.mul(i)).toVar(),u=V(vt(r)).toVar(),c=V(Ee(r)).toVar(),a=d(Zi(u).mul(2).sub(1).mul(s)).toVar(),f=d(Ke(a)).toVar(),m=d(St(a)).toVar(),g=V(c.sub(.5)).toVar(),C=V().toVar();return C.x.assign(g.x.mul(m).sub(g.y.mul(f))),C.y.assign(g.x.mul(f).add(g.y.mul(m))),C.add(.5).add(u).mod(1)}).setLayout({name:"tilingWithLimitedRotation",type:"vec2",inputs:[{name:"uv",type:"vec2"},{name:"tileCount",type:"float"},{name:"maxAngle",type:"float"}]});class ji extends ne{constructor(){super(...arguments);l(this,"Name","nodes.crater");l(this,"Outputs",[new G(!1,this,"Output")]);l(this,"Properties",[new M("Smoothness",.5,0,1,0,"Crater params",""),new M("FloorHeight",-1,-5,5,0,"Crater params",""),new M("Radius",.16,0,1,0,"Crater params",""),new M("RimWidth",1.35,0,100,0,"Crater params",""),new M("RimSteepness",4,0,100,0,"Crater params",""),new M("X",.5,0,1,0,"Transform",""),new M("Y",.5,0,1,0,"Transform","")]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value),r=x(this.Properties[4].Value),u=x(this.Properties[5].Value),c=x(this.Properties[6].Value);this.Outputs[0].Value=T(([a])=>{const f=V(a.x,a.y).toVar(),m=V(u,c).toVar(),g=d(st(f.sub(m)).div(ye(i,1e-4))).toVar(),C=d(g.mul(g).sub(1)).toVar(),S=d(ue(g.sub(1).sub(n),0)).toVar(),y=d(r.mul(S).mul(S)).toVar(),b=d(qi(C,s,t)).toVar();return b.assign(Fi(b,y,t)),b.mul(i).add(.5).toVar()})}}class Ji extends ne{constructor(){super(...arguments);l(this,"Name","nodes.falloff");l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Strength",0,0,10)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=T(([s])=>{const i=V(s.x,s.y).toVar(),n=d(Zt(V(.5),i.mod(1))).mul(t).toVar(),r=U(d(1),d(0),n).toVar();return ct(Re(r,0,1),2)})}}class Qi extends ne{constructor(){super(...arguments);l(this,"Name","nodes.fastErosion");l(this,"Inputs",[new G(!0,this,"Inpute Height")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Tiles",4,0,20,0,"Erosion",""),new M("Octaves",5,0,20,1,"Erosion",""),new M("Gain",.5,0,1,0,"Erosion",""),new M("Lacunarity",2,0,10,0,"Erosion",""),new M("Slope strength",3,0,10,0,"Erosion",""),new M("Branch strength",3,0,10,0,"Erosion",""),new M("Erosion Strength",.04,0,1,0,"Erosion","")]);l(this,"IsRealtimeUpdate",!1);l(this,"terrainHeight");l(this,"waterVolume");l(this,"sedimentAmount");l(this,"tempTerrainHeight");l(this,"tempWaterVolume");l(this,"tempSedimentAmount")}Calculate(){this.BaseCalculate();const t=_e(),s=t.GetRenderer(),i=t.Resolution,n=x(.1),r=x(.1),u=x(.1),c=x(1),a=x(.1),f=x(.1),m=x(9.8),g=x(.01),C=x(3),S=x(i),y=x(i);this.terrainHeight=Fe(i*i,"float"),this.waterVolume=Fe(i*i,"float"),this.sedimentAmount=Fe(i*i,"float"),this.tempTerrainHeight=Fe(i*i,"float"),this.tempWaterVolume=Fe(i*i,"float"),this.tempSedimentAmount=Fe(i*i,"float");const b=T(()=>{var A;const Z=ke.modInt(i),z=ke.div(i),Y=ut(Z,z),X=V(Y.x,Y.y).div(i).toVar();if(this.Inputs[0].IsConnected){const K=((A=this.Inputs[0].Links[0].In)==null?void 0:A.Value)(X).toVar();this.terrainHeight.element(ke).assign(K)}}),I=T(([Z,z])=>{const Y=d(z).toVar(),X=d(Z).toVar();return X.assign(Re(X,ve(0),S.sub(ve(1)))),Y.assign(Re(Y,ve(0),y.sub(ve(1)))),Y.mul(S).add(X)}),B=T(([Z,z])=>{const Y=d(z).toVar(),X=V(Z).toVar(),A=d(ee(.01,Ee(Ke(d(Y).mul(12.9898)).mul(43758.5453)).mul(2).sub(1))).toVar();return Ut(X.add(V(A)))});T(([Z,z,Y])=>{const X=ve(Y).toVar(),A=d(z).toVar(),se=d(Z).toVar(),K=d(I(se,A)).toVar(),me=d(this.tempWaterVolume.element(K).add(r.mul(n))).toVar(),de=d(this.tempSedimentAmount.element(K)).toVar(),xe=d(this.tempTerrainHeight.element(K)).toVar(),$e=V(V(this.tempTerrainHeight.element(I(se.add(1),A)).sub(this.tempTerrainHeight.element(I(se.sub(1),A))),this.tempTerrainHeight.element(I(se,A.add(1))).sub(this.tempTerrainHeight.element(I(se,A.sub(1))))).mul(.5)).toVar(),Te=d(st($e)).toVar();rt(me.greaterThan(0).and(Te.greaterThan(0)),()=>{const Ie=V(B($e,X)).toVar(),Ue=d(ue(me,Te.mul(m).mul(n))).toVar(),Me=d(ue(me,Ue)).toVar(),_=qe(qe(se,A).add(qe(Rt(Ie)))).toVar(),R=ve(I(_.x,_.y)).toVar();this.tempWaterVolume.element(R).addAssign(Me),me.subAssign(Me);const k=d(ye(Te,g).mul(Me).mul(c)).toVar();rt(de.lessThan(k),()=>{const D=d(ue(k.sub(de).mul(a),xe.sub(this.tempTerrainHeight.element(R)))).toVar();de.addAssign(D),this.tempTerrainHeight.element(K).assign(xe.sub(D))}).Else(()=>{const D=d(de.sub(k).mul(f)).toVar();de.subAssign(D),this.tempTerrainHeight.element(K).assign(xe.add(D))});const N=d(de.mul(Me).div(me)).toVar();this.tempSedimentAmount.element(R).addAssign(N),de.subAssign(N)}),me.mulAssign(F(1,u.mul(n))),de.assign(ye(0,de)),this.tempWaterVolume.element(K).assign(me),this.tempSedimentAmount.element(K).assign(de)});const oe=T(([Z,z])=>{const Y=ve(z).toVar(),X=ut(Z.x,Z.y).toVar();return X.y.mul(Y).add(X.x)});T(()=>{this.tempTerrainHeight.element(ke).addAssign(.5)});const Le=T(()=>{const Z=ve(ke).toVar(),z=ve(Z.modInt(S)).toVar(),Y=ve(Z.div(S)).toVar(),X=ve(I(z,Y)).toVar();this.tempTerrainHeight.element(X).assign(this.terrainHeight.element(X)),this.tempWaterVolume.element(X).assign(this.waterVolume.element(X)),this.tempSedimentAmount.element(X).assign(this.sedimentAmount.element(X)),wt(),Ht(C,()=>{const A=d(I(z,Y)).toVar(),se=d(this.tempWaterVolume.element(A).add(r.mul(n))).toVar(),K=d(this.tempSedimentAmount.element(A)).toVar(),me=d(this.tempTerrainHeight.element(A)).toVar(),de=V(V(this.tempTerrainHeight.element(I(z.add(1),Y)).sub(this.tempTerrainHeight.element(I(z.sub(1),Y))),this.tempTerrainHeight.element(I(z,Y.add(1))).sub(this.tempTerrainHeight.element(I(z,Y.sub(1))))).mul(.5)).toVar(),xe=d(st(de)).toVar();rt(se.greaterThan(0).and(xe.greaterThan(0)),()=>{const $e=V(B(de,Z)).toVar(),Te=d(ue(se,xe.mul(m).mul(n))).toVar(),Ie=d(ue(se,Te)).toVar(),Ue=qe(qe(z,Y).add(qe(Rt($e)))).toVar(),Me=ve(I(Ue.x,Ue.y)).toVar();this.tempWaterVolume.element(Me).addAssign(Ie),se.subAssign(Ie);const _=d(ye(xe,g).mul(Ie).mul(c)).toVar();rt(K.lessThan(_),()=>{const k=d(ue(_.sub(K).mul(a),me.sub(this.tempTerrainHeight.element(Me)))).toVar();K.addAssign(k),this.tempTerrainHeight.element(A).assign(me.sub(k))}).Else(()=>{const k=d(K.sub(_).mul(f)).toVar();K.subAssign(k),this.tempTerrainHeight.element(A).assign(me.add(k))});const R=d(K.mul(Ie).div(se)).toVar();this.tempSedimentAmount.element(Me).addAssign(R),K.subAssign(R)}),se.mulAssign(F(1,u.mul(n))),K.assign(ye(0,K)),this.tempWaterVolume.element(A).assign(se),this.tempSedimentAmount.element(A).assign(K),wt(),this.terrainHeight.element(A).assign(this.tempTerrainHeight.element(A)),this.waterVolume.element(A).assign(this.tempWaterVolume.element(A)),this.sedimentAmount.element(A).assign(this.tempSedimentAmount.element(A)),wt()}),this.terrainHeight.element(X).assign(this.tempTerrainHeight.element(X)),this.waterVolume.element(X).assign(this.tempWaterVolume.element(X)),this.sedimentAmount.element(X).assign(this.tempSedimentAmount.element(X))}),be=b().compute(i*i),pe=Le().compute(i*i);s==null||s.GPURenderer.compute(be),s==null||s.GPURenderer.computeAsync(pe),this.Outputs[0].Value=T(([Z])=>{if(this.Inputs[0].IsConnected){V(Z.x,Z.y).toVar();const z=ke.modInt(i),Y=ke.div(i),X=ut(z,Y);return this.terrainHeight.element(oe(X,i)).toVar()}else return 0})}}class ea extends ne{constructor(){super(...arguments);l(this,"Name","nodes.gradientNoise");l(this,"Outputs",[new G(!1,this,"Output")]);l(this,"Properties",[new M("Scale",10,0,100),new M("Offset X",0,0,100),new M("Offset Y",0,0,100)]);l(this,"IsRealtimeUpdate",!0);l(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value);this.Outputs[0].Value=T(([n])=>{const r=V(n.x,n.y).mul(t).toVar(),u=V(s,i).toVar();return r.addAssign(u),es(r)})}}class ta extends ne{constructor(){super(...arguments);l(this,"Name","nodes.invert");l(this,"Inputs",[new G(!0,this,"Source")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate(),this.Outputs[0].Value=T(([t])=>{var i;if(!this.Inputs[0].IsConnected)return d(0);const s=(i=this.Inputs[0].Links[0].In)==null?void 0:i.Value(t);return d(1).sub(s)})}}class sa extends ne{constructor(){super(...arguments);l(this,"Name","nodes.mountain");l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Scale",3.55,0,100,0,"Noise Transform","%"),new M("Octaves Count",10,1,50,1,"Noise Params",""),new M("Offset X",-.08,-100,100,0,"Noise Transform",""),new M("Offset Y",-.54,-100,100,0,"Noise Transform",""),new M("Falloff",3,0,20,0,"Mountain",""),new M("Height",1,0,1,0,"Mountain",""),new M("Position X",.5,0,1,0,"Mountain Transform",""),new M("Position Y",.5,0,1,0,"Mountain Transform","")]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value),r=x(this.Properties[4].Value),u=x(this.Properties[5].Value),c=x(this.Properties[6].Value),a=x(this.Properties[7].Value);this.Outputs[0].Value=T(([f])=>{const m=V(f.x,f.y).toVar(),g=d(Zt(V(c,a),m)).mul(r).toVar(),C=U(d(1),d(0),g).toVar(),S=ct(Re(C,0,1),2),y=m.sub(V(c,a).sub(.5)).toVar(),b=kt(y,s,V(i,n),t).toVar();return Re(S.mul(b).mul(d(1.45).mul(u)),0,1)})}}class oa extends ne{constructor(){super(...arguments);l(this,"Name","nodes.redistribution");l(this,"Inputs",[new G(!0,this,"Source")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Exponent",1,1,10)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=T(([s])=>{var n;return this.Inputs[0].IsConnected?((n=this.Inputs[0].Links[0].In)==null?void 0:n.Value(s)).pow(t):d(0)})}}class na extends ne{constructor(){super(...arguments);l(this,"Name","nodes.terrace");l(this,"Inputs",[new G(!0,this,"Param 1")]);l(this,"Outputs",[new G(!1,this,"Output")]);l(this,"Properties",[new M("Count",3,0,10,1)]);l(this,"IsRealtimeUpdate",!0);l(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=T(([s])=>{var i;if(this.Inputs[0].IsConnected){const r=((i=this.Inputs[0].Links[0].In)==null?void 0:i.Value)(s).toVar();if(this.Properties[0].Value==0)return r;const u=d(1).div(t).toVar(),c=vt(r.div(u)).toVar(),a=r.sub(c.mul(u)).div(u).toVar(),f=ue(d(2).mul(a),d(1)).toVar();return c.add(f).mul(u).toVar()}else return 0})}}class ia extends ne{constructor(){super(...arguments);l(this,"Name","nodes.voronoi");l(this,"Outputs",[new G(!1,this,"Output"),new G(!1,this,"Cells"),new G(!1,this,"Bubbles")]);l(this,"Properties",[new M("Scale",10,1,100,0,"Transform","%"),new M("OffsetX",0,0,100,0,"Transform",""),new M("OffsetY",0,0,100,0,"Transform",""),new M("Angle",5,0,100,0,"Noise","")]);l(this,"IsRealtimeUpdate",!0);l(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value);this.Outputs[0].Value=T(([r])=>{const u=V(r.x,r.y).toVar(),c=V(s,i).toVar();u.addAssign(c);const a=Vt({UV:u,angleOffset:n,cellDensity:t}).toVar();return ct(a.x,2)}),this.Outputs[1].Value=T(([r])=>{const u=V(r.x,r.y).toVar(),c=V(s,i).toVar();return u.addAssign(c),Vt({UV:u,angleOffset:n,cellDensity:t}).toVar().y}),this.Outputs[2].Value=T(([r])=>{const u=V(r.x,r.y).toVar(),c=V(s,i).toVar();u.addAssign(c);const a=Vt({UV:u,angleOffset:n,cellDensity:t}).toVar();return Gs(ct(a.x,2))})}}class aa extends ne{constructor(){super(...arguments);l(this,"Name","nodes.transform");l(this,"Inputs",[new G(!0,this,"Input")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Properties",[new M("Scale X",1,0,100,0,"Scale",""),new M("Scale Y",1,0,100,0,"Scale",""),new M("Position X",0,-100,100,0,"Position",""),new M("Position Y",0,-100,100,0,"Position",""),new M("Midpoint X",.5,0,1,0,"Rotation",""),new M("Midpoint Y",.5,0,1,0,"Rotation",""),new M("Angle",0,-360,360,0,"Rotation","")]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),i=x(this.Properties[2].Value),n=x(this.Properties[3].Value),r=x(this.Properties[4].Value),u=x(this.Properties[5].Value),c=x(this.Properties[6].Value);this.Outputs[0].Value=T(([a])=>{var I;const f=V(a.x,a.y).toVar(),m=V(t,s).toVar(),g=V(i,n).toVar(),C=V(r,u).toVar(),S=c.mul(Kt.div(180)).toVar(),y=V(St(S).mul(f.x.sub(C.x)).add(Ke(S).mul(f.y.sub(C.y))).add(C.x),St(S).mul(f.y.sub(C.y)).sub(Ke(S).mul(f.x.sub(C.x))).add(C.y));return f.assign(y),f.addAssign(g),f.mulAssign(m),(I=this.Inputs[0].Links[0].In)==null?void 0:I.Value(f).toVar()})}}class ra extends ne{constructor(){super(...arguments);l(this,"Inputs",[new G(!0,this,"Input")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Name","nodes.tile");l(this,"Properties",[new M("Tile Count",1,0,100,1),new M("Angle Threshold",0,0,360,0)]);l(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value);this.Outputs[0].Value=T(([i])=>{var a;var n=V(i).toVar(),r=s.mul(Kt.div(180));const u=Ki(n,t,r).toVar();return(a=this.Inputs[0].Links[0].In)==null?void 0:a.Value(u).toVar()})}}class la extends ne{constructor(){super(...arguments);l(this,"Inputs",[new G(!0,this,"Input")]);l(this,"Outputs",[new G(!1,this,"Result")]);l(this,"Name","nodes.height");l(this,"IsRealtimeUpdate",!0);l(this,"Properties",[new M("Height",1,0,1,0)])}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value);this.Outputs[0].Value=T(([s])=>{var r;if(!this.Inputs[0].IsConnected)return d(0);var i=V(s).toVar();return((r=this.Inputs[0].Links[0].In)==null?void 0:r.Value(i).toVar()).mul(t)})}}function ua(){Q.registerStr("nodes.buffer","",Xe),Q.registerStr("nodes.fake","",os),Q.registerStr("nodes.constant","nodeCategories.testNodes",Wi),Q.registerStr("nodes.perlinNoise","nodeCategories.testNodes",io),Q.registerStr("nodes.mountain","nodeCategories.testNodes",sa),Q.registerStr("nodes.terrace","nodeCategories.testNodes",na),Q.registerStr("nodes.combine","nodeCategories.testNodes",Ui),Q.registerStr("nodes.clamp","nodeCategories.testNodes",Hi),Q.registerStr("nodes.invert","nodeCategories.testNodes",ta),Q.registerStr("nodes.redistribution","nodeCategories.testNodes",oa),Q.registerStr("nodes.gradientNoise","nodeCategories.testNodes",ea),Q.registerStr("nodes.voronoi","nodeCategories.testNodes",ia),Q.registerStr("nodes.crater","nodeCategories.testNodes",ji),Q.registerStr("nodes.falloff","nodeCategories.testNodes",Ji),Q.registerStr("nodes.fastErosion","nodeCategories.testNodes",Qi),Q.registerStr("nodes.cracks","nodeCategories.testNodes",zi),Q.registerStr("nodes.transform","nodeCategories.testNodes",aa),Q.registerStr("nodes.tile","nodeCategories.testNodes",ra),Q.registerStr("nodes.height","nodeCategories.testNodes",la)}const da={en:{"":"",logo:"Mashuk",windows:{thirdPreview:"3D Preview",secondPreview:"2D Preview",properties:"Node properties",graph:"Graph",nodesList:"Nodes list"},tt:{undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",delete:"Delete node/selected",fullscreen:"Fullscreen",save:"Save",load:"Load",presets:"Presets",resetView:"Reset view",resetParams:"Reset node parameters to default",lockPreview:"Lock Preview",unlockPreview:"Unlock Preview",mesh_resolution:"Resolution",new:"New project",settings:"Settings",menu:"Menu",resolutionWarning:"Warning! Selecting a high resolution will increase video memory consumption and processing speed."},hints:{graphLmb:"LMB: Select/Drag node",graphWheel:"Wheel: Zoom/Drag work space"},nodes:{constant:"Constant",perlinNoise:"Perlin Noise",mountain:"Mountain",terrace:"Terrace",combine:"Combine",clamp:"Clamp",invert:"Invert",redistribution:"Redistribution",gradientNoise:"Gradient Noise",voronoi:"Voronoi",crater:"Crater",falloff:"Falloff",fastErosion:"Fast Erosion",cracks:"Cracks",transform:"Transform",tile:"Tile",height:"Height"},nodeCategories:{testNodes:"Test nodes"}},ru:{logo:"Машук",windows:{thirdPreview:"3D Просмотр",secondPreview:"2D Просмотр",properties:"Параметры узла",graph:"Граф",nodesList:"Список узлов"},tt:{undo:"Отменить",redo:"Повторить",copy:"Копировать",paste:"Вставить",delete:"Удалить узел/выделенные",fullscreen:"На весь экран",save:"Сохранить",load:"Загрузить",presets:"Предустановки",resetView:"Сбросить вид",resetParams:"Сбросить параметры узла до значений по умолчанию",lockPreview:"Закрепить отображение",unlockPreview:"Открепить отображение",mesh_resolution:"Разрешение",new:"Новый проект",settings:"Настройки",menu:"Меню",resolutionWarning:"Внимание! Выбор высокого разрешения влечет за собой увеличение потребления видеопамяти и скорости обработки"},hints:{graphLmb:"ЛКМ: Выделить/Передвинуть узел",graphWheel:"Колесо мыши: Приближение/Перемещение рабочей области"},nodes:{constant:"Константа",perlinNoise:"Шум Перлина",mountain:"Гора",terrace:"Террасы",combine:"Комбинирование",clamp:"Ограничение",invert:"Инверсия",redistribution:"Перераспределение",gradientNoise:"Градиентный Шум",voronoi:"Шум Вороного",crater:"Кратер",falloff:"Спад",fastErosion:"Быстрая Эрозия",cracks:"Трещины",transform:"Преобразование",tile:"Плитка",height:"Высота"},nodeCategories:{testNodes:"Тестовые узлы"}}};Pt.options.themes.tooltip.delay.show=0;Pt.options.distance=10;fs.add(Ys,ps);const ca=ms({legacy:!1,locale:"en",fallbackLocale:"en",messages:da}),He=vs(zs);He.component("font-awesome-icon",gs);He.use(ws());He.use(Ei);He.use(Pt);He.use(ca);He.use(Vs);He.mount("#app");ua();
