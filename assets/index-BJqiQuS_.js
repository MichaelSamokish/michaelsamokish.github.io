var Zt=Object.defineProperty;var Kt=(i,e,t)=>e in i?Zt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var r=(i,e,t)=>Kt(i,typeof e!="symbol"?e+"":e,t);import{d as z,g as yt,c as re,r as ne,a as q,b as V,o as m,u as ue,R as jt,e as I,f as w,_ as F,v as St,h as nt,i as _t,j as $,k as qe,l as Ne,w as he,m as K,n as E,t as D,p as se,q as pe,F as J,s as Ve,x as k,T as Jt,y as Qt,z as ye,A as Me,B as Tt,C as Ee,D as es,E as Mt,G as Fe,H as xt,I as ot,J as ts,K as ss,L as bt,M as ns,N as os,O as is,P as as,Q as rs,S as ls,V as us}from"./vendor-jUf6HuyN.js";import{w as At,F as O,i as de,f as d,v as x,L as Pt,a as Ye,b as Se,d as Ce,m as B,n as Gt,c as He,s as ve,u as b,e as mt,g as vt,h as W,j as Xt,k as ie,p as ds,l as ze,o as cs,q as it,r as ee,t as hs,M as Bt,D as Ct,P as Et,x as It,y as fs,z as ps,A as Je,B as Ie,C as ms,E as ct,S as vs,G as gs,H as ws,I as Te,J as Qe,K as kt,N as Vs,O as ys,W as Ss,Q as _s,R as xs,T as bs,U as Ps,V as Cs,X as Ot,Y as Is,Z as be,_ as st,$ as Ns,a0 as Ae,a1 as Ms,a2 as we,a3 as ks,a4 as at,a5 as Yt,a6 as rt,a7 as Ge,a8 as et,a9 as Xe,aa as Lt,ab as ht,ac as Os,ad as Ht}from"./three-CoysxtaA.js";import{i as Ls}from"./icons-CNPGi31y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const $s={key:1,class:"gpu-error-box disable-user-select"},Rs={class:"gpu-error-message-box"},Ds={style:{"font-size":"100px","text-align":"center",color:"var(--vt-c-red)"}},Ts=z({__name:"App",setup(i){const e=yt(),t=localStorage.getItem("userLang");t&&e!=null&&(e.appContext.config.globalProperties.$i18n.locale=t);const s=re(()=>navigator.gpu);return(n,o)=>{const a=ne("font-awesome-icon");return s.value?(m(),q(ue(jt),{key:0})):(m(),V("div",$s,[I("div",Rs,[I("div",Ds,[w(a,{icon:["fas","circle-xmark"]})]),o[0]||(o[0]=I("h1",null,"WebGPU is not supported on this browser.",-1))])]))}}}),As=F(Ts,[["__scopeId","data-v-286205d8"]]);class Ut{constructor(){r(this,"Id",St());r(this,"In",null);r(this,"Out",null);r(this,"IsSelected",!1)}SetSelected(e){var s,n,o;var t=this.In!=null?(s=this.In.ParentNode)==null?void 0:s.ParentGraph:(o=(n=this.Out)==null?void 0:n.ParentNode)==null?void 0:o.ParentGraph;t!=null&&e==!0&&t.DeselectAll(),this.IsSelected=e}DeleteLinkFromTerminals(){var s,n;var e=(s=this.In)==null?void 0:s.Links.indexOf(this);e!=null&&this.In!=null&&this.In.Links.splice(e,1);var t=(n=this.Out)==null?void 0:n.Links.indexOf(this);t!=null&&this.Out!=null&&this.Out.Links.splice(t,1)}}class L{constructor(e,t){r(this,"X",0);r(this,"Y",0);this.X=e,this.Y=t}get Length(){return Math.sqrt(this.X*this.X+this.Y*this.Y)}get Normalized(){return L.Div(this,this.Length)}Reset(){this.X=0,this.Y=0}static Add(e,t){return t instanceof L?new L(e.X+t.X,e.Y+t.Y):typeof t=="number"?new L(e.X+t,e.Y+t):e}static Sub(e,t){return t instanceof L?new L(e.X-t.X,e.Y-t.Y):typeof t=="number"?new L(e.X-t,e.Y-t):e}static Mul(e,t){return t instanceof L?new L(e.X*t.X,e.Y*t.Y):typeof t=="number"?new L(e.X*t,e.Y*t):e}static Div(e,t){return t instanceof L?new L(e.X/t.X,e.Y/t.Y):typeof t=="number"?new L(e.X/t,e.Y/t):e}}var Wt=(i=>(i[i.none=0]="none",i[i.Buffer=1]="Buffer",i[i.Primitives=2]="Primitives",i[i.GeoPrimitives=3]="GeoPrimitives",i[i.Warps=4]="Warps",i[i.Adjastments=5]="Adjastments",i[i.Profile=6]="Profile",i[i.Filters=7]="Filters",i[i.Erosion=8]="Erosion",i[i.Snow=9]="Snow",i[i.Water=10]="Water",i[i.Data=11]="Data",i[i.Color=12]="Color",i[i.Render=13]="Render",i[i.Output=14]="Output",i))(Wt||{}),Oe=(i=>(i[i.NotCalculated=0]="NotCalculated",i[i.Calculation=1]="Calculation",i[i.Calculated=2]="Calculated",i))(Oe||{});class P{constructor(e,t,s,n=0,o=0,a="",c=""){r(this,"Name","");r(this,"Description","");r(this,"Value");r(this,"Min",-10);r(this,"Max",10);r(this,"Suffix");r(this,"Category");r(this,"Step");r(this,"valueList");r(this,"Default");this.Name=e,this.Value=t,this.Default=t,this.Min=typeof s=="number"?s:0,this.Max=n,this.Suffix=c,this.Category=a,this.Step=o,this.valueList=s instanceof Array?s:void 0}Reset(){this.Value=this.Default}}class Q{constructor(){r(this,"Id",St());r(this,"Position",new L(0,0));r(this,"LastPosition",new L(0,0));r(this,"Name","");r(this,"Category",Wt.none);r(this,"Properties");r(this,"Inputs",[]);r(this,"Outputs",[]);r(this,"IsSelected",!1);r(this,"Height",0);r(this,"Width",0);r(this,"IsCalculated",!1);r(this,"ParentGraph",null);r(this,"CalculationState",Oe.NotCalculated);r(this,"IsRealtimeUpdate",!1);r(this,"DefaultOutput",0)}Move(e,t){this.Position=new L(e,t)}SetSize(e,t){this.Height=e,this.Width=t}SetSelected(e){this.IsSelected=e;const t=fe();e?t.SelectedNode=this:t.SelectedNode==this&&(t.SelectedNode=null)}SetLastPosition(e,t){this.LastPosition.X=e,this.LastPosition.Y=t}BaseCalculate(){this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,n;(n=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||n.SetNotCalculated()})}),this.Inputs.forEach(e=>{var t,s,n,o;e.IsConnected&&((s=(t=e.Links[0].In)==null?void 0:t.ParentNode)==null||s.Calculate(),(o=(n=e.Links[0].In)==null?void 0:n.ParentNode)==null||o.SetCalculated())})}SetNotCalculated(){this.CalculationState=Oe.NotCalculated,this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,n;(n=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||n.SetNotCalculated()})})}SetCalculated(){this.CalculationState=Oe.Calculated}Calculate(){}}class X{constructor(e,t,s){r(this,"Guid",St());r(this,"Links",new Array);r(this,"IsInput",!1);r(this,"ParentNode",null);r(this,"Position",new L(0,0));r(this,"OffsetPosition",new L(0,0));r(this,"Value",null);r(this,"Name","");this.ParentNode=t,this.IsInput=e,this.Name=s}get IsConnected(){return this.Links.length>0}SetOffset(e,t){this.OffsetPosition=new L(e,t)}SetPosition(e,t){this.Position=new L(e,t)}}class j{static register(e){var t=new e;this.classMap.set(t.constructor.name,e)}static registerStr(e,t,s){this.classMap.set(e,s),this.groupsMap.has(t)||this.groupsMap.set(t,new Map);var n=this.groupsMap.get(t);n==null||n.set(e,s)}static create(e,...t){const s=this.classMap.get(e);if(!s)throw new Error(`Class ${e} not registered`);return new s(...t)}static getGroups(){return this.groupsMap}}r(j,"classMap",new Map),r(j,"groupsMap",new Map);class Be{static Serialize(e){var a,c,f,l,u,h,p,_;var t=new Gs;if(e.Nodes!=null&&e.Nodes.length>0)for(const S of e.Nodes){var s=new Xs;if(s.NodeType=S.Name,s.NodeGuid=S.Id,s.NodePostition=S.Position,S.Properties!=null&&S.Properties.length>0)for(const g of S.Properties){var n=new Bs;n.Value=g.Value,s.Properties==null&&(s.Properties=new Array),s.Properties.push(n)}t.Nodes==null&&(t.Nodes=new Array),t.Nodes.push(s)}if(e.Links!=null&&e.Links.length>0)for(const S of e.Links){var o=new Es;o.FromNodeGuid=(c=(a=S.In)==null?void 0:a.ParentNode)==null?void 0:c.Id,o.ToNodeGuid=(l=(f=S.Out)==null?void 0:f.ParentNode)==null?void 0:l.Id,o.FromTerminalIndex=(h=(u=S.In)==null?void 0:u.ParentNode)==null?void 0:h.Outputs.indexOf(S.In),o.ToTerminalIndex=(_=(p=S.Out)==null?void 0:p.ParentNode)==null?void 0:_.Inputs.indexOf(S.Out),t.Links==null&&(t.Links=new Array),t.Links.push(o)}return t}static Deserialize(e){var t=new gt;if(e.Nodes!=null&&e.Nodes.length>0)for(var s of e.Nodes){var n=j.create(s.NodeType);if(n.Id=s.NodeGuid,n.Move(s.NodePostition.X,s.NodePostition.Y),s.Properties!=null&&s.Properties.length>0)for(var o=0;o<s.Properties.length;o++)n.Properties[o].Value=s.Properties[o].Value;t.AddNode(n,!1)}if(e.Links!=null&&e.Links.length>0)for(var a of e.Links){var c=nt(t.Nodes).firstOrDefault(l=>l.Id==a.FromNodeGuid),f=nt(t.Nodes).firstOrDefault(l=>l.Id==a.ToNodeGuid);c==null||f==null||t.AddLink(c.Outputs[a.FromTerminalIndex],f.Inputs[a.ToTerminalIndex],!1)}return t}}class Gs{constructor(){r(this,"Nodes");r(this,"Links")}static ToJson(e){return JSON.stringify(e)}}class Xs{constructor(){r(this,"NodeGuid");r(this,"NodeType");r(this,"NodePostition");r(this,"Properties")}}class Bs{constructor(){r(this,"Value")}}class Es{constructor(){r(this,"FromNodeGuid");r(this,"ToNodeGuid");r(this,"FromTerminalIndex");r(this,"ToTerminalIndex")}}class Ys{constructor(e){r(this,"buffer");r(this,"capacity");r(this,"head",0);r(this,"tail",0);r(this,"size",0);r(this,"poppedItems",[]);if(e<=0)throw new Error("Capacity must be greater than 0");this.capacity=e,this.buffer=new Array(e)}get hasValues(){return this.size>0}get hasPoppedItems(){return this.poppedItems.length>0}push(e){this.poppedItems=[],this.size===this.capacity?(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.head=(this.head+1)%this.capacity):(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++)}pop(){if(!this.hasValues)return;this.tail=(this.tail-1+this.capacity)%this.capacity;const e=this.buffer[this.tail];return this.size--,this.poppedItems.push(e),e}unpop(){if(!this.hasPoppedItems)return;const e=this.poppedItems.pop();return this.size===this.capacity&&(this.head=(this.head+1)%this.capacity),this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++,e}toArray(){const e=[];for(let t=0;t<this.size;t++){const s=(this.head+t)%this.capacity;e.push(this.buffer[s])}return e}peek(){if(this.hasValues)return this.buffer[(this.tail-1+this.capacity)%this.capacity]}get length(){return this.size}}class ge{static get HasValues(){return this.ActionHistoryBuffer.hasValues}static get HasPopped(){return this.ActionHistoryBuffer.hasPoppedItems}static PushState(e){this.ActionHistoryBuffer.push(Be.Serialize(e))}static UnpopState(){if(this.ActionHistoryBuffer.hasPoppedItems){var e=this.ActionHistoryBuffer.unpop();return Be.Deserialize(e)}return null}static PopState(){if(this.ActionHistoryBuffer.hasValues){var e=this.ActionHistoryBuffer.pop();return Be.Deserialize(e)}return null}}r(ge,"ActionHistoryBuffer",new Ys(25));class gt{constructor(){r(this,"IsSubGraph",!1);r(this,"Nodes",new Array);r(this,"Links",new Array)}get HasSelected(){return this.Nodes.some(e=>e.IsSelected)||this.Links.some(e=>e.IsSelected)}AddNode(e,t=!0){var s=this.Nodes.indexOf(e);s==-1&&(e.ParentGraph=this,this.Nodes.push(e),t&&ge.PushState(this))}DeleteLink(e,t=!0){var s=this.Links.indexOf(e);s!=-1&&(e.DeleteLinkFromTerminals(),this.Links.splice(s,1),t&&ge.PushState(this))}AddLink(e,t,s=!0){if(!(e.IsInput&&t.IsInput||!e.IsInput&&!t.IsInput)){var n=new Ut;e.IsInput?(n.In=t,n.Out=e):(n.In=e,n.Out=t),t.Links.push(n),e.Links.push(n),this.Links.push(n),s&&ge.PushState(this)}}DeleteNode(e,t=!0){if(e!=null){var s=fe();s.SelectedNode==e&&(s.SelectedNode=null),s.LockedNode==e&&(s.LockedNode=null),e.Inputs.forEach(o=>{var a=o.Links.map(c=>c);a.forEach(c=>{this.DeleteLink(c)})}),e.Outputs.forEach(o=>{var a=o.Links.map(c=>c);a.forEach(c=>{this.DeleteLink(c)})});var n=this.Nodes.indexOf(e);n!=-1&&this.Nodes.splice(n,1),t&&ge.PushState(this)}}DeleteSelected(e=!0){this.Nodes.filter(s=>s.IsSelected).forEach(s=>this.DeleteNode(s,!1));var t=fe();t.SelectedNode=void 0,this.Links.filter(s=>s.IsSelected).forEach(s=>this.DeleteLink(s,!1)),e&&ge.PushState(this)}DeselectAll(){var e=fe();e.SelectedNode=void 0,this.Nodes.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1)),this.Links.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1))}SelectAll(){this.Nodes.forEach(e=>e.SetSelected(!0))}}const lt=_t("drag",()=>{const i=$(!1),e=$(),t=$(),s=$();function n(a){s.value=a}function o(){return s.value}return{setNode:n,getNode:o,SourceTerminal:e,DestinationTerminal:t,IsDragging:i}}),fe=_t("nodes",()=>{const i=$(),e=$(),t=$();return{SelectedNode:i,LockedNode:e,CurrentGraph:t}}),me=_t("renderer",()=>{const i=$(!1),e=$(),t=o=>{e.value=o},s=()=>e.value,n=$();return{ChangeEvent:i,Resolution:n,SetRenderer:t,GetRenderer:s}}),Hs=z({__name:"HeapMonitor",setup(i){const e=$(0),t=$(0),s=()=>{setInterval(n,1e3)};qe(()=>{s()});const n=()=>{performance&&performance.memory&&(e.value=performance.memory.usedJSHeapSize/1024/1024/1024,t.value=performance.memory.jsHeapSizeLimit/1024/1024/1024)};return(o,a)=>{const c=ne("font-awesome-icon"),f=Ne("tooltip");return m(),V("div",{onContextmenu:a[0]||(a[0]=he(()=>{},["prevent"])),class:"memory-usage"},[K((m(),V("span",null,[w(c,{icon:["fas","memory"]}),E(" "+D(e.value.toFixed(2))+" / "+D(t.value.toFixed(2))+" ",1),a[1]||(a[1]=I("span",null," GB",-1))])),[[f,"Heap memory usage",void 0,{up:!0}]])],32)}}}),Us=F(Hs,[["__scopeId","data-v-72365581"]]),Ws={class:"status-bar-grid disable-user-select"},zs={class:"working-status"},Fs=z({__name:"StatusBar",setup(i){me();const e=$(0);return re(()=>e.value),(t,s)=>{const n=ne("font-awesome-icon");return m(),V("div",Ws,[I("div",zs,[w(n,{icon:["fas","bars-progress"]}),s[0]||(s[0]=E(" Idle "))]),I("div",null,[w(Us)])])}}}),qs=F(Fs,[["__scopeId","data-v-ddd0f7cf"]]),Zs={class:"collapse"},Ks={class:"carete"},js={key:0,class:"collapse-body"},Js=z({__name:"Collapse",setup(i){var e=$(!1);const t=()=>{e.value=!e.value};return(s,n)=>{const o=ne("font-awesome-icon");return m(),V("div",Zs,[I("div",{onClick:t,class:"header"},[I("div",Ks,[ue(e)?(m(),q(o,{key:0,icon:["fas","angle-right"]})):(m(),q(o,{key:1,icon:["fas","angle-down"]}))]),pe(s.$slots,"header",{},void 0,!0)]),ue(e)?se("",!0):(m(),V("div",js,[pe(s.$slots,"default",{},void 0,!0)]))])}}}),zt=F(Js,[["__scopeId","data-v-ed8ad461"]]),tt=O(([i])=>{const e=x(i).toVar();e.assign(e.modInt(d(289)));const t=d(d(34).mul(e.x).add(1).mul(e.x).modInt(289).add(e.y)).toVar();return t.assign(d(34).mul(t).add(d(1)).mul(t).modInt(289)),t.assign(Se(t.div(d(41))).mul(d(2)).sub(1)),Gt(x(t.sub(Ye(t.add(.5))),He(t).sub(.5)))}).setLayout({name:"gradientNoiseDir",type:"vec2",inputs:[{name:"p",type:"vec2"}]}),Qs=O(([i])=>{const e=x(i).toVar(),t=x(Ye(e)).toVar(),s=x(Se(e)).toVar(),n=d(Ce(tt(t),s)).toVar(),o=d(Ce(tt(t.add(x(d(0),d(1)))),s.sub(x(d(0),d(1))))).toVar(),a=d(Ce(tt(t.add(x(d(1),d(0)))),s.sub(x(d(1),d(0))))).toVar(),c=d(Ce(tt(t.add(x(d(1),d(1)))),s.sub(x(d(1),d(1))))).toVar();return s.assign(s.mul(s).mul(s).mul(s.mul(s.mul(d(6)).sub(d(15))).add(d(10)))),B(B(n,o,s.y),B(a,c,s.y),s.x)}).setLayout({name:"gradientNoise",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ft=O(([i])=>Qs(i).add(.5)),dt=O(([i,e,t,s])=>{const n=de(e).toVar(),o=d(s).toVar(),a=x(t.x,t.y).toVar(),c=x(i.x,i.y).sub(d(.5)).mul(o).toVar();c.addAssign(a);const f=d(0).toVar(),l=d(1).div(2).toVar();return Pt(n,({i:u})=>{const h=c.mul(d(2).pow(d(u))).toVar(),p=Ft(h).mul(l).toVar();l.divAssign(2),f.addAssign(p)}),f}).setLayout({name:"perlinNoise",type:"float",inputs:[{name:"UV",type:"vec2"},{name:"octaves",type:"int"},{name:"offset",type:"vec2"},{name:"scale",type:"float"}]}),en=At(`
fn cracks(uv: vec2<f32>, angle: f32, scale: f32, thickness: f32) -> f32  {
	let st: vec2<f32> = (uv - 0.5) * scale;
	let i_st: vec2<f32> = floor(st);
	let f_st: vec2<f32> = fract(st);
	var m1: f32 = 1.;
	var m2: f32 = 1.;

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let neighbor: vec2<f32> = vec2<f32>(x, y);
			var point: vec2<f32> = random2(i_st + neighbor);
			point = 0.5 + 0.5 * sin(angle + 6.2831 * point);
			let diff: vec2<f32> = neighbor + point - f_st;
			let dist: f32 = length(diff);
			let cond: f32 = step(dist, m1);
			m2 = mix(min(max(m1, dist), m2), m1, cond);
			m1 = mix(m1, dist, cond);
		}

	}

	let edge: f32 = smoothstep(0.01, thickness, m2 - m1);
	return edge;
} 

fn random2(p: vec2<f32>) -> vec2<f32> {
	return fract(sin(vec2<f32>(dot(p, vec2<f32>(127.1, 311.7)), dot(p, vec2<f32>(269.5, 183.3)))) * 43758.547);
} 
`),ft=At(`
fn voronoi(UV: vec2<f32>, angleOffset: f32, cellDensity: f32) -> vec2<f32> {
	let g: vec2<f32> = floor((UV - 0.5) * cellDensity);
	let f: vec2<f32> = fract((UV - 0.5) * cellDensity);
	var res: vec3<f32> = vec3<f32>(8., 0., 0.);

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let lattice: vec2<f32> = vec2<f32>(x, y);
			let offset: vec2<f32> = voronoiNoiseRandomVector(lattice + g, angleOffset);
			let d: f32 = distance(lattice + offset, f);
			res = mix(res, vec3<f32>(d, offset.x, offset.y), step(d, res.x));
		}

	}

	return vec2<f32>(res.x, res.y);
} 

fn voronoiNoiseRandomVector(UV: vec2<f32>, offset: f32) -> vec2<f32> {
	var UV_var = UV;
	let m: mat2x2<f32> = mat2x2<f32>(15.27, 47.63, 99.41, 89.98);
	UV_var = fract(sin(UV_var * m) * 46839.32);
	return vec2<f32>(sin(UV_var.y * offset) * 0.5 + 0.5, cos(UV_var.x * offset) * 0.5 + 0.5);
}
`);class tn extends Q{constructor(){super(...arguments);r(this,"Name","nodes.perlinNoise");r(this,"Outputs",[new X(!1,this,"Output")]);r(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Octaves Count",10,1,50,1,"Noise",""),new P("Offset X",0,-100,100,0,"Transform",""),new P("Offset Y",0,-100,100,0,"Transform",""),new P("Warp Scale",0,0,1,.001,"Warp","%"),new P("Seed",0,0,99999,0,"Random",""),new P("Height",.4,0,1,0,"Noise","")]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0);r(this,"Random",O(([t])=>{const s=x(t).toVar();return Se(ve(Ce(s,x(12.9898,78.233))).mul(43758.5453))}))}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value);b(this.Properties[4].Value);const a=b(this.Properties[5].Value),c=b(this.Properties[6].Value);this.Outputs[0].Value=O(([f])=>{const l=x(f.x,f.y).toVar();return l.addAssign(this.Random(x(a).mul(a))),dt(l,s,x(n,o),t).mul(c)})}}const sn=z({__name:"DraggableNode",props:{GraphNode:{type:Function,required:!0}},setup(i){const e=lt(),t=i,s=$(),n=l=>{var h;if((h=l.dataTransfer)==null||h.setData("string","1"),t.GraphNode!=null&&t.GraphNode!=null){var u=t.GraphNode;e.setNode(new u)}};var o=void 0;const a=l=>{var p;o=(p=s.value)==null?void 0:p.cloneNode(!0);var u=o.getBoundingClientRect();if(o.style.position="fixed",o.style.left=`${l.touches[0].pageX-u.width/2}px`,o.style.top=`${l.touches[0].pageY-u.height/2}px`,o.style.zIndex="1000",document.body.appendChild(o),t.GraphNode!=null&&t.GraphNode!=null){var h=t.GraphNode;e.setNode(new h)}},c=l=>{if(o!=null){var u=o.getBoundingClientRect();o.style.left=`${l.touches[0].pageX-u.width/2}px`,o.style.top=`${l.touches[0].pageY-u.height/2}px`}},f=l=>{if(o!=null){document.body.removeChild(o),o=void 0,l.preventDefault(),l.stopPropagation();var u=l.changedTouches[0],h=document.elementFromPoint(u.clientX,u.clientY);console.log(h)}};return window.addEventListener("touchmove",c),window.addEventListener("touchend",f),(l,u)=>(m(),V("div",{onTouchstart:a,onDragstart:n,draggable:"true",class:"node",ref_key:"selfEl",ref:s},[pe(l.$slots,"default",{},void 0,!0)],544))}}),nn=F(sn,[["__scopeId","data-v-ee47cd3c"]]),on={class:"node-list"},an=z({__name:"NodeList",setup(i){var e=j.getGroups();return(t,s)=>{const n=ne("font-awesome-icon");return m(),V("div",on,[(m(!0),V(J,null,Ve(ue(e),([o,a])=>(m(),V(J,null,[o!=""?(m(),q(zt,{key:0},{header:k(()=>[E(D(t.$t(o)),1)]),default:k(()=>[(m(!0),V(J,null,Ve(a,([c,f])=>(m(),q(nn,{"-graph-node":f},{default:k(()=>[w(n,{icon:["fas","circle-nodes"]}),E(" "+D(t.$t(c)),1)]),_:2},1032,["-graph-node"]))),256))]),_:2},1024)):se("",!0)],64))),256))])}}}),rn=F(an,[["__scopeId","data-v-ff1a0b3e"]]),ln={class:"padding"},un={class:"header disable-user-select"},dn={class:"body disable-user-select"},cn=z({__name:"FrameTab",props:{wheelFocus:{type:Boolean,default:!0}},setup(i){const e=i,t=$(),s=n=>{t.value&&e.wheelFocus&&t.value.focus()};return(n,o)=>(m(),V("div",ln,[I("div",{class:"main",tabindex:"0",ref_key:"selfEl",ref:t,onWheel:s},[I("div",un,[pe(n.$slots,"header",{},void 0,!0)]),I("div",dn,[pe(n.$slots,"default",{},void 0,!0)])],544)]))}}),ut=F(cn,[["__scopeId","data-v-1982f366"]]);class ke extends Q{constructor(){super(...arguments);r(this,"Name","nodes.buffer");r(this,"Inputs",[new X(!0,this,"")]);r(this,"Outputs",[new X(!1,this,"")])}Calculate(){this.BaseCalculate();var t=this.Inputs[0].Links[0].In,s=this.Outputs[0];s.Value=t==null?void 0:t.Value}}class wt{constructor(e,t,s,n){r(this,"X",0);r(this,"Y",0);r(this,"Height",0);r(this,"Width",0);this.X=e,this.Y=t,this.Height=s,this.Width=n}ContainsRect(e){return this.X<=e.X&&e.X+e.Width<=this.X+this.Width&&this.Y<=e.Y&&e.Y+e.Height<=this.Y+this.Height}ContainsPoint(e,t){return this.X<=e&&e<this.X+this.Width&&this.Y<=t&&t<this.Y+this.Height}IntersectsWith(e){return e.X<this.X+this.Width&&this.X<e.X+e.Width&&e.Y<this.Y+this.Height&&this.Y<e.Y+e.Height}static Intersects(e,t){return e.X<t.X+t.Width&&t.X<e.X+e.Width&&e.Y<t.Y+t.Height&&t.Y<e.Y+e.Height}}const hn=z({__name:"ContextMenu",props:{CloseOnAnyClick:{type:Boolean,default:!0},CloseOnMouseOut:{type:Boolean,default:!0}},emits:["lost-focus"],setup(i,{expose:e,emit:t}){const s=$(!1),n=$(),o=t,a=i,c=g=>{s.value=!0,ye(()=>{n.value!=null&&n.value!=null&&(n.value.style.left=g.pageX+"px",n.value.style.top=g.pageY+"px",l(),window.addEventListener("mousedown",S))})},f=g=>{ye(()=>{n.value!=null&&(n.value.style.width=g+"px")})},l=()=>{if(n.value!=null&&n.value!=null){const v=n.value.getBoundingClientRect();if(v.y+v.height>window.innerHeight){var g=v.y+v.height-window.innerHeight;n.value.style.top=v.y-g+"px"}if(v.y<0&&(n.value.style.top="0px"),v.x+v.width>window.innerWidth){var g=v.x+v.width-window.innerWidth;n.value.style.left=v.x-g+"px"}v.x<0&&(n.value.style.left="0px")}},u=g=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var v=g.getBoundingClientRect();n.value.style.left=v.x+"px",n.value.style.top=v.y+v.height+"px",l(),window.addEventListener("mousedown",S)}})},h=g=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var v=g.getBoundingClientRect(),C=n.value.getBoundingClientRect();n.value.style.left=v.x-C.width+"px",n.value.style.top=v.y+"px",l(),window.addEventListener("mousedown",S)}})},p=g=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var v=g.getBoundingClientRect();n.value.style.left=v.x+v.width+"px",n.value.style.top=v.y+"px",l(),window.addEventListener("mousedown",S)}})},_=()=>{window.removeEventListener("mousedown",S),s.value=!1},S=g=>{if(a.CloseOnMouseOut&&n.value!=null){var v=n.value.getBoundingClientRect(),C=new wt(v.x,v.y,v.height,v.width);C.ContainsPoint(g.clientX,g.clientY)||(s.value=!1,window.removeEventListener("mousedown",S),o("lost-focus"))}};return e({Open:c,Close:_,OpenUnder:u,OpenLeft:h,OpenRight:p,SetWidth:f,isOpened:s}),(g,v)=>(m(),q(Qt,{name:"open"},{default:k(()=>[(m(),q(Jt,{to:"body"},[s.value?(m(),V("div",{key:0,onContextmenu:v[0]||(v[0]=he(()=>{},["prevent"])),onMousedown:v[1]||(v[1]=he(()=>{},["stop"])),ref_key:"ContextMenu",ref:n,class:"context-menu disable-user-select"},[pe(g.$slots,"default",{},void 0,!0)],544)):se("",!0)]))]),_:3}))}}),Ze=F(hn,[["__scopeId","data-v-bc41e1a3"]]);class $t{static pathExists(e,t){if(e===t)return!0;const s=new Set;return this.dfs(e,t,s)}static dfs(e,t,s){if(e===t)return!0;if(s.has(e))return!1;s.add(e);for(const n of e.Outputs)for(const o of n.Links)if(o.Out!=null&&o.Out!=null){const a=o.Out.ParentNode;if(this.dfs(a,t,s))return!0}return!1}}const fn=z({__name:"TerminalRenderer",props:{Term:{type:X,required:!0}},setup(i,{expose:e}){const t=lt(),s=i,n=u=>{t.SourceTerminal=s.Term,t.IsDragging=!0,window.addEventListener("mouseup",o)},o=u=>{var S,g,v;window.removeEventListener("mouseup",o),t.IsDragging=!1;var h=t.DestinationTerminal,p=t.SourceTerminal;if(h!=null&&h!=p&&!(p!=null&&p.IsInput&&h.IsInput)&&(p==null?void 0:p.ParentNode)!=h.ParentNode){if(p!=null&&p.IsInput){if($t.pathExists(p==null?void 0:p.ParentNode,h.ParentNode))return;p.Links.forEach(C=>{var N,T;(T=(N=p==null?void 0:p.ParentNode)==null?void 0:N.ParentGraph)==null||T.DeleteLink(C)})}if(h.IsInput){if($t.pathExists(h==null?void 0:h.ParentNode,p==null?void 0:p.ParentNode))return;h.Links.forEach(C=>{var N,T;(T=(N=h==null?void 0:h.ParentNode)==null?void 0:N.ParentGraph)==null||T.DeleteLink(C)})}(g=(S=s.Term.ParentNode)==null?void 0:S.ParentGraph)==null||g.AddLink(h,p);var _=me();(v=s.Term.ParentNode)!=null&&v.IsRealtimeUpdate&&(_.ChangeEvent=!_.ChangeEvent)}},a=u=>{t.IsDragging&&(t.DestinationTerminal=s.Term)},c=u=>{t.IsDragging&&(t.DestinationTerminal=null)},f=$();qe(()=>{ye(()=>{l()})});const l=()=>{var p,_,S,g;var u=((p=f.value)==null?void 0:p.offsetLeft)+((_=f.value)==null?void 0:_.offsetWidth)/2+2,h=((S=f.value)==null?void 0:S.offsetTop)+((g=f.value)==null?void 0:g.offsetHeight)/2+2;s.Term.SetOffset(u,h)};return e({SetOffset:l}),(u,h)=>{const p=Ne("tooltip");return K((m(),V("div",{class:Me(["node-terminal",{connected:s.Term.IsConnected},"disable-user-select"]),onMousedown:[h[0]||(h[0]=he(()=>{},["right","stop"])),he(n,["left"])],onMouseover:a,onMouseleave:c,ref_key:"selfEl",ref:f},null,34)),[[p,{content:s.Term.Name,placement:s.Term.IsInput?"left":"right"}]])}}}),Rt=F(fn,[["__scopeId","data-v-14e3060e"]]),pn=z({__name:"ContextMenuItem",props:{Active:{type:Boolean,default:!1}},setup(i){return(e,t)=>(m(),V("button",{class:Me([["btn",{active:i.Active}],"btn"]),style:{padding:"5px"}},[pe(e.$slots,"default",{},void 0,!0)],2))}}),ce=F(pn,[["__scopeId","data-v-3e13e567"]]),mn={},vn={class:"loader"};function gn(i,e){return m(),V("span",vn)}const qt=F(mn,[["render",gn],["__scopeId","data-v-8c5c5c6f"]]),wn={class:"node-container"},Vn={class:"node-terminals left"},yn={class:"node-center"},Sn={class:"node-name"},_n={class:"node-terminals right"},xn=z({__name:"NodeRenderer",props:{Offset:{type:L,required:!0},Zoom:{type:Number,required:!0},Node:{type:Q,required:!0},AllNodes:{type:Array,default:new Array}},setup(i){Tt(y=>({"0ab3956c":f.value,"2f84f68e":l.value}));var e=i;const t=$(),s=Ee("contextMenu"),n=Ee("terminals");qe(()=>{window.addEventListener("mousemove",U),window.addEventListener("mouseup",N),ye(()=>{var y=e.Node,M=t.value;if(y.SetSize(M.offsetHeight,M.offsetWidth),y.Move(y.Position.X-y.Width/2,y.Position.Y-y.Height/2),t!=null){var A=new ResizeObserver(_);A.observe(t.value)}})});const o=$(new L(0,0)),a=$(!1),c=re(()=>{var y=fe();return y.LockedNode==e.Node});re(()=>{var y=e.Node.Position.Y;return y+"px"}),re(()=>{var y=e.Node.Position.X;return y+"px"});const f=re(()=>a.value?"grabbing":"default"),l=re(()=>e.Node.IsSelected?"1":"0"),u=re(()=>{var y=fe(),M=y.LockedNode;return M!=null&&M==e.Node}),h=y=>{var M;(M=s.value)==null||M.Open(y)},p=()=>{var y;(y=s.value)==null||y.Close()},_=()=>{var y;n.value!=null&&((y=n.value)==null||y.forEach(M=>{M==null||M.SetOffset()}))},S=()=>{var y=fe(),M=me();y.LockedNode==e.Node?y.LockedNode=null:(y.LockedNode=e.Node,e.Node.SetSelected(!0),M.ChangeEvent=!M.ChangeEvent)},g=(y,M,A)=>{var R,Y,H,le,oe;if(a.value=!0,o.value.X=y,o.value.Y=M,A)e.Node.SetSelected(!((R=e.Node)!=null&&R.IsSelected));else{var G=(Y=e.Node.ParentGraph)==null?void 0:Y.Nodes.filter(ae=>ae.IsSelected);G.length>1?e.Node.IsSelected==!1&&((H=e.Node.ParentGraph)==null||H.DeselectAll(),e.Node.SetSelected(!0)):((le=e.Node.ParentGraph)==null||le.DeselectAll(),e.Node.SetSelected(!0))}(oe=e.Node.ParentGraph)==null||oe.Nodes.filter(ae=>ae.IsSelected).forEach(ae=>{ae.SetLastPosition(ae.Position.X,ae.Position.Y)}),ge.PushState(e.Node.ParentGraph)},v=y=>{if(n.value!=null&&n.value.some(G=>G.$el==y.target||G==y.target))return;let M=y.touches[0].clientX,A=y.touches[0].clientY;g(M,A,!1)},C=y=>{n.value!=null&&n.value.some(M=>M.$el==y.target||M==y.target)||g(y.clientX,y.clientY,y.shiftKey)},N=y=>{a.value=!1},T=y=>{a.value=!1},Z=y=>{let M=y.touches[0].clientX,A=y.touches[0].clientY;te(M,A)},te=(y,M)=>{var R;if(a.value){var A=(y-o.value.X)/e.Zoom,G=(M-o.value.Y)/e.Zoom;(R=e.Node.ParentGraph)==null||R.Nodes.filter(Y=>Y.IsSelected).forEach(Y=>{Y.Move(Y.LastPosition.X+A,Y.LastPosition.Y+G)})}},U=y=>{te(y.clientX,y.clientY)};return(y,M)=>{const A=ne("font-awesome-icon"),G=Ne("tooltip");return m(),V("div",{class:Me([{node:!(i.Node instanceof ue(ke))},{"node-buffer":i.Node instanceof ue(ke)},"disable-user-select",{"not-calculated":i.Node.CalculationState==ue(Oe).NotCalculated&&!(i.Node instanceof ue(ke))},{selected:i.Node.IsSelected},{lockedPreview:c.value},{"node-without-inputs":i.Node.Inputs.length==0}]),style:es({top:ue(e).Node.Position.Y+"px",left:ue(e).Node.Position.X+"px"}),ref_key:"rootEl",ref:t,onMousedown:[he(C,["left"]),he(h,["right"])],onTouchmove:Z,onTouchstart:v,onTouchend:T},[I("div",wn,[I("div",Vn,[(m(!0),V(J,null,Ve(i.Node.Inputs,R=>(m(),q(Rt,{ref_for:!0,ref_key:"terminals",ref:n,key:R.Guid,Term:R},null,8,["Term"]))),128))]),I("div",yn,[i.Node instanceof ue(ke)?se("",!0):(m(),V(J,{key:0},[K((m(),V("a",{class:"lock-icon",onClick:M[0]||(M[0]=R=>S())},[u.value?(m(),q(A,{key:0,icon:["fas","lock"]})):(m(),q(A,{key:1,icon:["fas","lock-open"]}))])),[[G,{content:y.$t("tt.lockPreview"),placement:"bottom"}]]),I("div",Sn,D(y.$t(i.Node.Name)),1),i.Node.CalculationState==ue(Oe).Calculation?(m(),q(qt,{key:0})):se("",!0)],64))]),I("div",_n,[(m(!0),V(J,null,Ve(i.Node.Outputs,R=>(m(),q(Rt,{ref_for:!0,ref_key:"terminals",ref:n,key:R.Guid,Term:R},null,8,["Term"]))),128))])]),w(Ze,{ref_key:"contextMenu",ref:s,CloseOnAnyClick:!0},{default:k(()=>[w(ce,null,{default:k(()=>[w(A,{icon:["far","copy"]}),E(" "+D(y.$t("tt.copy")),1)]),_:1}),w(ce,{onClick:M[1]||(M[1]=R=>{var Y,H;(Y=i.Node.ParentGraph)==null||Y.DeleteNode(i.Node),(H=i.Node.ParentGraph)==null||H.DeleteSelected(),p()}),style:{color:"var(--vt-c-red)"}},{default:k(()=>[w(A,{icon:["far","trash-can"]}),E(" "+D(y.$t("tt.delete")),1)]),_:1}),M[3]||(M[3]=I("hr",null,null,-1)),w(ce,{onClick:M[2]||(M[2]=R=>{S(),p()})},{default:k(()=>[u.value?(m(),q(A,{key:0,icon:["fas","lock"]})):(m(),q(A,{key:1,icon:["fas","lock-open"]})),u.value?(m(),V(J,{key:2},[E("  "+D(y.$t("tt.unlockPreview")),1)],64)):(m(),V(J,{key:3},[E("  "+D(y.$t("tt.lockPreview")),1)],64))]),_:1})]),_:1,__:[3]},512)],38)}}}),bn=F(xn,[["__scopeId","data-v-2f5df3e5"]]),Pn={},Cn={class:"canvas",xmlns:"http://www.w3.org/2000/svg"};function In(i,e){return m(),V("svg",Cn,[pe(i.$slots,"default",{},void 0,!0)])}const Nn=F(Pn,[["render",In],["__scopeId","data-v-81940268"]]),Mn=["points"],kn=z({__name:"LinkRenderer",props:{Link:{type:Ut,required:!0}},setup(i){const e=i,t=()=>{e.Link.SetSelected(!0)},s=o=>{var u;var a=e.Link.In,c=e.Link.Out;if(!(a==null||c==null)){var f=new ke;f.Move(o.offsetX,o.offsetY);var l=(u=a.ParentNode)==null?void 0:u.ParentGraph;l!=null&&(l.DeleteLink(e.Link),l.AddNode(f),l.AddLink(a,f.Inputs[0]),l.AddLink(f.Outputs[0],c))}},n=re(()=>{var c,f,l,u,h,p;var o=L.Add((f=(c=e.Link.In)==null?void 0:c.ParentNode)==null?void 0:f.Position,(l=e.Link.In)==null?void 0:l.OffsetPosition),a=L.Add((h=(u=e.Link.Out)==null?void 0:u.ParentNode)==null?void 0:h.Position,(p=e.Link.Out)==null?void 0:p.OffsetPosition);return`${o.X},${o.Y} ${o.X+20},${o.Y} ${a.X-20},${a.Y} ${a.X},${a.Y}`});return(o,a)=>(m(),V("polyline",{onClick:t,onDblclick:s,points:n.value,class:Me(["line",{selected:e.Link.IsSelected}])},null,42,Mn))}}),On=F(kn,[["__scopeId","data-v-ca4f4d6b"]]),Ln={},$n={class:"tool-bar-container"};function Rn(i,e){return m(),V("div",$n,[pe(i.$slots,"default",{},void 0,!0)])}const Vt=F(Ln,[["render",Rn],["__scopeId","data-v-b20ca96b"]]),Dn={},Tn={class:"tool-bar-body"};function An(i,e){return m(),V("div",Tn,[pe(i.$slots,"default")])}const xe=F(Dn,[["render",An]]),Gn={key:0,class:"selection-box"},Xn={class:"offset-container",ref:"offset_container"},Bn=["points"],En={key:1,style:{"pointer-events":"none",height:"100%",width:"100%",padding:"30px",position:"absolute"}},Yn={style:{display:"flex","justify-content":"center","align-items":"center",height:"100%",width:"100%","border-radius":"50px",border:"4px dashed var(--vt-c-black-mute)",color:"var(--vt-c-black-mute)"}},Hn={style:{"font-size":"50px","font-weight":"bold","text-shadow":"0px 0px 20px black"}},Un=z({props:{MinScale:{type:Number,default:.5},MaxScale:{type:Number,default:2}},data(){return{Offset:new L(0,0),SelectionBox:new wt(0,0,0,0),SelectionBoxVisibility:!1,LastMouse:new L(0,0),LastOffset:new L(0,0),Zoom:1,isDragging:!1,_Graph:new gt,dragStore:lt(),points:"",GridSize:20,isDragOver:!1}},computed:{Nodes:function(){return this._Graph.Nodes},OffsetXStyle:function(){return this.Offset.X+"px"},OffsetYStyle:function(){return this.Offset.Y+"px"},EditorCursor:function(){return this.isDragging?"grabbing":"default"},SelectionBoxX:function(){return this.SelectionBox.X+"px"},SelectionBoxY:function(){return this.SelectionBox.Y+"px"},SelectionBoxHeight:function(){return this.SelectionBox.Height+"px"},SelectionBoxWidth:function(){return this.SelectionBox.Width+"px"},OffsetStyle:function(){var i=this.GridSize/2*this.Zoom;return this.Offset.X-i+"px "+(this.Offset.Y-i)+"px"},ScaleGridStyle:function(){var i=(this.GridSize*this.Zoom).toString();return`${i}px ${i}px`}},created(){window.addEventListener("mousemove",this.OnMouseMove),window.addEventListener("mouseup",this.OnMouseUp)},mounted(){this.$nextTick(()=>{var t;this.$el;var i=((t=this.$parent)==null?void 0:t.$el).parentElement;i!=null&&(i.onkeydown=this.KeysHandler),this._Graph=new gt;var e=fe();e.CurrentGraph=this._Graph})},methods:{SaveGraph(){var i=Be.Serialize(this._Graph),e=JSON.stringify(i);console.log(e);var t=JSON.parse(e);console.log(t);var s=Be.Deserialize(t);console.log(s)},Undo(){var i=ge.PopState();i!=null&&(this._Graph=i)},Redo(){var i=ge.UnpopState();i!=null&&(this._Graph=i)},isChild(i,e){for(var t=e.parentNode;t!=null;){if(t==i)return!0;t=t.parentNode}return!1},dragenter(){this.isDragOver=!0},dragleave(i){var e=this.$el,t=i.target;this.isChild(e,t)||(this.isDragOver=!1)},drop(i){this.isDragOver=!1;var e=lt(),t=e.getNode();if(t!=null){var s=this.$refs.editor,n=s.getBoundingClientRect();if(n!=null){ge.PushState(this._Graph);var o=L.Div(new L(i.clientX-n.x-this.Offset.X,i.clientY-n.y-this.Offset.Y),this.Zoom);t==null||t.Move(o.X,o.Y),this._Graph.AddNode(t)}}},KeysHandler(i){i.key=="Delete"&&(ge.PushState(this._Graph),this._Graph.DeleteSelected())},UpdateOffsetStyle(){var i=this.$refs.offset_container;i.style.left=this.OffsetXStyle,i.style.top=this.OffsetYStyle,i.style.scale=this.Zoom.toString()},OnMouseDownLeft:function(i){this.DrawGhostLine(i),i.target==this.$refs.editor&&(this.LastMouse=new L(i.clientX,i.clientY),this.SelectionBox.X=0,this.SelectionBox.Y=0,this.SelectionBox.Width=0,this.SelectionBox.Height=0,this.SelectionBoxVisibility=!0,this._Graph.DeselectAll())},OnMouseDownMiddle:function(i){this.isDragging=!0,this.LastMouse=new L(i.clientX,i.clientY),this.LastOffset={...this.Offset}},OnMouseMove:function(i){if(this.isDragging){i.preventDefault();var e=i.clientX-this.LastMouse.X,t=i.clientY-this.LastMouse.Y;this.Offset.X=this.LastOffset.X+e,this.Offset.Y=this.LastOffset.Y+t,this.UpdateOffsetStyle()}if(this.SelectionBoxVisibility){i.preventDefault();var s=new L(i.clientX,i.clientY),n=new L(Math.min(this.LastMouse.X,s.X),Math.min(this.LastMouse.Y,s.Y)),o=new L(Math.abs(this.LastMouse.X-s.X),Math.abs(this.LastMouse.Y-s.Y)),a=this.$refs.editor,c=a.getBoundingClientRect();this.SelectionBox.X=n.X-c.left,this.SelectionBox.Y=n.Y-c.top,this.SelectionBox.Width=o.X,this.SelectionBox.Height=o.Y,this._Graph.Nodes.forEach(f=>{var l=new wt(this.Offset.X+f.Position.X*this.Zoom,this.Offset.Y+f.Position.Y*this.Zoom,f.Height*this.Zoom,f.Width*this.Zoom);this.SelectionBox.IntersectsWith(l)?f.SetSelected(!0):f.SetSelected(!1)})}this.DrawGhostLine(i)},OnMouseUp:function(i){this.isDragging=!1,this.SelectionBoxVisibility=!1},OnWheel:function(i){let t=this.$refs.editor.getBoundingClientRect(),s=i.deltaY*.001,n=this.Zoom;this.Zoom=this.Clamp(this.Zoom-s,this.MinScale,this.MaxScale);let o=new L(i.clientX-t.left,i.clientY-t.top),a=(n-this.Zoom)/n;this.Offset=L.Add(this.Offset,L.Mul(L.Sub(o,this.Offset),a)),this.UpdateOffsetStyle()},DisableContextMenu(i){i.preventDefault()},Clamp:function(i,e,t){return Math.min(Math.max(i,e),t)},DrawGhostLine(i){var f;if(this.dragStore.IsDragging){var e=this.$refs.editor,t=e.getBoundingClientRect();if(i.preventDefault(),t!=null){var s=this.dragStore.SourceTerminal,n=L.Add((f=s.ParentNode)==null?void 0:f.Position,s.OffsetPosition),o=L.Div(new L(i.clientX-t.x-this.Offset.X,i.clientY-t.y-this.Offset.Y),this.Zoom),a=s.IsInput?o:n,c=s.IsInput?n:o;this.points=`${a.X},${a.Y} ${a.X+20},${a.Y} ${c.X-20},${c.Y} ${c.X},${c.Y}`}}}}}),Wn=z({...Un,__name:"GraphRenderer",setup(i){return Tt(e=>({db6f8752:e.EditorCursor,"37abfe34":e.SelectionBoxY,"37abfe36":e.SelectionBoxX,d162664c:e.SelectionBoxHeight,"682fa09a":e.SelectionBoxWidth,"98be67d6":e.ScaleGridStyle,b4c3d5ac:e.OffsetStyle})),(e,t)=>{const s=ne("font-awesome-icon"),n=Ne("tooltip");return m(),V("div",{class:"graph-renderer dot",ref:"editor",onWheel:t[4]||(t[4]=(...o)=>e.OnWheel&&e.OnWheel(...o)),onMousedown:[t[5]||(t[5]=he((...o)=>e.OnMouseDownLeft&&e.OnMouseDownLeft(...o),["left"])),t[6]||(t[6]=he((...o)=>e.OnMouseDownMiddle&&e.OnMouseDownMiddle(...o),["middle"]))],onContextmenu:he(()=>!1,["prevent","right"]),onDragover:t[7]||(t[7]=he(()=>{},["prevent"])),onDragenter:t[8]||(t[8]=(...o)=>e.dragenter&&e.dragenter(...o)),onDragleave:t[9]||(t[9]=(...o)=>e.dragleave&&e.dragleave(...o)),onDrop:t[10]||(t[10]=(...o)=>e.drop&&e.drop(...o))},[w(Vt,{class:"top-left"},{default:k(()=>[w(xe,null,{default:k(()=>[K((m(),V("a",{onClick:t[0]||(t[0]=o=>e.Undo())},[w(s,{icon:["fas","rotate-left"]})])),[[n,e.$t("tt.undo"),void 0,{bottom:!0}]]),K((m(),V("a",{onClick:t[1]||(t[1]=o=>e.Redo())},[w(s,{icon:["fas","rotate-right"]})])),[[n,e.$t("tt.redo"),void 0,{bottom:!0}]])]),_:1}),w(xe,null,{default:k(()=>[K((m(),V("a",null,[w(s,{icon:["far","copy"]})])),[[n,e.$t("tt.copy"),void 0,{bottom:!0}]]),K((m(),V("a",null,[w(s,{icon:["far","paste"]})])),[[n,e.$t("tt.paste"),void 0,{bottom:!0}]]),K((m(),V("a",{class:Me([{disabled:!e._Graph.HasSelected}]),style:{color:"var(--vt-c-red)"},onClick:t[2]||(t[2]=o=>e._Graph.DeleteSelected())},[w(s,{icon:["far","trash-can"]})],2)),[[n,e.$t("tt.delete"),void 0,{bottom:!0}]])]),_:1}),w(xe,null,{default:k(()=>[K((m(),V("a",null,[w(s,{icon:["fas","expand"]})])),[[n,e.$t("tt.fullscreen"),void 0,{bottom:!0}]])]),_:1})]),_:1}),w(Vt,{class:"bottom-left"},{default:k(()=>[w(xe,null,{default:k(()=>[I("span",null,[e.Zoom<1?(m(),q(s,{key:0,icon:["fas","magnifying-glass-minus"]})):(m(),q(s,{key:1,icon:["fas","magnifying-glass-plus"]})),E(" "+D((e.Zoom*100).toFixed(0))+"%",1)])]),_:1}),w(xe,null,{default:k(()=>[I("span",null,[w(s,{icon:["fas","up-down-left-right"]}),E(" X: "+D(e.Offset.X.toFixed())+" Y: "+D(e.Offset.Y.toFixed()),1)])]),_:1}),w(xe,null,{default:k(()=>[K((m(),V("a",{onClick:t[3]||(t[3]=o=>{e.Offset.Reset(),e.Zoom=1,e.UpdateOffsetStyle()})},[w(s,{icon:["fas","arrows-rotate"]})])),[[n,e.$t("tt.resetView")]])]),_:1}),w(xe,null,{default:k(()=>[I("span",null,[w(s,{icon:["fas","circle-info"]}),E(" "+D(e.$t("hints.graphLmb")),1)])]),_:1}),w(xe,null,{default:k(()=>[I("span",null,[w(s,{icon:["fas","circle-info"]}),E(" "+D(e.$t("hints.graphWheel")),1)])]),_:1})]),_:1}),e.SelectionBoxVisibility?(m(),V("div",Gn)):se("",!0),I("div",Xn,[w(Nn,{id:"links-container"},{default:k(()=>[w(Mt,{name:"link"},{default:k(()=>[(m(!0),V(J,null,Ve(e._Graph.Links,o=>(m(),q(On,{key:o.Id,Link:o},null,8,["Link"]))),128))]),_:1}),e.dragStore.IsDragging?(m(),V("polyline",{key:0,class:"ghost-line",points:e.points},null,8,Bn)):se("",!0)]),_:1}),w(Mt,{name:"delete",tag:"div"},{default:k(()=>[(m(!0),V(J,null,Ve(e.Nodes,o=>(m(),q(bn,{key:o.Id,Offset:e.Offset,Zoom:e.Zoom,Node:o},null,8,["Offset","Zoom","Node"]))),128))]),_:1})],512),e.isDragOver?(m(),V("div",En,[I("div",Yn,[I("span",Hn,D(e.$t("hints.placeHere")),1)])])):se("",!0)],544)}}}),zn=F(Wn,[["__scopeId","data-v-eed6edd1"]]),Fn={style:{height:"100%",display:"flex","flex-direction":"row"}},qn={style:{"margin-left":"5px"}},Zn={style:{"margin-left":"5px"}},Kn=z({__name:"EditorView",setup(i){return(e,t)=>{const s=ne("font-awesome-icon");return m(),V("div",Fn,[w(ut,{style:{width:"20%","min-width":"300px"}},{header:k(()=>[w(s,{icon:["fas","list"]}),t[0]||(t[0]=E()),I("span",qn,D(e.$t("windows.nodesList")),1)]),default:k(()=>[w(rn)]),_:1}),w(ut,{style:{width:"80%"}},{header:k(()=>[w(s,{icon:["fas","circle-nodes"]}),t[1]||(t[1]=E()),I("span",Zn,D(e.$t("windows.graph")),1)]),default:k(()=>[w(zn)]),_:1})])}}}),jn={style:{display:"flex","flex-direction":"row"}},Jn={style:{width:"100%","font-weight":"bold","text-align":"left","margin-left":"10px"}},Qn={style:{width:"100%","font-weight":"bold","text-align":"right","margin-right":"10px"}},eo={style:{width:"10px","margin-right":"10px"}},to={key:0,class:"dropdown"},so=["onClick"],no=z({__name:"SelectDropdown",props:{options:{type:Array,required:!1,default:[]},title:{type:String,required:!1,default:""},default:{type:String,required:!1,default:null},modelValue:{type:String,default:""},RealtimeChange:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(i,{emit:e}){$(!1);const t=i,s=$(t.default?t.default:t.options.length>0?t.options[0]:null),n=$(!1);Fe(()=>t.modelValue,a=>{s.value=a});const o=()=>{var a=me();t.RealtimeChange&&(a.ChangeEvent=!a.ChangeEvent)};return(a,c)=>{const f=ne("font-awesome-icon");return m(),V("div",{class:"dropdown-head input-element value",tabindex:"0",onBlur:c[1]||(c[1]=l=>n.value=!1),style:{width:"100%",position:"relative"}},[I("div",{onClick:c[0]||(c[0]=l=>n.value=!n.value),style:{height:"100%"}},[I("div",jn,[I("div",Jn,D(t.title)+D(t.title==""?"":":"),1),I("div",Qn,D(s.value),1),I("div",eo,[n.value?(m(),q(f,{key:1,icon:["fas","angle-up"]})):(m(),q(f,{key:0,icon:["fas","angle-down"]}))])])]),n.value?(m(),V("ul",to,[(m(!0),V(J,null,Ve(i.options,(l,u)=>(m(),V("li",{class:Me({selected:l==s.value}),key:u,onClick:h=>{s.value=l,n.value=!1,a.$emit("update:modelValue",s.value),o()}},D(l),11,so))),128))])):se("",!0)],32)}}}),oo=F(no,[["__scopeId","data-v-dfc57581"]]),io=z({__name:"LangSwitch",setup(i){const e=yt(),t=$("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);const s=f=>{e!=null&&(e.appContext.config.globalProperties.$i18n.locale=f,localStorage.setItem("userLang",f),t.value=f)},n=Ee("langContextMenu"),o=$(),a=f=>{var l;(o!=null||o!=null)&&((l=n.value)==null||l.OpenUnder(o.value))};var c=new Map;return c.set("en","English"),c.set("ru","Русский"),(f,l)=>{const u=ne("flag");return m(),V(J,null,[I("button",{ref_key:"langSwitchBtn",ref:o,class:"btn disable-user-select",onClick:a},[w(u,{iso:t.value=="en"?"gb":t.value},null,8,["iso"]),E(" "+D(ue(c).get(t.value)),1)],512),w(Ze,{ref:"langContextMenu"},{default:k(()=>[I("button",{class:"btn btnContextMenuPadding",onClick:l[0]||(l[0]=h=>{var p;s("ru"),(p=n.value)==null||p.Close()})},[w(u,{iso:"ru"}),l[2]||(l[2]=E(" Русский"))]),I("button",{class:"btn btnContextMenuPadding",onClick:l[1]||(l[1]=h=>{var p;s("en"),(p=n.value)==null||p.Close()})},[w(u,{iso:"gb"}),l[3]||(l[3]=E(" English"))])]),_:1},512)],64)}}}),ao=z({__name:"ToggleButton",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(i){const e=xt(i,"modelValue");return(t,s)=>(m(),V("button",{class:Me(["btn",{toggled:e.value}]),onClick:s[0]||(s[0]=n=>e.value=!e.value)},[pe(t.$slots,"default",{},void 0,!0)],2))}}),ro=F(ao,[["__scopeId","data-v-4a53f642"]]),lo=z({__name:"ResolutionSwitcher",setup(i){const e=yt(),t=$("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);var s=me();const n=Ee("contextMenu"),o=$(),a=h=>{var _,S,g;if(o!=null||o!=null){var p=(_=o.value)==null?void 0:_.getBoundingClientRect();(S=n.value)==null||S.OpenUnder(o.value),p!=null&&((g=n.value)==null||g.SetWidth(p.width))}},c=["0.5K","1K","2K","4K","8K"],f=[512,1024,2048,4096,8192],l=$(0),u=h=>{l.value=h;var p=s.GetRenderer();p!=null&&(p.ChangeResolution(f[h]),requestAnimationFrame(()=>p==null?void 0:p.Render()))};return(h,p)=>{const _=ne("font-awesome-icon"),S=Ne("tooltip");return m(),V(J,null,[K((m(),V("button",{ref_key:"switcher",ref:o,class:"btn disable-user-select",onClick:a},[w(_,{icon:["fas","vector-square"]}),E(" "+D(c[l.value])+" ",1),w(_,{icon:["fas","angle-down"]})])),[[S,h.$t("tt.mesh_resolution"),void 0,{bottom:!0}]]),w(Ze,{ref_key:"contextMenu",ref:n},{default:k(()=>[(m(),V(J,null,Ve(c,(g,v)=>(m(),V(J,null,[v>2?K((m(),q(ce,{key:0,class:"waringText",Active:v==l.value,onClick:C=>{var N;u(v),(N=n.value)==null||N.Close()}},{default:k(()=>[w(_,{icon:["fas","vector-square"]}),E(" "+D(g),1)]),_:2},1032,["Active","onClick"])),[[S,{content:h.$t("tt.resolutionWarning"),html:!0,distance:15},void 0,{right:!0}]]):(m(),q(ce,{key:1,Active:v==l.value,onClick:C=>{var N;u(v),(N=n.value)==null||N.Close()}},{default:k(()=>[w(_,{icon:["fas","vector-square"]}),E(" "+D(g),1)]),_:2},1032,["Active","onClick"]))],64))),64))]),_:1},512)],64)}}}),Dt=F(lo,[["__scopeId","data-v-97dd3ce3"]]),uo={style:{height:"100%",width:"100%",position:"relative"}},co=["value"],ho=z({__name:"ProjectNameEditor",props:ot({modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:ot(["update:modelValue"],["update:modelValue"]),setup(i,{emit:e}){const t=xt(i,"modelValue"),s=e,n=$(!1),o=$(),a=$(),c=()=>{n.value=!0,ye(()=>{var h;a.value=t.value,(h=o.value)==null||h.focus()})},f=h=>{s("update:modelValue",a.value),n.value=!1},l=h=>{h.target!=null&&(a.value=h.target.value,s("update:modelValue",a.value))},u=h=>{h.key=="Enter"&&(h.target!=null&&(a.value=h.target.value,s("update:modelValue",a.value)),n.value=!1)};return(h,p)=>{const _=ne("font-awesome-icon");return m(),V("div",uo,[n.value?(m(),V("input",{key:0,ref_key:"input",ref:o,onFocusout:f,onInput:l,onKeypress:u,class:"editor",value:t.value},null,40,co)):(m(),V("div",{key:1,class:"label",onClick:c},D(t.value),1)),w(_,{class:"icon",icon:["fas","pen"]})])}}}),fo=F(ho,[["__scopeId","data-v-1b5ff080"]]),po={style:{"margin-left":"auto",right:"0px",height:"100%","white-space":"nowrap",overflow:"hidden"}},mo={class:"btn"},vo={class:"btn"},go={class:"btn"},wo={class:"btn"},Vo={class:"btn"},yo={class:"btn"},So={class:"btn"},_o={class:"btn"},xo=450,bo=z({__name:"ActionButtonsBar",setup(i){const e=$(),t=Ee("contextMenu"),s=$(),n=$(),o=fe(),a=l=>{var u;(s!=null||s!=null)&&((u=t.value)==null||u.OpenUnder(s.value))},c=()=>{var h;var l=(h=e.value)==null?void 0:h.getBoundingClientRect();if(l!=null){var u=l==null?void 0:l.width;u!=null&&u<xo?n.value=!0:n.value=!1}};qe(()=>{ye(()=>{c(),window.addEventListener("resize",()=>{c()})})});const f=()=>{if(o.CurrentGraph!=null){var l=Be.Serialize(o.CurrentGraph),u=JSON.stringify(l),h=document.createElement("a"),p=new Blob([u],{type:"text/plain"});h.href=URL.createObjectURL(p),h.download="untitled.json",h.click()}};return(l,u)=>{const h=ne("font-awesome-icon"),p=Ne("tooltip");return m(),V("div",{ref_key:"menuContainer",ref:e,style:{display:"flex",height:"100%",width:"100%","white-space":"nowrap",overflow:"hidden"}},[I("div",po,[n.value?(m(),V(J,{key:0},[w(Dt),u[4]||(u[4]=I("div",{class:"separator"},null,-1)),K((m(),V("button",{onClick:a,ref_key:"contextMenuButton",ref:s,class:"btn"},[w(h,{icon:["fas","fa-bars"]})])),[[p,l.$t("tt.menu"),void 0,{bottom:!0}]]),w(Ze,{ref_key:"contextMenu",ref:t},{default:k(()=>[w(ce,null,{default:k(()=>[w(h,{icon:["fas","file"]}),E(" "+D(l.$t("tt.new")),1)]),_:1}),w(ce,null,{default:k(()=>[w(h,{icon:["fas","floppy-disk"]}),E(" "+D(l.$t("tt.save")),1)]),_:1}),w(ce,null,{default:k(()=>[w(h,{icon:["fas","folder-open"]}),E(" "+D(l.$t("tt.load")),1)]),_:1}),u[1]||(u[1]=I("hr",null,null,-1)),w(ce,null,{default:k(()=>[w(h,{icon:["fas","rotate-left"]}),E(" "+D(l.$t("tt.undo")),1)]),_:1}),w(ce,null,{default:k(()=>[w(h,{icon:["fas","rotate-right"]}),E(" "+D(l.$t("tt.redo")),1)]),_:1}),u[2]||(u[2]=I("hr",null,null,-1)),w(ce,null,{default:k(()=>[w(h,{icon:["fas","gear"]}),E(" "+D(l.$t("tt.settings")),1)]),_:1}),u[3]||(u[3]=I("hr",null,null,-1)),w(ce,null,{default:k(()=>[w(h,{icon:["fas","expand"]}),E(" "+D(l.$t("tt.fullscreen")),1)]),_:1})]),_:1,__:[1,2,3]},512),u[5]||(u[5]=I("div",{class:"separator"},null,-1)),K((m(),V("button",mo,[w(h,{icon:["fas","rotate-left"]})])),[[p,l.$t("tt.undo"),void 0,{bottom:!0}]]),K((m(),V("button",vo,[w(h,{icon:["fas","rotate-right"]})])),[[p,l.$t("tt.redo"),void 0,{bottom:!0}]])],64)):(m(),V(J,{key:1},[w(Dt),u[6]||(u[6]=I("div",{class:"separator"},null,-1)),K((m(),V("button",go,[w(h,{icon:["fas","file"]})])),[[p,l.$t("tt.new"),void 0,{bottom:!0}]]),K((m(),V("button",{onClick:u[0]||(u[0]=_=>f()),class:"btn"},[w(h,{icon:["fas","floppy-disk"]})])),[[p,l.$t("tt.save"),void 0,{bottom:!0}]]),K((m(),V("button",wo,[w(h,{icon:["fas","folder-open"]})])),[[p,l.$t("tt.load"),void 0,{bottom:!0}]]),u[7]||(u[7]=I("div",{class:"separator"},null,-1)),K((m(),V("button",Vo,[w(h,{icon:["fas","rotate-left"]})])),[[p,l.$t("tt.undo"),void 0,{bottom:!0}]]),K((m(),V("button",yo,[w(h,{icon:["fas","rotate-right"]})])),[[p,l.$t("tt.redo"),void 0,{bottom:!0}]]),u[8]||(u[8]=I("div",{class:"separator"},null,-1)),K((m(),V("button",So,[w(h,{icon:["fas","gear"]})])),[[p,l.$t("tt.settings"),void 0,{bottom:!0}]]),K((m(),V("button",_o,[w(h,{icon:"fa-solid fa-hammer"})])),[[p,l.$t("tt.build"),void 0,{bottom:!0}]]),u[9]||(u[9]=I("div",{class:"separator"},null,-1)),K((m(),q(ro,null,{default:k(()=>[w(h,{icon:["fas","expand"]})]),_:1})),[[p,l.$t("tt.fullscreen"),void 0,{bottom:!0}]])],64))])],512)}}}),Po=F(bo,[["__scopeId","data-v-be3370e1"]]),Co={class:"disable-user-select left-section",style:{display:"flex","flex-direction":"row"}},Io={class:"logo disable-user-select",style:{"text-transform":"uppercase"}},No={class:"padding"},Mo={class:"middle-actions",style:{}},ko={style:{display:"flex","flex-direction":"row"}},Oo=z({__name:"MainMenuBar",setup(i){const e=$(!1);Fe(e,(s,n)=>{s?document.documentElement.requestFullscreen():document.exitFullscreen()});const t=$("Untitled");return(s,n)=>(m(),V("div",{class:"main",onContextmenu:n[1]||(n[1]=he(()=>{},["prevent"]))},[I("div",Co,[I("div",Io,D(s.$t("logo")),1),w(Po)]),I("div",No,[I("div",Mo,[w(fo,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=o=>t.value=o)},null,8,["modelValue"])])]),I("div",ko,[w(io)])],32))}}),Lo=F(Oo,[["__scopeId","data-v-58738f50"]]),$o={style:{display:"flex"}},Ro=["value","placeholder"],Do=z({__name:"ContextMenuInput",props:ot({Active:{type:Boolean,default:!1},Placeholder:{type:String,default:""},modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:ot(["update:modelValue"],["update:modelValue"]),setup(i,{emit:e}){var t=i;const s=xt(i,"modelValue"),n=e,o=$(),a=l=>{n("update:modelValue",o.value)},c=l=>{l.target!=null&&(o.value=l.target.value,n("update:modelValue",o.value))},f=l=>{l.key=="Enter"&&l.target!=null&&(o.value=l.target.value,n("update:modelValue",o.value))};return(l,u)=>(m(),V("div",$o,[I("input",{onFocusout:a,onInput:c,onKeypress:f,value:s.value,class:Me([{active:i.Active}]),placeholder:ue(t).Placeholder,style:{padding:"5px"}},null,42,Ro),pe(l.$slots,"default",{},void 0,!0)]))}}),To=F(Do,[["__scopeId","data-v-a59750ae"]]),Ao={ref:"inputRange",class:"input-range"},Go=["value"],Xo={class:"title"},Bo={class:"valueText"},Eo=z({props:{Min:Number,Max:Number,Suffix:String,Title:String,RealtimeChange:{type:Boolean,default:!0},Step:{type:Number,default:0},modelValue:{type:Number,default:0}},emits:["update:modelValue"],data(){return{IsDragging:!1,Value:0,lastPosition:new L(0,0),lastValue:0,IsInputVisible:!1,moveDistance:0}},created(){document.addEventListener("mousemove",this.OnMouseMove),document.addEventListener("mouseup",this.OnMouseUp),this.Value=this.modelValue},watch:{modelValue(i,e){this.Value=i}},methods:{ClickValue(i){this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+i,this.Min,this.Max):this.Value=this.Clamp(this.Value+(i>0?this.Step:-this.Step),this.Min,this.Max):this.Step==0?this.Value+=i:this.Value+=i>0?this.Step:-this.Step,this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnInput(i){this.Value=Number(i.target.value),this.Min!=null&&this.Max!=null&&(this.Value=this.Clamp(this.Value,this.Min,this.Max)),this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnMouseDown(i){this.IsInputVisible||(this.$el.requestPointerLock(),this.IsDragging=!0,this.lastPosition=new L(i.clientX,i.clientY),this.lastValue=this.Value,this.moveDistance=0)},OnMouseMove(i){this.IsDragging&&(this.moveDistance+=i.movementX,this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+i.movementX/(i.shiftKey?25:50),this.Min,this.Max):i.movementX!=0&&Math.abs(this.moveDistance)>=(i.shiftKey?25:50)&&(this.moveDistance=0,this.Value=this.Clamp(this.Value+(i.movementX>0?this.Step:-this.Step),this.Min,this.Max)):this.Step==0?this.Value+=i.movementX/(i.shiftKey?25:50):i.movementX!=0&&Math.abs(this.moveDistance)>=(i.shiftKey?25:50)&&(this.moveDistance=0,this.Value+=i.movementX>0?this.Step:-this.Step),this.$emit("update:modelValue",this.Value),this.UpdateEvent())},OnMouseUp(i){var e=new L(i.clientX,i.clientY);e.X==this.lastPosition.X&&e.Y==this.lastPosition.Y&&this.Value==this.lastValue&&(this.IsInputVisible=!0,this.$nextTick(()=>{var t=this.$refs.input;t.focus(),t.select()})),this.IsDragging=!1,document.exitPointerLock()},UpdateEvent(){var i=me();this.RealtimeChange&&(i.ChangeEvent=!i.ChangeEvent)},validate(i){i.key=="Enter"&&i.target.blur();var e=/[0-9-]|\./;e.test(i.key)||i.preventDefault()},Clamp(i,e,t){return Math.min(Math.max(i,e),t)}}}),Yo=z({...Eo,__name:"InputRange",setup(i){return(e,t)=>{const s=ne("font-awesome-icon");return m(),V("div",Ao,[I("div",{class:"button",onClick:t[0]||(t[0]=n=>e.ClickValue(-.1))},[w(s,{icon:["fas","caret-left"]})]),I("div",{class:"value",onMousedown:t[4]||(t[4]=he((...n)=>e.OnMouseDown&&e.OnMouseDown(...n),["left"]))},[e.IsInputVisible?(m(),V("input",{key:0,onKeypress:t[1]||(t[1]=(...n)=>e.validate&&e.validate(...n)),ref:"input",class:"input-element",value:e.modelValue,onInput:t[2]||(t[2]=(...n)=>e.OnInput&&e.OnInput(...n)),onBlur:t[3]||(t[3]=n=>e.IsInputVisible=!1)},null,40,Go)):(m(),V(J,{key:1},[I("div",Xo,D(e.Title)+": ",1),I("div",Bo,D(Number(e.Value.toFixed(4)))+" "+D(e.Suffix),1)],64))],32),I("div",{class:"button",onClick:t[5]||(t[5]=n=>e.ClickValue(.1))},[w(s,{icon:["fas","caret-right"]})])],512)}}}),Ho=F(Yo,[["__scopeId","data-v-5ba96ddd"]]);class pt{constructor(){r(this,"Name");r(this,"Node");r(this,"Values")}static SavePreset(e){var t=localStorage.getItem("presets");if(t!=null){var s=JSON.parse(t),n=nt(s).firstOrDefault(a=>a.Node==e.Node&&a.Name==e.Name);if(n!=null){var o=s.indexOf(n);s.splice(o,1)}s.push(e),localStorage.setItem("presets",JSON.stringify(s))}else{var s=new Array;s.push(e),localStorage.setItem("presets",JSON.stringify(s))}}static GetPresets(){var e=localStorage.getItem("presets");return e!=null?JSON.parse(e):new Array}}const Uo={class:"properties"},Wo={key:0,class:"not-selected"},zo={class:"header"},Fo={style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},qo={class:"buttons",style:{display:"flex","font-weight":"bold"}},Zo={key:0},Ko={key:0,style:{margin:"0px 10px"}},jo={class:"input-group",style:{width:"100%",padding:"0px"}},Jo={key:1,style:{padding:"10px"}},Qo={class:"notice"},ei=z({__name:"PropertiesView",setup(i){const e=fe(),t=re(()=>e.SelectedNode),s=re(()=>e.SelectedNode==null||e.SelectedNode instanceof ke),n=$(),o=re(()=>{var g;return c((g=t.value)==null?void 0:g.Properties)}),a=()=>{if(e.SelectedNode!=null&&e.SelectedNode!=null&&e.SelectedNode){for(var g of e.SelectedNode.Properties)g.Reset();var v=me();v.ChangeEvent=!v.ChangeEvent}};var c=g=>{var v=new Map;return g==null||g.length==0||g.forEach(C=>{var N;v.has(C.Category)||v.set(C.Category,new Array),(N=v.get(C.Category))==null||N.push(C)}),v};const f=Ee("presetsContextMenu"),l=$(),u=g=>{var T;if(l!=null||l!=null){if(t.value!=null){var v=t.value.Name,C=pt.GetPresets(),N=nt(C).where(Z=>Z.Node==v).toArray();n.value=N}(T=f.value)==null||T.OpenUnder(l.value)}},h=$(""),p=()=>{var N,T;if(t.value!=null&&!(h.value==""||h.value==null)){var g=t.value.Properties,v=new pt,C=new Array;g.forEach(Z=>{C.push(Z.Value)}),v.Name=h.value,v.Node=t.value.Name,v.Values=C,(N=n.value)==null||N.push(v),pt.SavePreset(v),(T=f.value)==null||T.Close(),h.value=""}},_=g=>{var v;s.value||(t.value.Properties.forEach((C,N)=>{C.Value=g.Values[N]}),(v=f.value)==null||v.Close(),S())},S=()=>{var g=me();t.value.IsRealtimeUpdate&&(g.ChangeEvent=!g.ChangeEvent)};return(g,v)=>{var T;const C=ne("font-awesome-icon"),N=Ne("tooltip");return m(),V("div",Uo,[s.value?(m(),V("div",Wo,[w(C,{icon:["fas","sliders"]})])):se("",!0),s.value?se("",!0):(m(),V(J,{key:1},[I("div",zo,[I("div",Fo,D(g.$t((T=t.value)==null?void 0:T.Name)),1),I("div",qo,[K((m(),V("button",{ref_key:"presetsButton",ref:l,onClick:u,class:"btn"},[w(C,{icon:["fas","sliders"]})])),[[N,g.$t("tt.presets"),void 0,{bottom:!0}]]),K((m(),V("button",{class:"btn",onClick:a},[w(C,{icon:["fas","arrows-rotate"]})])),[[N,g.$t("tt.resetParams"),void 0,{bottom:!0}]]),w(Ze,{ref_key:"presetsContextMenu",ref:f},{default:k(()=>{var Z;return[(m(!0),V(J,null,Ve(n.value,te=>(m(),q(ce,{onClick:U=>_(te)},{default:k(()=>[w(C,{icon:["fas","sliders"]}),E(" "+D(te.Name),1)]),_:2},1032,["onClick"]))),256)),((Z=n.value)==null?void 0:Z.length)>0?(m(),V("hr",Zo)):se("",!0),w(To,{modelValue:h.value,"onUpdate:modelValue":v[0]||(v[0]=te=>h.value=te),Placeholder:"New preset name..."},{default:k(()=>[I("button",{onClick:p,class:"btn",style:{padding:"6px"}},[w(C,{icon:"fa-solid fa-circle-plus"})])]),_:1},8,["modelValue"])]}),_:1},512)])]),t.value.Name?(m(),V("hr",Ko)):se("",!0),(m(!0),V(J,null,Ve(o.value,([Z,te])=>(m(),q(zt,{style:{"background-color":"transparent",padding:"0px"}},{header:k(()=>[E(D(Z),1)]),default:k(()=>[I("div",jo,[(m(!0),V(J,null,Ve(te,U=>(m(),V(J,null,[typeof U.Value=="number"?(m(),q(Ho,{key:0,modelValue:U.Value,"onUpdate:modelValue":y=>U.Value=y,Min:U.Min,Max:U.Max,Step:U.Step,Suffix:U.Suffix,Title:U.Name},null,8,["modelValue","onUpdate:modelValue","Min","Max","Step","Suffix","Title"])):se("",!0),U.valueList!=null?(m(),q(oo,{key:1,modelValue:U.Value,"onUpdate:modelValue":y=>U.Value=y,default:U.Value,title:U.Name,options:U.valueList},null,8,["modelValue","onUpdate:modelValue","default","title","options"])):se("",!0)],64))),256))])]),_:2},1024))),256)),t.value.IsRealtimeUpdate==!1?(m(),V("div",Jo,[v[2]||(v[2]=I("button",{class:"btn apply-btn"}," Apply changes ",-1)),I("div",Qo,[w(C,{icon:["fas","circle-exclamation"]}),v[1]||(v[1]=E(' This node performs a heavy operation, so the update occurs when you click the "Apply Changes" button and is cached. '))])])):se("",!0)],64))])}}}),ti=F(ei,[["__scopeId","data-v-184b8032"]]);class si{constructor(){r(this,"GridMaterial");r(this,"GridMesh");const e=d(.5).toVar(),t=d(5).toVar(),s=d(1*window.devicePixelRatio).toVar(),n=d(500).toVar(),o=d(200).toVar(),a=mt(.2,.2,.2,.2).toVar(),c=mt(.05,.05,.05,.2).toVar(),f=ds,l=cs,u=O(([A,G])=>{const R=vt(A,G),Y=He(W(Se(W(R,.5)),.5)),H=vt(Y,Xt(R));return ie(H.x,H.y)}),h=u(f.xz,e),p=u(f.xz,t),_=W(1,ze(0,s,h)),S=W(1,ze(0,s,p)),g=W(f,l),v=it(g),C=ze(d(n),d(0),v),N=ze(d(o),d(0),v),T=ee(a,ee(_,N)).toVar(),Z=ee(c,ee(S,C)).toVar(),te=hs(Z,T),U=new Bt;U.colorNode=te,U.transparent=!0,U.side=Ct,U.lights=!1;const y=new Et(1e3,1e3,1,1);y.rotateX(-Math.PI/2);const M=new It(y,U);this.GridMesh=M,this.GridMaterial=U}}class ni{constructor(){r(this,"Mesh");const e=O(([o,a,c])=>{const f=x(o.x,o.y).toVar(),l=x(He(f.mul(2).sub(1)).sub(x(a,c))).toVar();return l.assign(d(1).sub(l.div(Xt(l)))),fs(ie(l.x,l.y))});var t=new ps({color:"#fff",transparent:!0,side:Ct});t.colorNode=O(()=>{const o=e(Je(),1,1).toVar(),a=e(Je(),.9,1).toVar(),c=e(Je(),1,.9).toVar(),f=e(Je(),.98,.98).toVar(),l=Ie(0,1,o.sub(a).sub(c).sub(f)).toVar();return mt(.8,.8,.8,l)})();var s=new Et(1,1,1,1);s.rotateX(-Math.PI/2);var n=new It(s,t);n.castShadow=!1,n.receiveShadow=!1,n.scale.set(10,1,10),n.position.set(0,.005,0),this.Mesh=n}}class oi{static async Generate(e=1,t=1,s=1,n=1){var o=new ms;const a=e/2,c=t/2,f=Math.floor(s),l=Math.floor(n),u=f+1,h=l+1,p=e/f,_=t/l,S=[],g=[],v=[],C=[];for(let N=0;N<h;N++){const T=N*_-c;for(let Z=0;Z<u;Z++){const te=Z*p-a;g.push(te,-T,0),v.push(0,0,1),C.push(Z/f),C.push(1-N/l)}await new Promise(Z=>setTimeout(Z,0))}for(let N=0;N<l;N++){for(let T=0;T<f;T++){const Z=T+u*N,te=T+u*(N+1),U=T+1+u*(N+1),y=T+1+u*N;S.push(Z,te,y),S.push(te,U,y)}await new Promise(T=>setTimeout(T,0))}return o.setIndex(S),o.setAttribute("position",new ct(g,3)),o.setAttribute("normal",new ct(v,3)),o.setAttribute("uv",new ct(C,2)),o}}class ii{constructor(){r(this,"Height",2);r(this,"GPURenderer");r(this,"HeightTexture");r(this,"TerrainMaterial");r(this,"IsMeshGenerated",$(!0));r(this,"Scene");r(this,"Camera");r(this,"Controls");r(this,"TerrainMesh");r(this,"GridMesh");r(this,"DirectionalLight");r(this,"DirectionalLight2");r(this,"_resolution",512);r(this,"_textureResolution",512);r(this,"_canvas");r(this,"_isColorized",!1);this.CreateRenderer(),this.Scene=new vs,this.Scene.environmentNode=gs("#ffffff"),this.Scene.environmentIntensity=.05,this.Camera=new ws(75,1,.01,1e3),this.Camera.position.z=10,this.Camera.position.y=10,this.CreateMaterial(),this.CreateTexture(this._resolution),this.CreateTerrainMesh(this.Resolution),this.CreateLight();const e=new si;this.GridMesh=e.GridMesh,this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2),this.Scene.add(this.GridMesh);var t=new ni;this.Scene.add(t.Mesh);const s=me();s.SetRenderer(this),s.Resolution=this.Resolution}get Resolution(){return this._resolution}get TextureResolution(){return this._textureResolution}CreateMaterial(){this.TerrainMaterial=new Bt({color:"#a2a2a2"}),this.TerrainMaterial.side=Ct,this.TerrainMaterial.needsUpdate=!0,this.TerrainMaterial.metalness=0,this.TerrainMaterial.roughness=1,this.TerrainMaterial.positionNode=O(()=>{const e=d(1/this.Resolution),t=d(1).sub(e).toVar(),s=Te.xyz.toVar(),n=Qe(this.HeightTexture,Te.xz.add(.5).mul(t)).mul(this.Height);return s.y.addAssign(n),s})(),this.TerrainMaterial.normalNode=O(()=>{const e=d(1/this.TextureResolution).toVar(),t=d(1).sub(e).toVar(),s=Te.xyz.add(kt(e,0,0)).toVar(),n=Te.xyz.add(kt(0,0,e.negate())).toVar(),o=Te.xyz.toVar(),a=Qe(this.HeightTexture,Te.xz.add(.5).mul(t)).mul(this.Height);o.y.addAssign(a),s.y.addAssign(Qe(this.HeightTexture,s.xz.add(.5)).mul(t).mul(this.Height)),n.y.addAssign(Qe(this.HeightTexture,n.xz.add(.5)).mul(t).mul(this.Height));const c=s.sub(o).normalize(),f=n.sub(o).normalize();return Vs(ys(c,f))})()}CreateRenderer(){this.GPURenderer=new Ss({alpha:!0,antialias:!0}),this.GPURenderer.shadowMap.enabled=!0,this.GPURenderer.shadowMap.type=_s,this.GPURenderer.toneMapping=xs,this.GPURenderer.setClearColor(0,0),this.GPURenderer.setPixelRatio(window.devicePixelRatio)}CreateTexture(e){this.HeightTexture=new bs(Math.floor(this.TextureResolution),Math.floor(this.TextureResolution)),this.HeightTexture.format=Ps,this.HeightTexture.type=Cs}CreateLight(){const e=new Ot(16777215,2);e.position.set(-10,10,0),e.castShadow=!0,e.shadow.autoUpdate=!0,e.shadow.camera.near=.1,e.shadow.camera.far=30,e.shadow.camera.top=8,e.shadow.camera.right=8,e.shadow.camera.bottom=-8,e.shadow.camera.left=-8,e.shadow.mapSize.set(8192,8192),e.shadow.radius=5,e.shadow.blurSamples=25,e.shadow.normalBias=.05,this.DirectionalLight=e;const t=new Ot(16777215,.5);t.position.set(10,10,0),this.DirectionalLight2=t}SetIsMeshGenerated(e){this.IsMeshGenerated.value=e}CreateTerrainMesh(e){this.SetIsMeshGenerated(!1),oi.Generate(1,1,e,e).then(t=>{t.rotateX(-Math.PI/2),this.TerrainMesh=new It(t,this.TerrainMaterial),this.TerrainMesh.castShadow=!0,this.TerrainMesh.receiveShadow=!0,this.TerrainMesh.scale.set(10,1,10),this.TerrainMesh.position.set(0,.006,0),this.Scene.add(this.TerrainMesh),this.SetIsMeshGenerated(!0)})}ChangeResolution(e){this._textureResolution=e,this.TerrainMaterial.dispose(),this.HeightTexture.dispose(),this.CreateTexture(this.TextureResolution),this.CreateMaterial(),this.TerrainMesh.material=this.TerrainMaterial,this.Scene.remove(this.DirectionalLight),this.Scene.remove(this.DirectionalLight2),this.DirectionalLight.dispose(),this.DirectionalLight2.dispose(),this.CreateLight(),this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2);const t=me();t.Resolution=this.TextureResolution;const s=fe();s.LockedNode!=null?this.Recalculate(s.LockedNode):s.SelectedNode!=null&&this.Recalculate(s.SelectedNode),requestAnimationFrame(()=>this.Render())}OnWindowResize(){if(this.GPURenderer==null||this.Camera==null||this._canvas==null)return;var e=this._canvas.offsetHeight,t=this._canvas.offsetWidth;this.GPURenderer.setSize(t,e);const s=t/e;this.Camera.aspect=s,this.Camera.updateProjectionMatrix(),requestAnimationFrame(()=>this.Render())}async Render(){await this.GPURenderer.renderAsync(this.Scene,this.Camera)}Mount(e){this._canvas=e;var t=this._canvas.offsetHeight,s=this._canvas.offsetWidth;this._canvas.appendChild(this.GPURenderer.domElement),this.GPURenderer.setSize(s,t),this.Camera.aspect=s/t,this.Controls=new Is(this.Camera,this.GPURenderer.domElement),this.Controls.enablePan=!1,this.Controls.update(),window.addEventListener("resize",()=>this.OnWindowResize()),this.Render(),requestAnimationFrame(()=>this.Render)}RequestRender(){requestAnimationFrame(()=>this.Render)}async Recalculate(e,t=!1){if(this.IsMeshGenerated.value==!1)return;t||e.Calculate();var s=e.Outputs[e.DefaultOutput].Value;const o=O(()=>{const a=be.modInt(this.TextureResolution),c=be.div(this.TextureResolution),f=st(a,c),l=x(f.x,f.y).div(this.TextureResolution).toVar(),u=s(l).toVar();u.assign(Ie(u,0,1)),Ns(this.HeightTexture,f,u).toWriteOnly()})().compute(this.TextureResolution*this.TextureResolution);this.GPURenderer.computeAsync(o).then(()=>{e.CalculationState=Oe.Calculated,requestAnimationFrame(()=>this.Render())})}SetGridVisible(e){this.GridMesh.visible=e,requestAnimationFrame(()=>this.Render())}}const ai={class:"container"},ri={key:0,style:{position:"relative",height:"100%",width:"100%"}},li=z({__name:"Preview3D",setup(i){const e=$();e.value=new ii;const t=$();var s=me();const n=re(()=>s.ChangeEvent);var o=fe();const a=re(()=>o.SelectedNode),c=re(()=>{var g;return(g=e.value)==null?void 0:g.IsMeshGenerated});Fe(c,async(g,v)=>{requestAnimationFrame(()=>{var C;return(C=e.value)==null?void 0:C.Render()})}),Fe(n,async(g,v)=>{var C,N;o.LockedNode!=null?(C=e.value)==null||C.Recalculate(o.LockedNode,!1):a.value!=null&&((N=e.value)==null||N.Recalculate(a.value,!1))}),Fe(a,async g=>{var C,N;if(o.LockedNode!=null)(C=e.value)==null||C.Recalculate(o.LockedNode);else if(g!=null){var v=g;await((N=e.value)==null?void 0:N.Recalculate(v))}}),qe(()=>{ye(()=>{var g;(g=e.value)==null||g.Mount(t.value)})});let f=!1;const l=()=>{f=!0},u=()=>{f=!1};window.addEventListener("mouseup",u),window.addEventListener("pointerup",u);const h=()=>{f&&requestAnimationFrame(()=>{var g;return(g=e.value)==null?void 0:g.Render()})},p=()=>{requestAnimationFrame(()=>{var g;return(g=e.value)==null?void 0:g.Render()})},_=$(!0),S=()=>{var g;_.value=!_.value,(g=e.value)==null||g.SetGridVisible(_.value)};return(g,v)=>{var T;const C=ne("font-awesome-icon"),N=Ne("tooltip");return m(),V("div",ai,[(T=e.value)!=null&&T.IsMeshGenerated?se("",!0):(m(),V("div",ri,[w(qt,{style:{scale:"2"}}),v[0]||(v[0]=I("span",{style:{position:"absolute !important",top:"calc(50% + 20px)",width:"100%","text-align":"center"}}," Initializing mesh...",-1))])),I("div",{onMousedown:l,onMousemove:h,onWheel:p,onPointerdown:l,onPointermove:h,ref_key:"canvas",ref:t,style:{height:"100%",width:"100%"}},[w(Vt,{class:"top-left"},{default:k(()=>[w(xe,null,{default:k(()=>[K((m(),V("a",{onClick:S},[w(C,{icon:["fas","hashtag"]})])),[[N,"Switch Grid visibility",void 0,{bottom:!0}]])]),_:1})]),_:1})],544)])}}}),ui=F(li,[["__scopeId","data-v-f4b894cd"]]),di={style:{width:"100%",height:"100%"}},ci={style:{height:"calc(100% - 80px)",display:"flex","flex-direction":"row"}},hi={style:{width:"80%",height:"100%"}},fi={style:{height:"50%",width:"100%",display:"block"}},pi={style:{"margin-left":"5px"}},mi={style:{height:"50%"}},vi={style:{width:"20%",height:"100%"}},gi={style:{"margin-left":"5px"}},wi=z({__name:"LayoutView",setup(i){return(e,t)=>{const s=ne("font-awesome-icon");return m(),V("div",di,[w(Lo,{style:{height:"50px"}}),I("div",ci,[I("div",hi,[I("div",fi,[w(ut,{style:{display:"inline-block",width:"100%"}},{header:k(()=>[w(s,{icon:["fas","mountain-sun"]}),I("span",pi,D(e.$t("windows.thirdPreview")),1)]),default:k(()=>[w(ui)]),_:1})]),I("div",mi,[w(Kn)])]),I("div",vi,[w(ut,{style:{width:"100%"},"wheel-focus":!1},{header:k(()=>[w(s,{icon:["fas","sliders"]}),I("span",gi,D(e.$t("windows.properties")),1)]),default:k(()=>[w(ti)]),_:1})])]),w(qs,{style:{height:"30px"}})])}}}),Vi=F(wi,[["__scopeId","data-v-415e308f"]]),yi=ts({history:ss("/"),routes:[{path:"/",name:"home",component:Vi}]});class Si extends Q{constructor(){super(...arguments);r(this,"Name","nodes.clamp");r(this,"Inputs",[new X(!0,this,"Source")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Min",0,0,1),new P("Max",1,0,1)]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value),s=b(this.Properties[1].Value);this.Outputs[0].Value=O(([n])=>{var a;if(!this.Inputs[0].IsConnected)return d(0);const o=(a=this.Inputs[0].Links[0].In)==null?void 0:a.Value(n);return Ie(o,t,s)})}}class _i extends Q{constructor(){super(...arguments);r(this,"Name","nodes.combine");r(this,"Inputs",[new X(!0,this,"Source 1"),new X(!0,this,"Source 2")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Mode","Burn",["Burn","Darken","Difference","Dodge","Divide","Exclusion","HardLight","HardMix","Lighten","LinearBurn","LinearDodge","LinearLight","LinearLightAddSub","Multiply","Negation","Overlay","PinLight","Screen","SoftLight","Subtract","VividLight","Overwrite"]),new P("Strength",0,0,100,0,"","%")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=this.Properties[0].Value,s=b(this.Properties[1].Value);this.Outputs[0].Value=O(([n])=>{var f,l;if(!this.Inputs[0].IsConnected||!this.Inputs[1].IsConnected)return d(0);const o=(f=this.Inputs[0].Links[0].In)==null?void 0:f.Value(n).toVar(),a=(l=this.Inputs[1].Links[0].In)==null?void 0:l.Value(n).toVar(),c=s.mul(.01);switch(t){case"Burn":{const u=d(1).sub(d(1).sub(a).div(o)).toVar();return B(o,u,c)}case"Darken":{const u=ie(o,a).toVar();return B(o,u,c)}case"Difference":{const u=He(a.sub(o)).toVar();return B(o,u,c)}case"Dodge":{const u=o.div(a.add(d(1e-12))).toVar();return B(o,u,c)}case"Divide":{const u=o.div(d(1).sub(a)).toVar();return B(o,u,c)}case"Exclusion":{const u=a.add(o).sub(d(2).mul(a).mul(o)).toVar();return B(o,u,c)}case"HardLight":{const u=d(W(1,ee(2,W(1,o)).mul(W(1,a)))).toVar(),h=d(ee(2,o).mul(a)).toVar(),p=d(Ae(a,.5)).toVar(),_=d(h.mul(p).add(d(1).sub(p).mul(u))).toVar();return B(o,_,c)}case"HardMix":{const u=d(Ae(d(1).sub(o),a)).toVar();return B(o,u,c)}case"Lighten":{const u=we(a,o).toVar();return B(o,u,c)}case"LinearBurn":{const u=d(o.add(a.sub(1))).toVar();return B(o,u,c)}case"LinearDodge":{const u=o.add(a).toVar();return B(o,u,c)}case"LinearLight":{const u=d(ks(a.lessThan(.5),we(o.add(d(2).mul(a).sub(d(1))),d(0)),ie(o.add(d(2).mul(a.sub(.5))),d(1)))).toVar();return B(o,u,c)}case"LinearLightAddSub":{const u=d(a.add(ee(2,o).sub(1))).toVar();return B(o,u,c)}case"Multiply":{const u=o.mul(a).toVar();return B(o,u,c)}case"Negation":{const u=d(W(1,He(W(1,a).sub(o)))).toVar();return B(o,u,c)}case"Overlay":{const u=d(W(1,ee(2,W(1,o)).mul(W(1,a)))).toVar(),h=d(ee(2,o).mul(a)).toVar(),p=d(Ae(o,.5)).toVar(),_=d(h.mul(p).add(d(1).sub(p).mul(u))).toVar();return B(o,_,c)}case"PinLight":{const u=d(Ae(.5,a)).toVar(),h=d(u.mul(we(ee(2,o.sub(.5)),a))).toVar(),p=d(h.add(W(1,u).mul(ie(ee(2,o),a)))).toVar();return B(o,p,c)}case"Screen":{const u=d(W(1,W(1,a).mul(W(1,o)))).toVar();return B(o,u,c)}case"SoftLight":{const u=d(W(1,ee(2,W(1,o)).mul(W(1,a)))).toVar(),h=d(Ms(o).mul(ee(2,a).sub(1)).add(ee(2,o).mul(W(1,a)))).toVar(),p=d(Ae(a,.5)).toVar(),_=d(h.mul(p).add(d(1).sub(p).mul(u))).toVar();return B(o,_,c)}case"Subtract":{const u=o.sub(a).toVar();return B(o,u,c)}case"VividLight":{const u=d(W(1,W(1,a).div(ee(2,o)))).toVar(),h=d(a.div(ee(2,W(1,o)))).toVar(),p=d(Ae(.5,o)).toVar(),_=d(h.mul(p).add(d(1).sub(p).mul(u))).toVar();return B(o,_,c)}case"Overwrite":return B(o,a,c)}return d(0)})}}class xi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.constant");r(this,"Outputs",[new X(!1,this,"Output")]);r(this,"Properties",[new P("Height",0,0,1)]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value);this.Outputs[0].Value=O(([s])=>d(t))}}class bi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.cracks");r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Angle",0,0,100,0,"Noise",""),new P("Thickness",.03,0,1,0,"Noise",""),new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value),a=b(this.Properties[4].Value),c=b(this.Properties[5].Value),f=b(this.Properties[6].Value),l=b(this.Properties[7].Value);this.Outputs[0].Value=O(([u])=>{const h=x(u.x,u.y).toVar(),p=x(dt(h.mul(2).mul(.5),a,x(f,l),c)).mul(o).mul(.2);return en({uv:h.add(p),angle:s,scale:t,thickness:n})})}}const Pi=O(([i,e,t])=>{const s=d(t).toVar(),n=d(e).toVar(),o=d(i).toVar();s.assign(we(0,s));const a=d(we(0,ie(1,n.sub(o).add(s).div(d(2).mul(s))))).toVar();return o.mul(a).add(n.mul(d(1).sub(a)).sub(s.mul(a).mul(d(1).sub(a))))}).setLayout({name:"smoothMin",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),Ci=O(([i,e,t])=>{const s=d(t).toVar(),n=d(e).toVar(),o=d(i).toVar();s.assign(ie(0,s.negate()));const a=d(we(0,ie(1,n.sub(o).add(s).div(d(2).mul(s))))).toVar();return o.mul(a).add(n.mul(d(1).sub(a)).sub(s.mul(a).mul(d(1).sub(a))))}).setLayout({name:"smoothMax",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),Ii=O(([i])=>{const e=x(i).toVar();return Se(ve(Ce(e.xy,x(12.9898,78.233))).mul(43758.5453123))}).setLayout({name:"random",type:"float",inputs:[{name:"st",type:"vec2"}]}),Ni=O(([i,e,t])=>{const s=d(t).toVar(),n=d(e).toVar(),o=x(i).toVar(),a=x(o.mul(n)).toVar(),c=x(Ye(a)).toVar(),f=x(Se(a)).toVar(),l=d(Ii(c).mul(2).sub(1).mul(s)).toVar(),u=d(ve(l)).toVar(),h=d(at(l)).toVar(),p=x(f.sub(.5)).toVar(),_=x().toVar();return _.x.assign(p.x.mul(h).sub(p.y.mul(u))),_.y.assign(p.x.mul(u).add(p.y.mul(h))),_.add(.5).add(c).mod(1)}).setLayout({name:"tilingWithLimitedRotation",type:"vec2",inputs:[{name:"uv",type:"vec2"},{name:"tileCount",type:"float"},{name:"maxAngle",type:"float"}]});class Mi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.crater");r(this,"Outputs",[new X(!1,this,"Output")]);r(this,"Properties",[new P("Smoothness",.5,0,1,0,"Crater params",""),new P("FloorHeight",-1,-5,5,0,"Crater params",""),new P("Radius",.16,0,1,0,"Crater params",""),new P("RimWidth",1.35,0,100,0,"Crater params",""),new P("RimSteepness",4,0,100,0,"Crater params",""),new P("X",.5,0,1,0,"Transform",""),new P("Y",.5,0,1,0,"Transform","")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value),a=b(this.Properties[4].Value),c=b(this.Properties[5].Value),f=b(this.Properties[6].Value);this.Outputs[0].Value=O(([l])=>{const u=x(l.x,l.y).toVar(),h=x(c,f).toVar(),p=d(it(u.sub(h)).div(we(n,1e-4))).toVar(),_=d(p.mul(p).sub(1)).toVar(),S=d(ie(p.sub(1).sub(o),0)).toVar(),g=d(a.mul(S).mul(S)).toVar(),v=d(Ci(_,s,t)).toVar();return v.assign(Pi(v,g,t)),v.mul(n).add(.5).toVar()})}}class ki extends Q{constructor(){super(...arguments);r(this,"Name","nodes.fake");r(this,"Position",new L(1e3,1e3))}}class Oi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.falloff");r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Strength",0,0,10)]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value);this.Outputs[0].Value=O(([s])=>{const n=x(s.x,s.y).toVar(),o=d(Yt(x(.5),n.mod(1))).mul(t).toVar(),a=B(d(1),d(0),o).toVar();return rt(Ie(a,0,1),2)})}}class Li extends Q{constructor(){super(...arguments);r(this,"Name","nodes.fastErosion");r(this,"Inputs",[new X(!0,this,"Inpute Height")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Tiles",4,0,20,0,"Erosion",""),new P("Octaves",5,0,20,1,"Erosion",""),new P("Gain",.5,0,1,0,"Erosion",""),new P("Lacunarity",2,0,10,0,"Erosion",""),new P("Slope strength",3,0,10,0,"Erosion",""),new P("Branch strength",3,0,10,0,"Erosion",""),new P("Erosion Strength",.04,0,1,0,"Erosion","")]);r(this,"IsRealtimeUpdate",!1);r(this,"terrainHeight");r(this,"waterVolume");r(this,"sedimentAmount");r(this,"tempTerrainHeight");r(this,"tempWaterVolume");r(this,"tempSedimentAmount")}Calculate(){this.BaseCalculate();const t=me(),s=t.GetRenderer(),n=t.Resolution,o=b(.1),a=b(.1),c=b(.1),f=b(1),l=b(.1),u=b(.1),h=b(9.8),p=b(.01),_=b(3),S=b(n),g=b(n);this.terrainHeight=Ge(n*n,"float"),this.waterVolume=Ge(n*n,"float"),this.sedimentAmount=Ge(n*n,"float"),this.tempTerrainHeight=Ge(n*n,"float"),this.tempWaterVolume=Ge(n*n,"float"),this.tempSedimentAmount=Ge(n*n,"float");const v=O(()=>{var R;const y=be.modInt(n),M=be.div(n),A=st(y,M),G=x(A.x,A.y).div(n).toVar();if(this.Inputs[0].IsConnected){const H=((R=this.Inputs[0].Links[0].In)==null?void 0:R.Value)(G).toVar();this.terrainHeight.element(be).assign(H)}}),C=O(([y,M])=>{const A=d(M).toVar(),G=d(y).toVar();return G.assign(Ie(G,de(0),S.sub(de(1)))),A.assign(Ie(A,de(0),g.sub(de(1)))),A.mul(S).add(G)}),N=O(([y,M])=>{const A=d(M).toVar(),G=x(y).toVar(),R=d(ee(.01,Se(ve(d(A).mul(12.9898)).mul(43758.5453)).mul(2).sub(1))).toVar();return Gt(G.add(x(R)))});O(([y,M,A])=>{const G=de(A).toVar(),R=d(M).toVar(),Y=d(y).toVar(),H=d(C(Y,R)).toVar(),le=d(this.tempWaterVolume.element(H).add(a.mul(o))).toVar(),oe=d(this.tempSedimentAmount.element(H)).toVar(),ae=d(this.tempTerrainHeight.element(H)).toVar(),Ke=x(x(this.tempTerrainHeight.element(C(Y.add(1),R)).sub(this.tempTerrainHeight.element(C(Y.sub(1),R))),this.tempTerrainHeight.element(C(Y,R.add(1))).sub(this.tempTerrainHeight.element(C(Y,R.sub(1))))).mul(.5)).toVar(),Ue=d(it(Ke)).toVar();et(le.greaterThan(0).and(Ue.greaterThan(0)),()=>{const $e=x(N(Ke,G)).toVar(),je=d(ie(le,Ue.mul(h).mul(o))).toVar(),Pe=d(ie(le,je)).toVar(),Re=Xe(Xe(Y,R).add(Xe(Lt($e)))).toVar(),De=de(C(Re.x,Re.y)).toVar();this.tempWaterVolume.element(De).addAssign(Pe),le.subAssign(Pe);const _e=d(we(Ue,p).mul(Pe).mul(f)).toVar();et(oe.lessThan(_e),()=>{const We=d(ie(_e.sub(oe).mul(l),ae.sub(this.tempTerrainHeight.element(De)))).toVar();oe.addAssign(We),this.tempTerrainHeight.element(H).assign(ae.sub(We))}).Else(()=>{const We=d(oe.sub(_e).mul(u)).toVar();oe.subAssign(We),this.tempTerrainHeight.element(H).assign(ae.add(We))});const Nt=d(oe.mul(Pe).div(le)).toVar();this.tempSedimentAmount.element(De).addAssign(Nt),oe.subAssign(Nt)}),le.mulAssign(W(1,c.mul(o))),oe.assign(we(0,oe)),this.tempWaterVolume.element(H).assign(le),this.tempSedimentAmount.element(H).assign(oe)});const T=O(([y,M])=>{const A=de(M).toVar(),G=st(y.x,y.y).toVar();return G.y.mul(A).add(G.x)});O(()=>{this.tempTerrainHeight.element(be).addAssign(.5)});const Z=O(()=>{const y=de(be).toVar(),M=de(y.modInt(S)).toVar(),A=de(y.div(S)).toVar(),G=de(C(M,A)).toVar();this.tempTerrainHeight.element(G).assign(this.terrainHeight.element(G)),this.tempWaterVolume.element(G).assign(this.waterVolume.element(G)),this.tempSedimentAmount.element(G).assign(this.sedimentAmount.element(G)),ht(),Pt(_,()=>{const R=d(C(M,A)).toVar(),Y=d(this.tempWaterVolume.element(R).add(a.mul(o))).toVar(),H=d(this.tempSedimentAmount.element(R)).toVar(),le=d(this.tempTerrainHeight.element(R)).toVar(),oe=x(x(this.tempTerrainHeight.element(C(M.add(1),A)).sub(this.tempTerrainHeight.element(C(M.sub(1),A))),this.tempTerrainHeight.element(C(M,A.add(1))).sub(this.tempTerrainHeight.element(C(M,A.sub(1))))).mul(.5)).toVar(),ae=d(it(oe)).toVar();et(Y.greaterThan(0).and(ae.greaterThan(0)),()=>{const Ke=x(N(oe,y)).toVar(),Ue=d(ie(Y,ae.mul(h).mul(o))).toVar(),$e=d(ie(Y,Ue)).toVar(),je=Xe(Xe(M,A).add(Xe(Lt(Ke)))).toVar(),Pe=de(C(je.x,je.y)).toVar();this.tempWaterVolume.element(Pe).addAssign($e),Y.subAssign($e);const Re=d(we(ae,p).mul($e).mul(f)).toVar();et(H.lessThan(Re),()=>{const _e=d(ie(Re.sub(H).mul(l),le.sub(this.tempTerrainHeight.element(Pe)))).toVar();H.addAssign(_e),this.tempTerrainHeight.element(R).assign(le.sub(_e))}).Else(()=>{const _e=d(H.sub(Re).mul(u)).toVar();H.subAssign(_e),this.tempTerrainHeight.element(R).assign(le.add(_e))});const De=d(H.mul($e).div(Y)).toVar();this.tempSedimentAmount.element(Pe).addAssign(De),H.subAssign(De)}),Y.mulAssign(W(1,c.mul(o))),H.assign(we(0,H)),this.tempWaterVolume.element(R).assign(Y),this.tempSedimentAmount.element(R).assign(H),ht(),this.terrainHeight.element(R).assign(this.tempTerrainHeight.element(R)),this.waterVolume.element(R).assign(this.tempWaterVolume.element(R)),this.sedimentAmount.element(R).assign(this.tempSedimentAmount.element(R)),ht()}),this.terrainHeight.element(G).assign(this.tempTerrainHeight.element(G)),this.waterVolume.element(G).assign(this.tempWaterVolume.element(G)),this.sedimentAmount.element(G).assign(this.tempSedimentAmount.element(G))}),te=v().compute(n*n),U=Z().compute(n*n);s==null||s.GPURenderer.compute(te),s==null||s.GPURenderer.computeAsync(U),this.Outputs[0].Value=O(([y])=>{if(this.Inputs[0].IsConnected){x(y.x,y.y).toVar();const M=be.modInt(n),A=be.div(n),G=st(M,A);return this.terrainHeight.element(T(G,n)).toVar()}else return 0})}}class $i extends Q{constructor(){super(...arguments);r(this,"Name","nodes.gradientNoise");r(this,"Outputs",[new X(!1,this,"Output")]);r(this,"Properties",[new P("Scale",10,0,100),new P("Offset X",0,0,100),new P("Offset Y",0,0,100)]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value);this.Outputs[0].Value=O(([o])=>{const a=x(o.x,o.y).mul(t).toVar(),c=x(s,n).toVar();return a.addAssign(c),Ft(a)})}}class Ri extends Q{constructor(){super(...arguments);r(this,"Name","nodes.invert");r(this,"Inputs",[new X(!0,this,"Source")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate(),this.Outputs[0].Value=O(([t])=>{var n;if(!this.Inputs[0].IsConnected)return d(0);const s=(n=this.Inputs[0].Links[0].In)==null?void 0:n.Value(t);return d(1).sub(s)})}}class Di extends Q{constructor(){super(...arguments);r(this,"Name","nodes.mountain");r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Scale",3.55,0,100,0,"Noise Transform","%"),new P("Octaves Count",10,1,50,1,"Noise Params",""),new P("Offset X",-.08,-100,100,0,"Noise Transform",""),new P("Offset Y",-.54,-100,100,0,"Noise Transform",""),new P("Falloff",3,0,20,0,"Mountain",""),new P("Height",1,0,1,0,"Mountain",""),new P("Position X",.5,0,1,0,"Mountain Transform",""),new P("Position Y",.5,0,1,0,"Mountain Transform","")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value),a=b(this.Properties[4].Value),c=b(this.Properties[5].Value),f=b(this.Properties[6].Value),l=b(this.Properties[7].Value);this.Outputs[0].Value=O(([u])=>{const h=x(u.x,u.y).toVar(),p=d(Yt(x(f,l),h)).mul(a).toVar(),_=B(d(1),d(0),p).toVar(),S=rt(Ie(_,0,1),2),g=h.sub(x(f,l).sub(.5)).toVar(),v=dt(g,s,x(n,o),t).toVar();return Ie(S.mul(v).mul(d(1.45).mul(c)),0,1)})}}class Ti extends Q{constructor(){super(...arguments);r(this,"Name","nodes.redistribution");r(this,"Inputs",[new X(!0,this,"Source")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Exponent",1,1,10)]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value);this.Outputs[0].Value=O(([s])=>{var o;return this.Inputs[0].IsConnected?((o=this.Inputs[0].Links[0].In)==null?void 0:o.Value(s)).pow(t):d(0)})}}class Ai extends Q{constructor(){super(...arguments);r(this,"Name","nodes.terrace");r(this,"Inputs",[new X(!0,this,"Param 1")]);r(this,"Outputs",[new X(!1,this,"Output")]);r(this,"Properties",[new P("Smoothness",.1,0,1),new P("Count",3,0,100,1)]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value);this.Outputs[0].Value=O(([n])=>{var o;if(this.Inputs[0].IsConnected){const c=((o=this.Inputs[0].Links[0].In)==null?void 0:o.Value)(n).toVar();if(this.Properties[1].Value==0)return c;const f=d(1).div(s).toVar(),l=Ye(c.div(f)).toVar(),u=c.sub(l.mul(f)).div(f).toVar(),h=ie(d(2).mul(u),d(1)).toVar(),p=l.add(h).mul(f).toVar(),_=vt(1,d(s)),S=Ye(c.div(_)),g=Se(c.div(_)),v=S.mul(_).add(ze(0,1,g).mul(_));return B(p,v,t)}else return 0})}}class Gi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.voronoi");r(this,"Outputs",[new X(!1,this,"Output"),new X(!1,this,"Cells"),new X(!1,this,"Bubbles")]);r(this,"Properties",[new P("Scale",10,1,100,0,"Transform","%"),new P("OffsetX",0,0,100,0,"Transform",""),new P("OffsetY",0,0,100,0,"Transform",""),new P("Angle",5,0,100,0,"Noise","")]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value);this.Outputs[0].Value=O(([a])=>{const c=x(a.x,a.y).toVar(),f=x(s,n).toVar();c.addAssign(f);const l=ft({UV:c,angleOffset:o,cellDensity:t}).toVar();return rt(l.x,2)}),this.Outputs[1].Value=O(([a])=>{const c=x(a.x,a.y).toVar(),f=x(s,n).toVar();return c.addAssign(f),ft({UV:c,angleOffset:o,cellDensity:t}).toVar().y}),this.Outputs[2].Value=O(([a])=>{const c=x(a.x,a.y).toVar(),f=x(s,n).toVar();c.addAssign(f);const l=ft({UV:c,angleOffset:o,cellDensity:t}).toVar();return Os(rt(l.x,2))})}}class Xi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.transform");r(this,"Inputs",[new X(!0,this,"Input")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Properties",[new P("Scale X",1,0,100,0,"Scale",""),new P("Scale Y",1,0,100,0,"Scale",""),new P("Position X",0,-100,100,0,"Position",""),new P("Position Y",0,-100,100,0,"Position",""),new P("Midpoint X",.5,0,1,0,"Rotation",""),new P("Midpoint Y",.5,0,1,0,"Rotation",""),new P("Angle",0,-360,360,0,"Rotation","")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value),a=b(this.Properties[4].Value),c=b(this.Properties[5].Value),f=b(this.Properties[6].Value);this.Outputs[0].Value=O(([l])=>{var C;const u=x(l.x,l.y).toVar(),h=x(t,s).toVar(),p=x(n,o).toVar(),_=x(a,c).toVar(),S=f.mul(Ht.div(180)).toVar(),g=x(at(S).mul(u.x.sub(_.x)).add(ve(S).mul(u.y.sub(_.y))).add(_.x),at(S).mul(u.y.sub(_.y)).sub(ve(S).mul(u.x.sub(_.x))).add(_.y));return u.assign(g),u.addAssign(p),u.mulAssign(h),(C=this.Inputs[0].Links[0].In)==null?void 0:C.Value(u).toVar()})}}class Bi extends Q{constructor(){super(...arguments);r(this,"Inputs",[new X(!0,this,"Input")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Name","nodes.tile");r(this,"Properties",[new P("Tile Count",1,0,100,1),new P("Angle Threshold",0,0,360,0)]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value),s=b(this.Properties[1].Value);this.Outputs[0].Value=O(([n])=>{var l;var o=x(n).toVar(),a=s.mul(Ht.div(180));const c=Ni(o,t,a).toVar();return(l=this.Inputs[0].Links[0].In)==null?void 0:l.Value(c).toVar()})}}class Ei extends Q{constructor(){super(...arguments);r(this,"Inputs",[new X(!0,this,"Input")]);r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Name","nodes.height");r(this,"IsRealtimeUpdate",!0);r(this,"Properties",[new P("Height",1,0,100,0,"","%")])}Calculate(){this.BaseCalculate();const t=b(this.Properties[0].Value);this.Outputs[0].Value=O(([s])=>{var a;if(!this.Inputs[0].IsConnected)return d(0);var n=x(s).toVar();return((a=this.Inputs[0].Links[0].In)==null?void 0:a.Value(n).toVar()).mul(t.mul(.01))})}}class Yi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.distortion");r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Inputs",[new X(!0,this,"Input")]);r(this,"Properties",[new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=b(this.Properties[0].Value),s=b(this.Properties[1].Value),n=b(this.Properties[2].Value),o=b(this.Properties[3].Value),a=b(this.Properties[4].Value);this.Outputs[0].Value=O(([c])=>{var f;if(this.Inputs[0].IsConnected){const l=(f=this.Inputs[0].Links[0].In)==null?void 0:f.Value,u=x(c.x,c.y).toVar(),h=x(dt(u.mul(2).mul(.5),s,x(o,a),n)).mul(t).mul(.2);return l(u.add(h)).toVar()}else return 0})}}class Hi extends Q{constructor(){super(...arguments);r(this,"Name","nodes.dune");r(this,"Outputs",[new X(!1,this,"Result")]);r(this,"Inputs",[]);r(this,"Properties",[new P("Scale",0,0,0,0,"Tramsform","%"),new P("Height",0,0,0,0,"Tramsform","%"),new P("Wind Direction",0,0,0,0,"Tramsform","%"),new P("Octaves",0,0,0,0,"Noise","%"),new P("Sand Roughness",0,0,0,0,"Noise","%"),new P("Seed",0,0,0,0,"Random","%"),new P("Time",0,0,0,0,"Random","%")]);r(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=b(this.Properties[6].Value),s=b(this.Properties[5].Value),n=b(this.Properties[0].Value),o=b(this.Properties[1].Value),a=b(this.Properties[4].Value),c=b(this.Properties[2].Value);b(this.Properties[3].Value);const f=O(([_])=>{const S=_.toVar();return S.assign(x(Ce(S,x(127.1,311.7)),Ce(S,x(269.5,183.3)))),d(-1).add(ee(2,Se(ve(S.x.add(S.y)).mul(d(43758.5453123)))))}),l=O(([_])=>{const S=Ye(_),g=Se(_),v=g.mul(g).mul(W(3,ee(2,g))),C=f(S),N=f(S.add(x(1,0))),T=f(S.add(x(0,1))),Z=f(S.add(x(1,1)));return B(B(C,N,v.x),B(T,Z,v.x),v.y)}),u=O(([_,S,g])=>{const v=d(0),C=d(1),N=d(1),T=d(0);return Pt(S,({i:Z})=>{v.addAssign(C.mul(l(_.mul(N).add(s)))),T.addAssign(C),C.mulAssign(g),N.mulAssign(2)}),v.div(T)}),h=O(([_,S])=>W(1,He(ve(_.mul(3.14159).mul(S))))),p=O(([_,S])=>{const g=x(at(S),ve(S)),v=u(_.mul(n).add(g.mul(.5)),4,.5);x(g.y.negate(),g.x);const C=ve(_.x.mul(n).mul(.3).add(l(_.mul(2)).mul(2))).mul(ve(_.y.mul(n).mul(.2))).mul(.3),N=v.mul(.7).add(C.mul(.3));N.assign(B(N,h(N,1.5),.4));const T=u(_.mul(n).mul(4),2,.3).mul(a);return N.add(T.mul(.1))});this.Outputs[0].Value=O(([_])=>{const S=_,g=x(t.mul(.01),0),v=p(S.mul(x(2,1)).add(g),c);return v.assign(v.mul(.5).add(.5).mul(o)),v})}}function Ui(){j.registerStr("nodes.buffer","",ke),j.registerStr("nodes.fake","",ki),j.registerStr("nodes.constant","nodeCategories.testNodes",xi),j.registerStr("nodes.perlinNoise","nodeCategories.testNodes",tn),j.registerStr("nodes.mountain","nodeCategories.testNodes",Di),j.registerStr("nodes.terrace","nodeCategories.testNodes",Ai),j.registerStr("nodes.combine","nodeCategories.testNodes",_i),j.registerStr("nodes.clamp","nodeCategories.testNodes",Si),j.registerStr("nodes.invert","nodeCategories.testNodes",Ri),j.registerStr("nodes.redistribution","nodeCategories.testNodes",Ti),j.registerStr("nodes.gradientNoise","nodeCategories.testNodes",$i),j.registerStr("nodes.voronoi","nodeCategories.testNodes",Gi),j.registerStr("nodes.crater","nodeCategories.testNodes",Mi),j.registerStr("nodes.falloff","nodeCategories.testNodes",Oi),j.registerStr("nodes.fastErosion","nodeCategories.testNodes",Li),j.registerStr("nodes.cracks","nodeCategories.testNodes",bi),j.registerStr("nodes.transform","nodeCategories.testNodes",Xi),j.registerStr("nodes.tile","nodeCategories.testNodes",Bi),j.registerStr("nodes.height","nodeCategories.testNodes",Ei),j.registerStr("nodes.distortion","nodeCategories.testNodes",Yi),j.registerStr("nodes.dune","nodeCategories.testNodes",Hi)}const Wi={en:{"":"",logo:"Mashuk",windows:{thirdPreview:"3D Preview",secondPreview:"2D Preview",properties:"Node properties",graph:"Graph",nodesList:"Nodes list"},tt:{undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",delete:"Delete node/selected",fullscreen:"Fullscreen",save:"Save",load:"Load",presets:"Presets",resetView:"Reset view",resetParams:"Reset node parameters to default",lockPreview:"Lock Preview",unlockPreview:"Unlock Preview",mesh_resolution:"Resolution",new:"New project",settings:"Settings",menu:"Menu",resolutionWarning:"Warning! Selecting a high resolution will increase video memory consumption and processing speed.",build:"Build"},hints:{graphLmb:"LMB: Select/Drag node",graphWheel:"Wheel: Zoom/Drag work space",placeHere:"PLACE HERE"},nodes:{constant:"Constant",perlinNoise:"Perlin Noise",mountain:"Mountain",terrace:"Terrace",combine:"Combine",clamp:"Clamp",invert:"Invert",redistribution:"Redistribution",gradientNoise:"Gradient Noise",voronoi:"Voronoi",crater:"Crater",falloff:"Falloff",fastErosion:"Fast Erosion",cracks:"Cracks",transform:"Transform",tile:"Tile",height:"Height",distortion:"Distortion",dune:"Dunes"},nodeCategories:{testNodes:"Test nodes"}},ru:{logo:"Машук",windows:{thirdPreview:"3D Просмотр",secondPreview:"2D Просмотр",properties:"Параметры узла",graph:"Граф",nodesList:"Список узлов"},tt:{undo:"Отменить",redo:"Повторить",copy:"Копировать",paste:"Вставить",delete:"Удалить узел/выделенные",fullscreen:"На весь экран",save:"Сохранить",load:"Загрузить",presets:"Предустановки",resetView:"Сбросить вид",resetParams:"Сбросить параметры узла до значений по умолчанию",lockPreview:"Закрепить отображение",unlockPreview:"Открепить отображение",mesh_resolution:"Разрешение",new:"Новый проект",settings:"Настройки",menu:"Меню",resolutionWarning:"Внимание! Выбор высокого разрешения влечет за собой увеличение потребления видеопамяти и скорости обработки",build:"Сборка"},hints:{graphLmb:"ЛКМ: Выделить/Передвинуть узел",graphWheel:"Колесо мыши: Приближение/Перемещение рабочей области",placeHere:"РАЗМЕСТИТЕ СЗЕСЬ"},nodes:{constant:"Константа",perlinNoise:"Шум Перлина",mountain:"Гора",terrace:"Террасы",combine:"Комбинирование",clamp:"Ограничение",invert:"Инверсия",redistribution:"Перераспределение",gradientNoise:"Градиентный Шум",voronoi:"Шум Вороного",crater:"Кратер",falloff:"Спад",fastErosion:"Быстрая Эрозия",cracks:"Трещины",transform:"Преобразование",tile:"Плитка",height:"Высота",distortion:"Искажения",dune:"Дюны"},nodeCategories:{testNodes:"Тестовые узлы"}}};bt.options.themes.tooltip.delay.show=0;bt.options.distance=10;ns.add(Ls,os);const zi=is({legacy:!1,locale:"en",fallbackLocale:"en",messages:Wi}),Le=as(As);Le.component("font-awesome-icon",rs);Le.use(ls());Le.use(yi);Le.use(bt);Le.use(zi);Le.use(us);Le.mount("#app");Ui();
