var us=Object.defineProperty;var ds=(o,e,t)=>e in o?us(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>ds(o,typeof e!="symbol"?e+"":e,t);import{v as xt,d as Pt,r as O,f as Re,a as Y,o as Fe,b as J,c as w,e as V,g as b,h as v,i as B,u as D,R as cs,j as kt,k as fe,_ as z,l as Ce,w as ue,m as q,n as R,t as M,p as de,q as oe,F as K,s as ve,x as I,T as hs,y as fs,z as ye,A as he,B as ps,C as vs,D as Wt,E as pe,G as ms,H as Et,I as qe,J as Nt,K as ot,L as gs,M as ws,N as ys,O as _s,P as bs,Q as Mt,S as Vs,U as Ss,V as Cs,W as xs,X as Ps,Y as ks,Z as Ns,$ as Ms,a0 as Is}from"./vendor-CcFUcWgI.js";import{w as qt,F as A,i as Kt,f as g,v as x,L as Zt,a as Le,b as Se,d as ke,m as F,n as Os,c as Xe,s as _e,u as k,e as j,g as ie,h as Be,j as $s,k as $e,l as Ve,o as Rs,R as jt,S as It,O as Jt,M as je,P as ct,p as Ot,q as Ke,t as we,r as Ie,x as Ze,D as Je,y as mt,H as Qt,z as Ae,A as Ls,U as As,B as $t,C as Ye,E as Rt,G as De,I as Lt,J as gt,K as es,N as Ds,Q as ze,T as Ts,V as At,W as Bs,X as ts,Y as Es,Z as Gs,_ as Qe,$ as Us,a0 as Xs,a1 as Ee,a2 as Gt,a3 as Ys,a4 as Fs,a5 as zs,a6 as Hs,a7 as Ws,a8 as Ut,a9 as qs,aa as it,ab as ss,ac as at,ad as ft,ae as Ks,af as ns}from"./three-DQh9JERt.js";import{i as Zs}from"./icons-CNPGi31y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();class wt{constructor(){r(this,"Id",xt());r(this,"In",null);r(this,"Out",null);r(this,"IsSelected",!1)}SetSelected(e){var s,n,i;var t=this.In!=null?(s=this.In.ParentNode)==null?void 0:s.ParentGraph:(i=(n=this.Out)==null?void 0:n.ParentNode)==null?void 0:i.ParentGraph;t!=null&&e==!0&&t.DeselectAll(),this.IsSelected=e}DeleteLinkFromTerminals(){var s,n;var e=(s=this.In)==null?void 0:s.Links.indexOf(this);e!=null&&this.In!=null&&this.In.Links.splice(e,1);var t=(n=this.Out)==null?void 0:n.Links.indexOf(this);t!=null&&this.Out!=null&&this.Out.Links.splice(t,1)}}class L{constructor(e,t){r(this,"X",0);r(this,"Y",0);this.X=e,this.Y=t}get Length(){return Math.sqrt(this.X*this.X+this.Y*this.Y)}get Normalized(){return L.Div(this,this.Length)}Reset(){this.X=0,this.Y=0}static Equal(e,t){return e.X==t.X&&e.Y==t.Y}static Add(e,t){return t instanceof L?new L(e.X+t.X,e.Y+t.Y):typeof t=="number"?new L(e.X+t,e.Y+t):e}static Sub(e,t){return t instanceof L?new L(e.X-t.X,e.Y-t.Y):typeof t=="number"?new L(e.X-t,e.Y-t):e}static Mul(e,t){return t instanceof L?new L(e.X*t.X,e.Y*t.Y):typeof t=="number"?new L(e.X*t,e.Y*t):e}static Div(e,t){return t instanceof L?new L(e.X/t.X,e.Y/t.Y):typeof t=="number"?new L(e.X/t,e.Y/t):e}}var os=(o=>(o[o.none=0]="none",o[o.Buffer=1]="Buffer",o[o.Primitives=2]="Primitives",o[o.GeoPrimitives=3]="GeoPrimitives",o[o.Warps=4]="Warps",o[o.Adjastments=5]="Adjastments",o[o.Profile=6]="Profile",o[o.Filters=7]="Filters",o[o.Erosion=8]="Erosion",o[o.Snow=9]="Snow",o[o.Water=10]="Water",o[o.Data=11]="Data",o[o.Color=12]="Color",o[o.Render=13]="Render",o[o.Output=14]="Output",o))(os||{}),be=(o=>(o[o.NotCalculated=0]="NotCalculated",o[o.Calculation=1]="Calculation",o[o.Calculated=2]="Calculated",o))(be||{});class P{constructor(e,t,s,n=0,i=0,a="",l=""){r(this,"Name","");r(this,"Description","");r(this,"Value");r(this,"Min",-10);r(this,"Max",10);r(this,"Suffix");r(this,"Category");r(this,"Step");r(this,"valueList");r(this,"Default");this.Name=e,this.Value=t,this.Default=t,this.Min=typeof s=="number"?s:0,this.Max=n,this.Suffix=l,this.Category=a,this.Step=i,this.valueList=s instanceof Array?s:void 0}Reset(){this.Value=this.Default}}class is{constructor(e,t){r(this,"_graph");r(this,"_node");this._graph=e,this._node=t}Undo(){this._graph.DeleteNode(this._node,!1)}Redo(){this._graph.AddNode(this._node,!1),this._node.DontMoveOnMount=!0}}class js{constructor(e,t){r(this,"_graph");r(this,"_node");this._graph=e,this._node=t}Undo(){this._node.DontMoveOnMount=!0,this._graph.AddNode(this._node,!1)}Redo(){this._graph.DeleteNode(this._node,!1)}}class Xt{constructor(e,t,s){r(this,"_node");r(this,"_oldPosition");r(this,"_newPosition");this._node=e,this._oldPosition=new L(t.X,t.Y),this._newPosition=new L(s.X,s.Y)}Undo(){this._node.Move(this._oldPosition.X,this._oldPosition.Y)}Redo(){this._node.Move(this._newPosition.X,this._newPosition.Y)}}class rt{constructor(e,t){r(this,"_graph");r(this,"_link");this._graph=e,this._link=t}Undo(){this._graph.DeleteLink(this._link,!1)}Redo(){this._graph.AddLinkAsObject(this._link,!1)}}class He{constructor(e,t){r(this,"_graph");r(this,"_link");this._graph=e,this._link=t}Undo(){this._graph.AddLinkAsObject(this._link,!1)}Redo(){this._graph.DeleteLink(this._link,!1)}}class Q{constructor(){r(this,"Id",xt());r(this,"Position",new L(0,0));r(this,"LastPosition",new L(0,0));r(this,"Name","");r(this,"Category",os.none);r(this,"Properties");r(this,"Inputs",[]);r(this,"Outputs",[]);r(this,"IsSelected",!1);r(this,"Height",0);r(this,"Width",0);r(this,"IsCalculated",!1);r(this,"ParentGraph",null);r(this,"CalculationState",be.NotCalculated);r(this,"IsRealtimeUpdate",!1);r(this,"DefaultOutput",0);r(this,"DontMoveOnMount",!1)}Move(e,t){this.Position=new L(e,t)}SetSize(e,t){this.Height=e,this.Width=t}SetSelected(e,t=!0){this.IsSelected=e;const s=me();e&&t?s.SelectedNode=this:s.SelectedNode==this&&(s.SelectedNode=null)}SetLastPosition(e,t){this.LastPosition.X=e,this.LastPosition.Y=t}async BaseCalculate(){var e,t,s,n;this.CalculationState==be.Calculation,this.Outputs.forEach(i=>{i.Links.forEach(a=>{var l,c;(c=(l=a==null?void 0:a.Out)==null?void 0:l.ParentNode)==null||c.SetNotCalculated()})});for(const i of this.Inputs)i.IsConnected&&(await((t=(e=i.Links[0].In)==null?void 0:e.ParentNode)==null?void 0:t.Calculate()),(n=(s=i.Links[0].In)==null?void 0:s.ParentNode)==null||n.SetCalculated());this.CalculationState==be.Calculation}SetNotCalculated(){this.CalculationState=be.NotCalculated,this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,n;(n=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||n.SetNotCalculated()})})}SetCalculated(){this.CalculationState=be.Calculated}async Calculate(){}}class E{constructor(e,t,s){r(this,"Guid",xt());r(this,"Links",new Array);r(this,"IsInput",!1);r(this,"ParentNode",null);r(this,"Position",new L(0,0));r(this,"OffsetPosition",new L(0,0));r(this,"Value",null);r(this,"Name","");this.ParentNode=t,this.IsInput=e,this.Name=s}get IsConnected(){return this.Links.length>0}SetOffset(e,t){this.OffsetPosition=new L(e,t)}SetPosition(e,t){this.Position=new L(e,t)}}const lt=Pt("drag",()=>{const o=O(!1),e=O(),t=O(),s=O();function n(a){s.value=a}function i(){return s.value}return{setNode:n,getNode:i,SourceTerminal:e,DestinationTerminal:t,IsDragging:o}}),me=Pt("nodes",()=>{const o=O(),e=O(),t=O();return{SelectedNode:o,LockedNode:e,CurrentGraph:t}}),ge=Pt("renderer",()=>{const o=O(!1),e=O(),t=i=>{e.value=i},s=()=>e.value,n=O();return{ChangeEvent:o,Resolution:n,SetRenderer:t,GetRenderer:s}});class st{constructor(...e){r(this,"_actionsStack",[]);this._actionsStack=e}PushAction(e){this._actionsStack.push(e)}Undo(){this._actionsStack.reverse().forEach(e=>{e.Undo()})}Redo(){this._actionsStack.forEach(e=>{e.Redo()})}}class yt{constructor(){r(this,"IsSubGraph",!1);r(this,"Nodes",new Array);r(this,"Links",new Array)}get HasSelected(){return this.Nodes.some(e=>e.IsSelected)||this.Links.some(e=>e.IsSelected)}AddNode(e,t=!0){var s=this.Nodes.indexOf(e);s==-1&&(e.ParentGraph=this,this.Nodes.push(e),t&&W.AddAction(new is(this,e)))}DeleteLink(e,t=!0){var s=this.Links.indexOf(e);s!=-1&&(e.DeleteLinkFromTerminals(),this.Links.splice(s,1),t&&W.AddAction(new He(this,e)))}IsEqualLink(e,t){var s=new wt;return e.IsInput?(s.In=t,s.Out=e):(s.In=e,s.Out=t),!Re(this.Links).any(n=>n.In==s.In&&n.Out==s.Out)}AddLink(e,t,s=!0){var n=new wt;return e.IsInput&&t.IsInput||!e.IsInput&&!t.IsInput||(e.IsInput?(n.In=t,n.Out=e):(n.In=e,n.Out=t),Re(this.Links).any(i=>i.In==n.In&&i.Out==n.Out))||(t.Links.push(n),e.Links.push(n),this.Links.push(n),s&&W.AddAction(new rt(this,n))),n}AddLinkAsObject(e,t=!0){e.In!=null&&e.In.Links.push(e),e.Out!=null&&e.Out.Links.push(e),this.Links.push(e),t&&W.AddAction(new rt(this,e))}DeleteNode(e,t=!0){var s=this.DeleteNodeAndGetHistory(e);t&&W.AddAction(s)}DeleteNodeAndGetHistory(e){var t=new st;if(e==null)return t;var t=new st,s=me();s.SelectedNode==e&&(s.SelectedNode=null),s.LockedNode==e&&(s.LockedNode=null),e.Inputs.forEach(i=>{var a=i.Links.map(l=>l);a.forEach(l=>{this.DeleteLink(l,!1),t.PushAction(new He(this,l))})}),e.Outputs.forEach(i=>{var a=i.Links.map(l=>l);a.forEach(l=>{this.DeleteLink(l,!1),t.PushAction(new He(this,l))})});var n=this.Nodes.indexOf(e);return n!=-1&&this.Nodes.splice(n,1),t.PushAction(new js(this,e)),t}DeleteSelected(e=!0){var t=new st;this.Nodes.filter(n=>n.IsSelected).forEach(n=>{t.PushAction(this.DeleteNodeAndGetHistory(n))});var s=me();s.SelectedNode=void 0,this.Links.filter(n=>n.IsSelected).forEach(n=>{this.DeleteLink(n,!0),t.PushAction(new He(this,n))}),e&&W.AddAction(t)}DeselectAll(){var e=me();e.SelectedNode=void 0,this.Nodes.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1)),this.Links.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1))}SelectAll(){this.Nodes.forEach(e=>e.SetSelected(!0))}}class Z{static register(e){var t=new e;this.classMap.set(t.constructor.name,e)}static registerStr(e,t,s){this.classMap.set(e,s),this.groupsMap.has(t)||this.groupsMap.set(t,new Map);var n=this.groupsMap.get(t);n==null||n.set(e,s)}static create(e,...t){const s=this.classMap.get(e);if(!s)throw new Error(`Class ${e} not registered`);return new s(...t)}static getGroups(){return this.groupsMap}}r(Z,"classMap",new Map),r(Z,"groupsMap",new Map);class Ge{static Serialize(e){var a,l,c,d,h,_,f,u;var t=new Js;if(e.Nodes!=null&&e.Nodes.length>0)for(const m of e.Nodes){var s=new Qs;if(s.NodeType=m.Name,s.NodeGuid=m.Id,s.NodePostition=m.Position,m.Properties!=null&&m.Properties.length>0)for(const y of m.Properties){var n=new en;n.Value=y.Value,s.Properties==null&&(s.Properties=new Array),s.Properties.push(n)}t.Nodes==null&&(t.Nodes=new Array),t.Nodes.push(s)}if(e.Links!=null&&e.Links.length>0)for(const m of e.Links){var i=new tn;i.FromNodeGuid=(l=(a=m.In)==null?void 0:a.ParentNode)==null?void 0:l.Id,i.ToNodeGuid=(d=(c=m.Out)==null?void 0:c.ParentNode)==null?void 0:d.Id,i.FromTerminalIndex=(_=(h=m.In)==null?void 0:h.ParentNode)==null?void 0:_.Outputs.indexOf(m.In),i.ToTerminalIndex=(u=(f=m.Out)==null?void 0:f.ParentNode)==null?void 0:u.Inputs.indexOf(m.Out),t.Links==null&&(t.Links=new Array),t.Links.push(i)}return t}static Deserialize(e){var t=new yt;if(e.Nodes!=null&&e.Nodes.length>0)for(var s of e.Nodes){var n=Z.create(s.NodeType);if(n.Id=s.NodeGuid,n.Move(s.NodePostition.X,s.NodePostition.Y),s.Properties!=null&&s.Properties.length>0)for(var i=0;i<s.Properties.length;i++)n.Properties[i].Value=s.Properties[i].Value;t.AddNode(n,!1)}if(e.Links!=null&&e.Links.length>0)for(var a of e.Links){var l=Re(t.Nodes).firstOrDefault(d=>d.Id==a.FromNodeGuid),c=Re(t.Nodes).firstOrDefault(d=>d.Id==a.ToNodeGuid);l==null||c==null||t.AddLink(l.Outputs[a.FromTerminalIndex],c.Inputs[a.ToTerminalIndex],!1)}return t}}class Js{constructor(){r(this,"Nodes");r(this,"Links")}static ToJson(e){return JSON.stringify(e)}}class Qs{constructor(){r(this,"NodeGuid");r(this,"NodeType");r(this,"NodePostition");r(this,"Properties")}}class en{constructor(){r(this,"Value")}}class tn{constructor(){r(this,"FromNodeGuid");r(this,"ToNodeGuid");r(this,"FromTerminalIndex");r(this,"ToTerminalIndex")}}class sn{constructor(e=100){r(this,"_history",[]);r(this,"_currentIndex",-1);r(this,"_maxHistory");this._maxHistory=e}AddAction(e){this._history=this._history.slice(0,this._currentIndex+1),this._history.push(e),this._currentIndex++,this._history.length>this._maxHistory&&(this._history.shift(),this._currentIndex--)}Undo(){if(!this.CanUndo())return;this._history[this._currentIndex].Undo(),this._currentIndex--}Redo(){if(!this.CanRedo())return;this._currentIndex++,this._history[this._currentIndex].Redo()}CanUndo(){return this._currentIndex>=0}CanRedo(){return this._currentIndex<this._history.length-1}Clear(){this._history=[],this._currentIndex=-1}getState(){return this._history}}class nn{constructor(e){r(this,"buffer");r(this,"capacity");r(this,"head",0);r(this,"tail",0);r(this,"size",0);r(this,"poppedItems",[]);if(e<=0)throw new Error("Capacity must be greater than 0");this.capacity=e,this.buffer=new Array(e)}get hasValues(){return this.size>0}get hasPoppedItems(){return this.poppedItems.length>0}push(e){this.poppedItems=[],this.size===this.capacity?(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.head=(this.head+1)%this.capacity):(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++)}pop(){if(!this.hasValues)return;this.tail=(this.tail-1+this.capacity)%this.capacity;const e=this.buffer[this.tail];return this.size--,this.poppedItems.push(e),e}unpop(){if(!this.hasPoppedItems)return;const e=this.poppedItems.pop();return this.size===this.capacity&&(this.head=(this.head+1)%this.capacity),this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++,e}toArray(){const e=[];for(let t=0;t<this.size;t++){const s=(this.head+t)%this.capacity;e.push(this.buffer[s])}return e}peek(){if(this.hasValues)return this.buffer[(this.tail-1+this.capacity)%this.capacity]}get length(){return this.size}}class _t{static get HasValues(){return this.ActionHistoryBuffer.hasValues}static get HasPopped(){return this.ActionHistoryBuffer.hasPoppedItems}static PushState(e){this.ActionHistoryBuffer.push(Ge.Serialize(e))}static UnpopState(){if(this.ActionHistoryBuffer.hasPoppedItems){var e=this.ActionHistoryBuffer.unpop();return Ge.Deserialize(e)}return null}static PopState(){if(this.ActionHistoryBuffer.hasValues){var e=this.ActionHistoryBuffer.pop();return Ge.Deserialize(e)}return null}}r(_t,"ActionHistoryBuffer",new nn(25));class W{static AddAction(e){this._actionsManager.AddAction(e),this.CanUndo.value=this._actionsManager.CanUndo(),this.CanRedo.value=this._actionsManager.CanRedo(),console.log(this._actionsManager.getState())}static Undo(){this._actionsManager.Undo(),this.CanUndo.value=this._actionsManager.CanUndo(),this.CanRedo.value=this._actionsManager.CanRedo(),console.log(this._actionsManager.getState())}static Redo(){this._actionsManager.Redo(),this.CanUndo.value=this._actionsManager.CanUndo(),this.CanRedo.value=this._actionsManager.CanRedo(),console.log(this._actionsManager.getState())}}r(W,"_actionsManager",new sn(100)),r(W,"CanUndo",O(!1)),r(W,"CanRedo",O(!1));const on={key:0,class:"gpu-error-box disable-user-select"},an={class:"gpu-error-message-box"},rn={style:{"font-size":"100px","text-align":"center",color:"var(--vt-c-red)"}},ln={key:2,class:"gpu-error-box disable-user-select"},un={class:"gpu-error-message-box"},dn={style:{"font-size":"100px","text-align":"center",color:"var(--vt-c-red)"}},cn=Y({__name:"App",setup(o){document.onkeydown=i=>{i.key=="F12"&&i.preventDefault()};const e=kt(),t=localStorage.getItem("userLang");t&&e!=null&&(e.appContext.config.globalProperties.$i18n.locale=t);const s=fe(()=>navigator.gpu),n=fe(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));return Fe(()=>{window.addEventListener("keydown",i=>{(i.metaKey||i.ctrlKey)&&i.key=="z"&&(i.stopPropagation(),i.preventDefault(),W.Undo()),(i.metaKey||i.ctrlKey)&&i.shiftKey&&i.key=="z"&&(i.stopPropagation(),i.preventDefault(),W.Redo()),(i.metaKey||i.ctrlKey)&&i.key=="s"&&(i.stopPropagation(),i.preventDefault(),console.log("save me"))})}),(i,a)=>{const l=J("font-awesome-icon");return n.value?(w(),V("div",on,[b("div",an,[b("div",rn,[v(l,{icon:["fas","circle-xmark"]})]),a[0]||(a[0]=b("h1",null,"Mobile devices not supported yet",-1))])])):s.value?(w(),B(D(cs),{key:1})):(w(),V("div",ln,[b("div",un,[b("div",dn,[v(l,{icon:["fas","circle-xmark"]})]),a[1]||(a[1]=b("h1",null,"WebGPU is not supported on this browser.",-1))])]))}}}),hn=z(cn,[["__scopeId","data-v-7fb9995b"]]),fn=Y({__name:"HeapMonitor",setup(o){const e=O(0),t=O(0),s=()=>{setInterval(n,1e3)};Fe(()=>{s()});const n=()=>{performance&&performance.memory&&(e.value=performance.memory.usedJSHeapSize/1024/1024/1024,t.value=performance.memory.jsHeapSizeLimit/1024/1024/1024)};return(i,a)=>{const l=J("font-awesome-icon"),c=Ce("tooltip");return w(),V("div",{onContextmenu:a[0]||(a[0]=ue(()=>{},["prevent"])),class:"memory-usage"},[q((w(),V("span",null,[v(l,{icon:["fas","memory"]}),R(" "+M(e.value.toFixed(2))+" / "+M(t.value.toFixed(2))+" ",1),a[1]||(a[1]=b("span",null," GB",-1))])),[[c,"Heap memory usage",void 0,{up:!0}]])],32)}}}),pn=z(fn,[["__scopeId","data-v-72365581"]]),vn={class:"status-bar-grid disable-user-select"},mn={class:"working-status"},gn=Y({__name:"StatusBar",setup(o){return ge(),(e,t)=>{const s=J("font-awesome-icon");return w(),V("div",vn,[b("div",mn,[v(s,{icon:["fas","bars-progress"]}),t[0]||(t[0]=R(" Idle ",-1))]),b("div",null,[v(pn)])])}}}),wn=z(gn,[["__scopeId","data-v-ddd0f7cf"]]),yn={class:"collapse"},_n={class:"carete"},bn={key:0,class:"collapse-body"},Vn=Y({__name:"Collapse",setup(o){var e=O(!1);const t=()=>{e.value=!e.value};return(s,n)=>{const i=J("font-awesome-icon");return w(),V("div",yn,[b("div",{onClick:t,class:"header"},[b("div",_n,[D(e)?(w(),B(i,{key:0,icon:["fas","angle-right"]})):(w(),B(i,{key:1,icon:["fas","angle-down"]}))]),de(s.$slots,"header",{},void 0,!0)]),D(e)?oe("",!0):(w(),V("div",bn,[de(s.$slots,"default",{},void 0,!0)]))])}}}),as=z(Vn,[["__scopeId","data-v-ed8ad461"]]),et=A(([o])=>{const e=x(o).toVar();e.assign(e.modInt(g(289)));const t=g(g(34).mul(e.x).add(1).mul(e.x).modInt(289).add(e.y)).toVar();return t.assign(g(34).mul(t).add(g(1)).mul(t).modInt(289)),t.assign(Se(t.div(g(41))).mul(g(2)).sub(1)),Os(x(t.sub(Le(t.add(.5))),Xe(t).sub(.5)))}).setLayout({name:"gradientNoiseDir",type:"vec2",inputs:[{name:"p",type:"vec2"}]}),Sn=A(([o])=>{const e=x(o).toVar(),t=x(Le(e)).toVar(),s=x(Se(e)).toVar(),n=g(ke(et(t),s)).toVar(),i=g(ke(et(t.add(x(g(0),g(1)))),s.sub(x(g(0),g(1))))).toVar(),a=g(ke(et(t.add(x(g(1),g(0)))),s.sub(x(g(1),g(0))))).toVar(),l=g(ke(et(t.add(x(g(1),g(1)))),s.sub(x(g(1),g(1))))).toVar();return s.assign(s.mul(s).mul(s).mul(s.mul(s.mul(g(6)).sub(g(15))).add(g(10)))),F(F(n,i,s.y),F(a,l,s.y),s.x)}).setLayout({name:"gradientNoise",type:"float",inputs:[{name:"p",type:"vec2"}]}),rs=A(([o])=>Sn(o).add(.5)),ht=A(([o,e,t,s])=>{const n=Kt(e).toVar(),i=g(s).toVar(),a=x(t.x,t.y).toVar(),l=x(o.x,o.y).sub(g(.5)).mul(i).toVar();l.addAssign(a);const c=g(0).toVar(),d=g(1).div(2).toVar();return Zt(n,({i:h})=>{const _=l.mul(g(2).pow(g(h))).toVar(),f=rs(_).mul(d).toVar();d.divAssign(2),c.addAssign(f)}),c}).setLayout({name:"perlinNoise",type:"float",inputs:[{name:"UV",type:"vec2"},{name:"octaves",type:"int"},{name:"offset",type:"vec2"},{name:"scale",type:"float"}]}),Cn=qt(`
fn cracks(uv: vec2<f32>, angle: f32, scale: f32, thickness: f32) -> f32  {
	let st: vec2<f32> = (uv - 0.5) * scale;
	let i_st: vec2<f32> = floor(st);
	let f_st: vec2<f32> = fract(st);
	var m1: f32 = 1.;
	var m2: f32 = 1.;

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let neighbor: vec2<f32> = vec2<f32>(x, y);
			var point: vec2<f32> = random2(i_st + neighbor);
			point = 0.5 + 0.5 * sin(angle + 6.2831 * point);
			let diff: vec2<f32> = neighbor + point - f_st;
			let dist: f32 = length(diff);
			let cond: f32 = step(dist, m1);
			m2 = mix(min(max(m1, dist), m2), m1, cond);
			m1 = mix(m1, dist, cond);
		}

	}

	let edge: f32 = smoothstep(0.01, thickness, m2 - m1);
	return edge;
} 

fn random2(p: vec2<f32>) -> vec2<f32> {
	return fract(sin(vec2<f32>(dot(p, vec2<f32>(127.1, 311.7)), dot(p, vec2<f32>(269.5, 183.3)))) * 43758.547);
} 
`),pt=qt(`
fn voronoi(UV: vec2<f32>, angleOffset: f32, cellDensity: f32) -> vec2<f32> {
	let g: vec2<f32> = floor((UV - 0.5) * cellDensity);
	let f: vec2<f32> = fract((UV - 0.5) * cellDensity);
	var res: vec3<f32> = vec3<f32>(8., 0., 0.);

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let lattice: vec2<f32> = vec2<f32>(x, y);
			let offset: vec2<f32> = voronoiNoiseRandomVector(lattice + g, angleOffset);
			let d: f32 = distance(lattice + offset, f);
			res = mix(res, vec3<f32>(d, offset.x, offset.y), step(d, res.x));
		}

	}

	return vec2<f32>(res.x, res.y);
} 

fn voronoiNoiseRandomVector(UV: vec2<f32>, offset: f32) -> vec2<f32> {
	var UV_var = UV;
	let m: mat2x2<f32> = mat2x2<f32>(15.27, 47.63, 99.41, 89.98);
	UV_var = fract(sin(UV_var * m) * 46839.32);
	return vec2<f32>(sin(UV_var.y * offset) * 0.5 + 0.5, cos(UV_var.x * offset) * 0.5 + 0.5);
}
`);class xn extends Q{constructor(){super(...arguments);r(this,"Name","nodes.perlinNoise");r(this,"Outputs",[new E(!1,this,"Output")]);r(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Octaves Count",10,1,50,1,"Noise",""),new P("Offset X",0,-100,100,0,"Transform",""),new P("Offset Y",0,-100,100,0,"Transform",""),new P("Warp Scale",0,0,1,.001,"Warp","%"),new P("Seed",0,0,99999,0,"Random",""),new P("Height",.4,0,1,0,"Noise","")]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0);r(this,"Random",A(([t])=>{const s=x(t).toVar();return Se(_e(ke(s,x(12.9898,78.233))).mul(43758.5453))}))}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value);k(this.Properties[4].Value);const a=k(this.Properties[5].Value),l=k(this.Properties[6].Value);this.Outputs[0].Value=A(([c])=>{const d=x(c.x,c.y).toVar();return d.addAssign(this.Random(x(a).mul(a))),ht(d,s,x(n,i),t).mul(l)})}}const Pn=Y({__name:"DraggableNode",props:{GraphNode:{type:Function,required:!0}},setup(o){const e=lt(),t=o,s=O(),n=d=>{var _;if((_=d.dataTransfer)==null||_.setData("string","1"),t.GraphNode!=null&&t.GraphNode!=null){var h=t.GraphNode;e.setNode(new h)}};var i=void 0;const a=d=>{var f;i=(f=s.value)==null?void 0:f.cloneNode(!0);var h=i.getBoundingClientRect();if(i.style.position="fixed",i.style.left=`${d.touches[0].pageX-h.width/2}px`,i.style.top=`${d.touches[0].pageY-h.height/2}px`,i.style.zIndex="1000",document.body.appendChild(i),t.GraphNode!=null&&t.GraphNode!=null){var _=t.GraphNode;e.setNode(new _)}},l=d=>{if(i!=null){var h=i.getBoundingClientRect();i.style.left=`${d.touches[0].pageX-h.width/2}px`,i.style.top=`${d.touches[0].pageY-h.height/2}px`}},c=d=>{if(i!=null){document.body.removeChild(i),i=void 0,d.preventDefault(),d.stopPropagation();var h=d.changedTouches[0],_=document.elementFromPoint(h.clientX,h.clientY);console.log(_)}};return window.addEventListener("touchmove",l),window.addEventListener("touchend",c),(d,h)=>(w(),V("div",{onTouchstart:a,onDragstart:n,draggable:"true",class:"node",ref_key:"selfEl",ref:s},[de(d.$slots,"default",{},void 0,!0)],544))}}),kn=z(Pn,[["__scopeId","data-v-ee47cd3c"]]),Nn={class:"node-list"},Mn=Y({__name:"NodeList",setup(o){var e=Z.getGroups();return(t,s)=>{const n=J("font-awesome-icon");return w(),V("div",Nn,[(w(!0),V(K,null,ve(D(e),([i,a])=>(w(),V(K,null,[i!=""?(w(),B(as,{key:0},{header:I(()=>[R(M(t.$t(i)),1)]),default:I(()=>[(w(!0),V(K,null,ve(a,([l,c])=>(w(),B(kn,{"-graph-node":c},{default:I(()=>[v(n,{icon:["fas","circle-nodes"]}),R(" "+M(t.$t(l)),1)]),_:2},1032,["-graph-node"]))),256))]),_:2},1024)):oe("",!0)],64))),256))])}}}),In=z(Mn,[["__scopeId","data-v-ff1a0b3e"]]),On={class:"padding"},$n={class:"header disable-user-select"},Rn={class:"body disable-user-select"},Ln=Y({__name:"FrameTab",props:{wheelFocus:{type:Boolean,default:!0}},setup(o){const e=o,t=O(),s=n=>{t.value&&e.wheelFocus&&t.value.focus()};return(n,i)=>(w(),V("div",On,[b("div",{class:"main",tabindex:"0",ref_key:"selfEl",ref:t,onWheel:s},[b("div",$n,[de(n.$slots,"header",{},void 0,!0)]),b("div",Rn,[de(n.$slots,"default",{},void 0,!0)])],544)]))}}),ut=z(Ln,[["__scopeId","data-v-611ecd47"]]);class Oe extends Q{constructor(){super(...arguments);r(this,"Name","nodes.buffer");r(this,"Inputs",[new E(!0,this,"")]);r(this,"Outputs",[new E(!1,this,"")])}async Calculate(){this.BaseCalculate();var t=this.Inputs[0].Links[0].In,s=this.Outputs[0];s.Value=t==null?void 0:t.Value}}class bt{constructor(e,t,s,n){r(this,"X",0);r(this,"Y",0);r(this,"Height",0);r(this,"Width",0);this.X=e,this.Y=t,this.Height=s,this.Width=n}ContainsRect(e){return this.X<=e.X&&e.X+e.Width<=this.X+this.Width&&this.Y<=e.Y&&e.Y+e.Height<=this.Y+this.Height}ContainsPoint(e,t){return this.X<=e&&e<this.X+this.Width&&this.Y<=t&&t<this.Y+this.Height}IntersectsWith(e){return e.X<this.X+this.Width&&this.X<e.X+e.Width&&e.Y<this.Y+this.Height&&this.Y<e.Y+e.Height}static Intersects(e,t){return e.X<t.X+t.Width&&t.X<e.X+e.Width&&e.Y<t.Y+t.Height&&t.Y<e.Y+e.Height}}const An=Y({__name:"ContextMenu",props:{CloseOnAnyClick:{type:Boolean,default:!0},CloseOnMouseOut:{type:Boolean,default:!0}},emits:["lost-focus"],setup(o,{expose:e,emit:t}){const s=O(!1),n=O(),i=t,a=o,l=y=>{s.value=!0,ye(()=>{n.value!=null&&n.value!=null&&(n.value.style.left=y.pageX+"px",n.value.style.top=y.pageY+"px",d(),window.addEventListener("mousedown",m))})},c=y=>{ye(()=>{n.value!=null&&(n.value.style.width=y+"px")})},d=()=>{if(n.value!=null&&n.value!=null){const p=n.value.getBoundingClientRect();if(p.y+p.height>window.innerHeight){var y=p.y+p.height-window.innerHeight;n.value.style.top=p.y-y+"px"}if(p.y<0&&(n.value.style.top="0px"),p.x+p.width>window.innerWidth){var y=p.x+p.width-window.innerWidth;n.value.style.left=p.x-y+"px"}p.x<0&&(n.value.style.left="0px")}},h=y=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var p=y.getBoundingClientRect();n.value.style.left=p.x+"px",n.value.style.top=p.y+p.height+"px",d(),window.addEventListener("mousedown",m)}})},_=y=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var p=y.getBoundingClientRect(),C=n.value.getBoundingClientRect();n.value.style.left=p.x-C.width+"px",n.value.style.top=p.y+"px",d(),window.addEventListener("mousedown",m)}})},f=y=>{s.value=!0,ye(()=>{if(n.value!=null&&n.value!=null){var p=y.getBoundingClientRect();n.value.style.left=p.x+p.width+"px",n.value.style.top=p.y+"px",d(),window.addEventListener("mousedown",m)}})},u=()=>{window.removeEventListener("mousedown",m),s.value=!1},m=y=>{if(a.CloseOnMouseOut&&n.value!=null){var p=n.value.getBoundingClientRect(),C=new bt(p.x,p.y,p.height,p.width);C.ContainsPoint(y.clientX,y.clientY)||(s.value=!1,window.removeEventListener("mousedown",m),i("lost-focus"))}};return e({Open:l,Close:u,OpenUnder:h,OpenLeft:_,OpenRight:f,SetWidth:c,isOpened:s}),(y,p)=>(w(),B(fs,{name:"open"},{default:I(()=>[(w(),B(hs,{to:"body"},[s.value?(w(),V("div",{key:0,onContextmenu:p[0]||(p[0]=ue(()=>{},["prevent"])),onMousedown:p[1]||(p[1]=ue(()=>{},["stop"])),ref_key:"ContextMenu",ref:n,class:"context-menu disable-user-select"},[de(y.$slots,"default",{},void 0,!0)],544)):oe("",!0)]))]),_:3}))}}),Te=z(An,[["__scopeId","data-v-bc41e1a3"]]);class Yt{static pathExists(e,t){if(e===t)return!0;const s=new Set;return this.dfs(e,t,s)}static dfs(e,t,s){if(e===t)return!0;if(s.has(e))return!1;s.add(e);for(const n of e.Outputs)for(const i of n.Links)if(i.Out!=null&&i.Out!=null){const a=i.Out.ParentNode;if(this.dfs(a,t,s))return!0}return!1}}const Dn=Y({__name:"TerminalRenderer",props:{Term:{type:E,required:!0}},setup(o,{expose:e}){const t=O(!1),s=lt(),n=o,i=_=>{s.SourceTerminal=n.Term,s.IsDragging=!0,window.addEventListener("mouseup",a)},a=_=>{var y,p,C,S,T;window.removeEventListener("mouseup",a),s.IsDragging=!1;var f=s.DestinationTerminal,u=s.SourceTerminal;if(f!=null&&f!=u&&!(u!=null&&u.IsInput&&f.IsInput)&&(u==null?void 0:u.ParentNode)!=f.ParentNode&&(p=(y=n.Term.ParentNode)==null?void 0:y.ParentGraph)!=null&&p.IsEqualLink(f,u)){if(u!=null&&u.IsInput){if(Yt.pathExists(u==null?void 0:u.ParentNode,f.ParentNode))return;u.Links.forEach(H=>{var te,G;(G=(te=u==null?void 0:u.ParentNode)==null?void 0:te.ParentGraph)==null||G.DeleteLink(H)})}if(f.IsInput){if(Yt.pathExists(f==null?void 0:f.ParentNode,u==null?void 0:u.ParentNode))return;f.Links.forEach(H=>{var te,G;(G=(te=f==null?void 0:f.ParentNode)==null?void 0:te.ParentGraph)==null||G.DeleteLink(H)})}(S=(C=n.Term.ParentNode)==null?void 0:C.ParentGraph)==null||S.AddLink(f,u);var m=ge();(T=n.Term.ParentNode)!=null&&T.IsRealtimeUpdate&&(m.ChangeEvent=!m.ChangeEvent)}},l=_=>{s.IsDragging&&(s.DestinationTerminal=n.Term)},c=_=>{s.IsDragging&&(s.DestinationTerminal=null)},d=O();Fe(()=>{ye(()=>{h()})});const h=()=>{var u,m,y,p;var _=((u=d.value)==null?void 0:u.offsetLeft)+((m=d.value)==null?void 0:m.offsetWidth)/2+2,f=((y=d.value)==null?void 0:y.offsetTop)+((p=d.value)==null?void 0:p.offsetHeight)/2+2;n.Term.SetOffset(_,f)};return e({SetOffset:h}),(_,f)=>{const u=Ce("tooltip");return q((w(),V("div",{class:he(["node-terminal",{connected:n.Term.IsConnected},"disable-user-select",{"build-marker":t.value}]),onMousedown:[f[0]||(f[0]=ue(()=>{},["right","stop"])),ue(i,["left","prevent"])],onPointerup:f[1]||(f[1]=ue(()=>{},["stop"])),onMouseover:l,onMouseleave:c,ref_key:"selfEl",ref:d},null,34)),[[u,{content:n.Term.Name,placement:n.Term.IsInput?"left":"right"}]])}}}),Ft=z(Dn,[["__scopeId","data-v-fdedcbd9"]]),Tn=Y({__name:"ContextMenuItem",props:{Active:{type:Boolean,default:!1}},setup(o){return(e,t)=>(w(),V("button",{class:he([["btn",{active:o.Active}],"btn"]),style:{padding:"5px"}},[de(e.$slots,"default",{},void 0,!0)],2))}}),ae=z(Tn,[["__scopeId","data-v-3e13e567"]]),Bn={},En={class:"loader"};function Gn(o,e){return w(),V("span",En)}const ls=z(Bn,[["render",Gn],["__scopeId","data-v-8c5c5c6f"]]);class nt extends Q{constructor(){super(...arguments);r(this,"Name","nodes.combine");r(this,"Inputs",[new E(!0,this,"Source 1"),new E(!0,this,"Source 2")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Mode","Burn",["Burn","Darken","Difference","Dodge","Divide","Exclusion","HardLight","HardMix","Lighten","LinearBurn","LinearDodge","LinearLight","LinearLightAddSub","Multiply","Negation","Overlay","PinLight","Screen","SoftLight","Subtract","VividLight","Overwrite"]),new P("Strength",0,0,100,0,"","%")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=this.Properties[0].Value,s=k(this.Properties[1].Value);this.Outputs[0].Value=A(([n])=>{var c,d;if(!this.Inputs[0].IsConnected||!this.Inputs[1].IsConnected)return g(0);const i=(c=this.Inputs[0].Links[0].In)==null?void 0:c.Value(n).toVar(),a=(d=this.Inputs[1].Links[0].In)==null?void 0:d.Value(n).toVar(),l=s.mul(.01);switch(t){case"Burn":{const h=g(1).sub(g(1).sub(a).div(i)).toVar();return F(i,h,l)}case"Darken":{const h=Ve(i,a).toVar();return F(i,h,l)}case"Difference":{const h=Xe(a.sub(i)).toVar();return F(i,h,l)}case"Dodge":{const h=i.div(a.add(g(1e-12))).toVar();return F(i,h,l)}case"Divide":{const h=i.div(g(1).sub(a)).toVar();return F(i,h,l)}case"Exclusion":{const h=a.add(i).sub(g(2).mul(a).mul(i)).toVar();return F(i,h,l)}case"HardLight":{const h=g(j(1,ie(2,j(1,i)).mul(j(1,a)))).toVar(),_=g(ie(2,i).mul(a)).toVar(),f=g(Be(a,.5)).toVar(),u=g(_.mul(f).add(g(1).sub(f).mul(h))).toVar();return F(i,u,l)}case"HardMix":{const h=g(Be(g(1).sub(i),a)).toVar();return F(i,h,l)}case"Lighten":{const h=$e(a,i).toVar();return F(i,h,l)}case"LinearBurn":{const h=g(i.add(a.sub(1))).toVar();return F(i,h,l)}case"LinearDodge":{const h=i.add(a).toVar();return F(i,h,l)}case"LinearLight":{const h=g(Rs(a.lessThan(.5),$e(i.add(g(2).mul(a).sub(g(1))),g(0)),Ve(i.add(g(2).mul(a.sub(.5))),g(1)))).toVar();return F(i,h,l)}case"LinearLightAddSub":{const h=g(a.add(ie(2,i).sub(1))).toVar();return F(i,h,l)}case"Multiply":{const h=i.mul(a).toVar();return F(i,h,l)}case"Negation":{const h=g(j(1,Xe(j(1,a).sub(i)))).toVar();return F(i,h,l)}case"Overlay":{const h=g(j(1,ie(2,j(1,i)).mul(j(1,a)))).toVar(),_=g(ie(2,i).mul(a)).toVar(),f=g(Be(i,.5)).toVar(),u=g(_.mul(f).add(g(1).sub(f).mul(h))).toVar();return F(i,u,l)}case"PinLight":{const h=g(Be(.5,a)).toVar(),_=g(h.mul($e(ie(2,i.sub(.5)),a))).toVar(),f=g(_.add(j(1,h).mul(Ve(ie(2,i),a)))).toVar();return F(i,f,l)}case"Screen":{const h=g(j(1,j(1,a).mul(j(1,i)))).toVar();return F(i,h,l)}case"SoftLight":{const h=g(j(1,ie(2,j(1,i)).mul(j(1,a)))).toVar(),_=g($s(i).mul(ie(2,a).sub(1)).add(ie(2,i).mul(j(1,a)))).toVar(),f=g(Be(a,.5)).toVar(),u=g(_.mul(f).add(g(1).sub(f).mul(h))).toVar();return F(i,u,l)}case"Subtract":{const h=i.sub(a).toVar();return F(i,h,l)}case"VividLight":{const h=g(j(1,j(1,a).div(ie(2,i)))).toVar(),_=g(a.div(ie(2,j(1,i)))).toVar(),f=g(Be(.5,i)).toVar(),u=g(_.mul(f).add(g(1).sub(f).mul(h))).toVar();return F(i,u,l)}case"Overwrite":return F(i,a,l)}return g(0)})}}class dt{static async GetBuffer(e,t,s,n,i){const a=new jt(t,t,{type:i,format:n,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1}),l=e.getRenderTarget();var c=new It,d=new Jt(-.5,.5,.5,-.5,1,100);d.position.set(0,0,10);var h=new je(new ct(1,1,1,1)),_=new Ot;n!=Ke?_.colorNode=A(()=>{var u=we(s,Ie()).r;return Ze(u,u,u,1)})():_.colorNode=we(s,Ie()),_.side=Je,_.needsUpdate=!0,h.material=_,c.add(h),e.setRenderTarget(a),await e.renderAsync(c,d);var f=await e.readRenderTargetPixelsAsync(a,0,0,t,t);return a.dispose(),e.setRenderTarget(l),f}}const Un=new TextEncoder,Xn=3;class Yn{async Build(e,t,s){const n=new jt(s,s,{type:t.type,format:mt,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1});var i=new It,a=new Jt(-.5,.5,.5,-.5,1,100);a.position.set(0,0,10);var l=new je(new ct(1,1,1,1)),c=new Ot;return c.colorNode=A(()=>{var d=we(t,Ie()).r;return Ze(d,d,d,1)})(),c.side=Je,c.needsUpdate=!0,l.material=c,i.add(l),e.setRenderTarget(n),await e.renderAsync(i,a),await this.parse(e,n)}async parse(e,t,s){const n=e,i=t,l=Fn(i,s),c=await zn(n,i,l),d=Hn(c,l),h=Wn(d,l);return jn(h,l)}}function Fn(o,e={}){const t={0:1,2:1,3:16},s=o.width,n=o.height,i=o.texture.type,a=o.texture.format,l=e.compression!==void 0?e.compression:Xn,c=e.type!==void 0?e.type:Qt,d=c===Ae?2:1,h=t[l];return{width:s,height:n,type:i,format:a,compression:l,blockLines:h,dataType:d,dataSize:2*d,numBlocks:Math.ceil(n/h),numInputChannels:4,numOutputChannels:4}}async function zn(o,e,t){let s;return s=await o.readRenderTargetPixelsAsync(e,0,0,t.width,t.height),s instanceof Float32Array||s instanceof Uint16Array?s:new Float32Array}function Hn(o,e){const t=e.width,s=e.height,n={r:0,g:0,b:0,a:0},i={value:0},a=e.numOutputChannels==4?1:0,l=e.type==Ae?so:to,c=e.dataType==1?Qn:Vt,d=new Uint8Array(e.width*e.height*e.numOutputChannels*e.dataSize),h=new DataView(d.buffer);for(let _=0;_<s;++_)for(let f=0;f<t;++f){const u=_*t*4+f*4,m=l(o,u),y=l(o,u+1),p=l(o,u+2),C=l(o,u+3),S=(s-_-1)*t*(3+a)*e.dataSize;Jn(n,m,y,p,C),i.value=S+f*e.dataSize,c(h,n.a,i),i.value=S+a*t*e.dataSize+f*e.dataSize,c(h,n.b,i),i.value=S+(1+a)*t*e.dataSize+f*e.dataSize,c(h,n.g,i),i.value=S+(2+a)*t*e.dataSize+f*e.dataSize,c(h,n.r,i)}return d}function Wn(o,e){let t,s,n=0;const i={data:new Array,totalSize:0},a=e.width*e.numOutputChannels*e.blockLines*e.dataSize;switch(e.compression){case 0:t=qn;break;case 2:case 3:t=Kn;break;default:throw Error("EXRExporter: Unsupported compression type.")}e.compression!==0&&(s=new Uint8Array(a));for(let l=0;l<e.numBlocks;++l){const c=o.subarray(a*l,a*(l+1)),d=t(c,s);n+=d.length,i.data.push({dataChunk:d,size:d.length})}return i.totalSize=n,i}function qn(o){return o}function Kn(o,e){const t=e;let s=0,n=Math.floor((o.length+1)/2),i=0;const a=o.length-1;for(;!(i>a||(t[s++]=o[i++],i>a));)t[n++]=o[i++];let l=t[0];for(let d=1;d<t.length;d++){const h=t[d]-l+384;l=t[d],t[d]=h}return ps(t)}function Zn(o,e,t){const s={value:0},n=new DataView(o.buffer);X(n,20000630,s),X(n,2,s),ne(n,"compression",s),ne(n,"compression",s),X(n,1,s),We(n,t.compression,s),ne(n,"screenWindowCenter",s),ne(n,"v2f",s),X(n,8,s),X(n,0,s),X(n,0,s),ne(n,"screenWindowWidth",s),ne(n,"float",s),X(n,4,s),Vt(n,1,s),ne(n,"pixelAspectRatio",s),ne(n,"float",s),X(n,4,s),Vt(n,1,s),ne(n,"lineOrder",s),ne(n,"lineOrder",s),X(n,1,s),We(n,0,s),ne(n,"dataWindow",s),ne(n,"box2i",s),X(n,16,s),X(n,0,s),X(n,0,s),X(n,t.width-1,s),X(n,t.height-1,s),ne(n,"displayWindow",s),ne(n,"box2i",s),X(n,16,s),X(n,0,s),X(n,0,s),X(n,t.width-1,s),X(n,t.height-1,s),ne(n,"channels",s),ne(n,"chlist",s),X(n,t.numOutputChannels*18+1,s),ne(n,"A",s),X(n,t.dataType,s),s.value+=4,X(n,1,s),X(n,1,s),ne(n,"B",s),X(n,t.dataType,s),s.value+=4,X(n,1,s),X(n,1,s),ne(n,"G",s),X(n,t.dataType,s),s.value+=4,X(n,1,s),X(n,1,s),ne(n,"R",s),X(n,t.dataType,s),s.value+=4,X(n,1,s),X(n,1,s),We(n,0,s),We(n,0,s)}function jn(o,e){const t=e.numBlocks*8,s=259+18*e.numOutputChannels,n={value:s+t},i=new Uint8Array(s+t+o.totalSize+e.numBlocks*8),a=new DataView(i.buffer);Zn(i,o,e);for(let l=0;l<o.data.length;++l){const c=o.data[l].dataChunk,d=o.data[l].size;X(a,l*e.blockLines,n),X(a,d,n),i.set(c,n.value),n.value+=d}return i}function Jn(o,e,t,s,n){o.r=e,o.g=t,o.b=s,o.a=n}function We(o,e,t){o.setUint8(t.value,e),t.value+=1}function X(o,e,t){o.setUint32(t.value,e,!0),t.value+=4}function Qn(o,e,t){o.setUint16(t.value,Ls.toHalfFloat(e),!0),t.value+=2}function Vt(o,e,t){o.setFloat32(t.value,e,!0),t.value+=4}function ne(o,e,t){const s=Un.encode(e+"\0");for(let n=0;n<s.length;++n)We(o,s[n],t)}function eo(o){const e=(o&31744)>>10,t=o&1023;return(o>>15?-1:1)*(e?e===31?t?NaN:1/0:Math.pow(2,e-15)*(1+t/1024):6103515625e-14*(t/1024))}function to(o,e){return eo(o[e])}function so(o,e){return o[e]}var St=(o=>(o[o.PNG8=8]="PNG8",o[o.PNG16=16]="PNG16",o))(St||{});class zt{static async Build(e,t,s,n){let i;switch(n){case 8:i=await dt.GetBuffer(e,s,t,mt,As);break;case 16:{var a=await dt.GetBuffer(e,s,t,mt,Ae);i=new Uint16Array(s*s*4);for(var l=0;l<i.length;l++)i[l]=a[l]*65535,l%9e4===0&&await new Promise(d=>setTimeout(d,0));break}}var c=vs({width:s,height:s,depth:n,data:i});return c}}var le=(o=>(o[o.PNG8=0]="PNG8",o[o.PNG16=1]="PNG16",o[o.RAW16=2]="RAW16",o[o.RAW32=3]="RAW32",o[o.EXR16=4]="EXR16",o[o.EXR32=5]="EXR32",o[o.TIFF16=6]="TIFF16",o[o.TIFF32=7]="TIFF32",o))(le||{});class no{constructor(e,t){r(this,"_renderer");r(this,"_textureForCompute");r(this,"_resolution");this._renderer=e,this._resolution=t,this._textureForCompute=new $t(t,t),this._textureForCompute.format=Ke,this._textureForCompute.type=Ae}async Build(e){switch(await this.ComputeTexture(e),e.BuildType){case 2:return await this.BuildRAW16();case 3:return await this.BuildRAW32();case 5:return await this.BuildEXR();case 0:return await this.BuildPNG8();case 1:return await this.BuildPNG16()}return new Blob}async BuildPNG8(){var e=await zt.Build(this._renderer,this._textureForCompute,this._resolution,St.PNG8);return new Blob([e],{type:"image/png"})}async BuildPNG16(){var e=await zt.Build(this._renderer,this._textureForCompute,this._resolution,St.PNG16);return new Blob([e],{type:"image/png"})}async BuildRAW16(){var e=await dt.GetBuffer(this._renderer,this._resolution,this._textureForCompute,Ke,Qt);return new Blob([e],{type:"application/octet-stream"})}async BuildRAW32(){var e=await dt.GetBuffer(this._renderer,this._resolution,this._textureForCompute,Ke,Ae);return new Blob([e],{type:"application/octet-stream"})}async BuildEXR(){const t=await new Yn().Build(this._renderer,this._textureForCompute,this._resolution);return this._renderer.setRenderTarget(null),new Blob([t],{type:"image/x-exr"})}async BuildTIFF16(){return new Blob}async BuildTIFF32(){return new Blob}async ComputeTexture(e){if(e==null||e.InputTermianl==null)return;await e.Calculate();const s=A(()=>{var h;const n=Ye.modInt(this._resolution),i=Ye.div(this._resolution),a=Rt(n,i),l=x(a.x,a.y).div(this._resolution).toVar();var c=(h=e.InputTermianl)==null?void 0:h.Value;const d=c(l).toVar();d.assign(De(d,0,1)),Lt(this._textureForCompute,a,d).toWriteOnly()})().compute(this._resolution*this._resolution);await this._renderer.computeAsync(s)}}class Ue extends Q{constructor(){super(...arguments);r(this,"Name","nodes.export");r(this,"Inputs",[new E(!0,this,"Input")]);r(this,"IsRealtimeUpdate",!0);r(this,"ExportFileName");r(this,"BuildType",le.EXR32)}SetFileName(t){this.ExportFileName=t}SetBuildType(t){this.BuildType=t}get InputTermianl(){return this.Inputs[0].IsConnected?this.Inputs[0].Links[0].In:null}async Calculate(){this.BaseCalculate()}}const oo={class:"node-container"},io={class:"node-terminals left"},ao={class:"node-center"},ro={class:"node-name"},lo={class:"node-terminals right"},uo=Y({__name:"NodeRenderer",props:{Offset:{type:L,required:!0},Zoom:{type:Number,required:!0},Node:{type:Q,required:!0},AllNodes:{type:Array,default:new Array}},setup(o){Wt(N=>({v0a1778c7:c.value,v2ee8d9e9:d.value}));var e=o;const t=O(),s=pe("contextMenu"),n=pe("terminals");Fe(()=>{window.addEventListener("mousemove",ce),window.addEventListener("mouseup",S),ye(()=>{var N=e.Node,$=t.value;if(N.SetSize($.offsetHeight,$.offsetWidth),N.DontMoveOnMount||N.Move(N.Position.X-N.Width/2,N.Position.Y-N.Height/2),t!=null){var U=new ResizeObserver(u);U.observe(t.value)}})});const i=O(new L(0,0)),a=O(!1),l=fe(()=>{var N=me();return N.LockedNode==e.Node}),c=fe(()=>a.value?"grabbing":"default"),d=fe(()=>e.Node.IsSelected?"1":"0"),h=fe(()=>{var N=me(),$=N.LockedNode;return $!=null&&$==e.Node}),_=N=>{var $;($=s.value)==null||$.Open(N)},f=()=>{var N;(N=s.value)==null||N.Close()},u=()=>{var N;n.value!=null&&((N=n.value)==null||N.forEach($=>{$==null||$.SetOffset()}))},m=()=>{var N=me(),$=ge();N.LockedNode==e.Node?N.LockedNode=null:(N.LockedNode=e.Node,e.Node.SetSelected(!0),$.ChangeEvent=!$.ChangeEvent)},y=(N,$,U)=>{var ee,re,Pe,Tt,Bt;if(a.value=!0,i.value.X=N,i.value.Y=$,U)e.Node.SetSelected(!((ee=e.Node)!=null&&ee.IsSelected));else{var se=(re=e.Node.ParentGraph)==null?void 0:re.Nodes.filter(Ne=>Ne.IsSelected);se.length>1?e.Node.IsSelected==!1&&((Pe=e.Node.ParentGraph)==null||Pe.DeselectAll(),e.Node.SetSelected(!0)):((Tt=e.Node.ParentGraph)==null||Tt.DeselectAll(),e.Node.SetSelected(!0))}(Bt=e.Node.ParentGraph)==null||Bt.Nodes.filter(Ne=>Ne.IsSelected).forEach(Ne=>{Ne.SetLastPosition(Ne.Position.X,Ne.Position.Y)})},p=N=>{if(n.value!=null&&n.value.some(se=>se.$el==N.target||se==N.target))return;let $=N.touches[0].clientX,U=N.touches[0].clientY;y($,U,!1)},C=N=>{n.value!=null&&n.value.some($=>$.$el==N.target||$==N.target)||y(N.clientX,N.clientY,N.shiftKey)},S=N=>{a.value=!1},T=N=>{L.Equal(e.Node.LastPosition,e.Node.Position)||W.AddAction(new Xt(e.Node,e.Node.LastPosition,e.Node.Position))},H=N=>{a.value=!1,W.AddAction(new Xt(e.Node,e.Node.LastPosition,e.Node.Position)),console.log("TouchUp")},te=N=>{let $=N.touches[0].clientX,U=N.touches[0].clientY;G($,U)},G=(N,$)=>{var ee;if(a.value){var U=(N-i.value.X)/e.Zoom,se=($-i.value.Y)/e.Zoom;(ee=e.Node.ParentGraph)==null||ee.Nodes.filter(re=>re.IsSelected).forEach(re=>{re.Move(re.LastPosition.X+U,re.LastPosition.Y+se)})}},ce=N=>{G(N.clientX,N.clientY)};return(N,$)=>{const U=J("font-awesome-icon"),se=Ce("tooltip");return w(),V("div",{class:he([{node:!(o.Node instanceof D(Oe))&&!(o.Node instanceof D(nt))&&!(o.Node instanceof D(Ue))},{"node-buffer":o.Node instanceof D(Oe)||o.Node instanceof D(nt)||o.Node instanceof D(Ue)},"disable-user-select",{"not-calculated":o.Node.CalculationState==D(be).NotCalculated&&!(o.Node instanceof D(Oe))},{selected:o.Node.IsSelected},{lockedPreview:l.value},{"node-without-inputs":o.Node.Inputs.length==0},{"node-animation":o.Node.CalculationState==D(be).Calculation}]),style:ms({top:D(e).Node.Position.Y+"px",left:D(e).Node.Position.X+"px"}),ref_key:"rootEl",ref:t,onMousedown:[ue(C,["left"]),ue(_,["right"])],onTouchmove:te,onTouchstart:p,onTouchend:H,onPointerup:ue(T,["left"])},[b("div",oo,[b("div",io,[(w(!0),V(K,null,ve(o.Node.Inputs,ee=>(w(),B(Ft,{ref_for:!0,ref_key:"terminals",ref:n,key:ee.Guid,Term:ee},null,8,["Term"]))),128))]),b("div",ao,[o.Node instanceof D(Oe)?(w(),B(U,{key:0,icon:"fa-solid fa-code-commit"})):o.Node instanceof D(nt)?(w(),V(K,{key:1},[q((w(),V("a",{class:"lock-icon",onClick:$[0]||($[0]=ee=>m())},[h.value?(w(),B(U,{key:0,icon:["fas","lock"]})):(w(),B(U,{key:1,icon:["fas","lock-open"]}))])),[[se,{content:N.$t("tt.lockPreview"),placement:"bottom"}]]),v(U,{icon:"fa-solid fa-code-fork",rotation:"270"})],64)):o.Node instanceof D(Ue)?(w(),B(U,{key:2,icon:"fa-solid fa-floppy-disk"})):(w(),V(K,{key:3},[q((w(),V("a",{class:"lock-icon",onClick:$[1]||($[1]=ee=>m())},[h.value?(w(),B(U,{key:0,icon:["fas","lock"]})):(w(),B(U,{key:1,icon:["fas","lock-open"]}))])),[[se,{content:N.$t("tt.lockPreview"),placement:"bottom"}]]),b("div",ro,M(N.$t(o.Node.Name)),1)],64))]),b("div",lo,[(w(!0),V(K,null,ve(o.Node.Outputs,ee=>(w(),B(Ft,{ref_for:!0,ref_key:"terminals",ref:n,key:ee.Guid,Term:ee},null,8,["Term"]))),128))])]),v(Te,{ref_key:"contextMenu",ref:s,CloseOnAnyClick:!0},{default:I(()=>[v(ae,null,{default:I(()=>[v(U,{icon:["far","copy"]}),R(" "+M(N.$t("tt.copy")),1)]),_:1}),v(ae,{onClick:$[2]||($[2]=ee=>{var re,Pe;(re=o.Node.ParentGraph)==null||re.DeleteNode(o.Node),(Pe=o.Node.ParentGraph)==null||Pe.DeleteSelected(),f()}),style:{color:"var(--vt-c-red)"}},{default:I(()=>[v(U,{icon:["far","trash-can"]}),R(" "+M(N.$t("tt.delete")),1)]),_:1}),$[4]||($[4]=b("hr",null,null,-1)),v(ae,{onClick:$[3]||($[3]=ee=>{m(),f()})},{default:I(()=>[h.value?(w(),B(U,{key:0,icon:["fas","lock"]})):(w(),B(U,{key:1,icon:["fas","lock-open"]})),h.value?(w(),V(K,{key:2},[R("  "+M(N.$t("tt.unlockPreview")),1)],64)):(w(),V(K,{key:3},[R("  "+M(N.$t("tt.lockPreview")),1)],64))]),_:1})]),_:1},512)],38)}}}),co=z(uo,[["__scopeId","data-v-ed40ac53"]]),ho={},fo={class:"canvas",xmlns:"http://www.w3.org/2000/svg"};function po(o,e){return w(),V("svg",fo,[de(o.$slots,"default",{},void 0,!0)])}const vo=z(ho,[["render",po],["__scopeId","data-v-81940268"]]),mo=["points"],go=Y({__name:"LinkRenderer",props:{Link:{type:wt,required:!0}},setup(o){const e=o,t=()=>{e.Link.SetSelected(!0)},s=i=>{var u;var a=e.Link.In,l=e.Link.Out;if(!(a==null||l==null)){var c=new Oe;c.Move(i.offsetX,i.offsetY);var d=(u=a.ParentNode)==null?void 0:u.ParentGraph;if(d!=null){var h=new st;d.DeleteLink(e.Link,!1),h.PushAction(new He(d,e.Link)),d.AddNode(c,!1),h.PushAction(new is(d,c));var _=d.AddLink(a,c.Inputs[0],!1);h.PushAction(new rt(d,_));var f=d.AddLink(c.Outputs[0],l,!1);h.PushAction(new rt(d,f)),W.AddAction(h)}}},n=fe(()=>{var l,c,d,h,_,f;var i=L.Add((c=(l=e.Link.In)==null?void 0:l.ParentNode)==null?void 0:c.Position,(d=e.Link.In)==null?void 0:d.OffsetPosition),a=L.Add((_=(h=e.Link.Out)==null?void 0:h.ParentNode)==null?void 0:_.Position,(f=e.Link.Out)==null?void 0:f.OffsetPosition);return`${i.X},${i.Y} ${i.X+20},${i.Y} ${a.X-20},${a.Y} ${a.X},${a.Y}`});return(i,a)=>(w(),V("polyline",{onClick:t,onDblclick:s,points:n.value,class:he(["line",{selected:e.Link.IsSelected}])},null,42,mo))}}),wo=z(go,[["__scopeId","data-v-1c3db5d0"]]),yo={},_o={class:"tool-bar-container"};function bo(o,e){return w(),V("div",_o,[de(o.$slots,"default",{},void 0,!0)])}const Ct=z(yo,[["render",bo],["__scopeId","data-v-b20ca96b"]]),Vo={},So={class:"tool-bar-body"};function Co(o,e){return w(),V("div",So,[de(o.$slots,"default")])}const Me=z(Vo,[["render",Co]]),xo={key:0,class:"selection-box"},Po={class:"offset-container",ref:"offset_container"},ko=["points"],No={key:1,style:{"pointer-events":"none",height:"100%",width:"100%",padding:"30px",position:"absolute"}},Mo={style:{display:"flex","justify-content":"center","align-items":"center",height:"100%",width:"100%","border-radius":"50px",border:"4px dashed var(--vt-c-black-mute)",color:"var(--vt-c-black-mute)"}},Io={style:{"font-size":"50px","font-weight":"bold","text-shadow":"0px 0px 20px black"}},Oo=Y({props:{MinScale:{type:Number,default:.5},MaxScale:{type:Number,default:2}},data(){return{Offset:new L(0,0),SelectionBox:new bt(0,0,0,0),SelectionBoxVisibility:!1,LastMouse:new L(0,0),LastOffset:new L(0,0),Zoom:1,isDragging:!1,_Graph:new yt,dragStore:lt(),points:"",GridSize:20,isDragOver:!1}},computed:{Nodes:function(){return this._Graph.Nodes},OffsetXStyle:function(){return this.Offset.X+"px"},OffsetYStyle:function(){return this.Offset.Y+"px"},EditorCursor:function(){return this.isDragging?"grabbing":"default"},SelectionBoxX:function(){return this.SelectionBox.X+"px"},SelectionBoxY:function(){return this.SelectionBox.Y+"px"},SelectionBoxHeight:function(){return this.SelectionBox.Height+"px"},SelectionBoxWidth:function(){return this.SelectionBox.Width+"px"},OffsetStyle:function(){var o=this.GridSize/2*this.Zoom;return this.Offset.X-o+"px "+(this.Offset.Y-o)+"px"},ScaleGridStyle:function(){var o=(this.GridSize*this.Zoom).toString();return`${o}px ${o}px`}},created(){window.addEventListener("mousemove",this.OnMouseMove),window.addEventListener("mouseup",this.OnMouseUp)},mounted(){this.$nextTick(()=>{var t;this.$el;var o=((t=this.$parent)==null?void 0:t.$el).parentElement;o!=null&&(o.onkeydown=this.KeysHandler),this._Graph=new yt;var e=me();e.CurrentGraph=this._Graph})},methods:{SaveGraph(){var o=Ge.Serialize(this._Graph),e=JSON.stringify(o);console.log(e);var t=JSON.parse(e);console.log(t);var s=Ge.Deserialize(t);console.log(s)},Undo(){W.Undo()},Redo(){W.Redo()},isChild(o,e){for(var t=e.parentNode;t!=null;){if(t==o)return!0;t=t.parentNode}return!1},dragenter(){this.isDragOver=!0},dragleave(o){var e=this.$el,t=o.target;this.isChild(e,t)||(this.isDragOver=!1)},drop(o){this.isDragOver=!1;var e=lt(),t=e.getNode();if(t!=null){var s=this.$refs.editor,n=s.getBoundingClientRect();if(n!=null){_t.PushState(this._Graph);var i=L.Div(new L(o.clientX-n.x-this.Offset.X,o.clientY-n.y-this.Offset.Y),this.Zoom);t==null||t.Move(i.X,i.Y),this._Graph.AddNode(t)}}},KeysHandler(o){o.key=="Delete"&&(_t.PushState(this._Graph),this._Graph.DeleteSelected())},UpdateOffsetStyle(){var o=this.$refs.offset_container;o.style.left=this.OffsetXStyle,o.style.top=this.OffsetYStyle,o.style.scale=this.Zoom.toString()},OnMouseDownLeft:function(o){this.DrawGhostLine(o),o.target==this.$refs.editor&&(this.LastMouse=new L(o.clientX,o.clientY),this.SelectionBox.X=0,this.SelectionBox.Y=0,this.SelectionBox.Width=0,this.SelectionBox.Height=0,this.SelectionBoxVisibility=!0,this._Graph.DeselectAll())},OnMouseDownMiddle:function(o){this.isDragging=!0,this.LastMouse=new L(o.clientX,o.clientY),this.LastOffset={...this.Offset}},OnMouseMove:function(o){if(this.isDragging){o.preventDefault();var e=o.clientX-this.LastMouse.X,t=o.clientY-this.LastMouse.Y;this.Offset.X=this.LastOffset.X+e,this.Offset.Y=this.LastOffset.Y+t,this.UpdateOffsetStyle()}if(this.SelectionBoxVisibility){o.preventDefault();var s=new L(o.clientX,o.clientY),n=new L(Math.min(this.LastMouse.X,s.X),Math.min(this.LastMouse.Y,s.Y)),i=new L(Math.abs(this.LastMouse.X-s.X),Math.abs(this.LastMouse.Y-s.Y)),a=this.$refs.editor,l=a.getBoundingClientRect();this.SelectionBox.X=n.X-l.left,this.SelectionBox.Y=n.Y-l.top,this.SelectionBox.Width=i.X,this.SelectionBox.Height=i.Y,this._Graph.Nodes.forEach(c=>{var d=new bt(this.Offset.X+c.Position.X*this.Zoom,this.Offset.Y+c.Position.Y*this.Zoom,c.Height*this.Zoom,c.Width*this.Zoom);this.SelectionBox.IntersectsWith(d)?c.SetSelected(!0,!1):c.SetSelected(!1,!1)})}this.DrawGhostLine(o)},OnMouseUp:function(o){this.isDragging=!1,this.SelectionBoxVisibility=!1},OnWheel:function(o){let t=this.$refs.editor.getBoundingClientRect(),s=o.deltaY*.001,n=this.Zoom;this.Zoom=this.Clamp(this.Zoom-s,this.MinScale,this.MaxScale);let i=new L(o.clientX-t.left,o.clientY-t.top),a=(n-this.Zoom)/n;this.Offset=L.Add(this.Offset,L.Mul(L.Sub(i,this.Offset),a)),this.UpdateOffsetStyle()},DisableContextMenu(o){o.preventDefault()},Clamp:function(o,e,t){return Math.min(Math.max(o,e),t)},DrawGhostLine(o){var c;if(this.dragStore.IsDragging){var e=this.$refs.editor,t=e.getBoundingClientRect();if(o.preventDefault(),t!=null){var s=this.dragStore.SourceTerminal,n=L.Add((c=s.ParentNode)==null?void 0:c.Position,s.OffsetPosition),i=L.Div(new L(o.clientX-t.x-this.Offset.X,o.clientY-t.y-this.Offset.Y),this.Zoom),a=s.IsInput?i:n,l=s.IsInput?n:i;this.points=`${a.X},${a.Y} ${a.X+20},${a.Y} ${l.X-20},${l.Y} ${l.X},${l.Y}`}}}}}),$o=Y({...Oo,__name:"GraphRenderer",setup(o){return Wt(e=>({v52f46001:e.EditorCursor,v3902527c:e.SelectionBoxY,v3902527b:e.SelectionBoxX,v7c0fedf8:e.SelectionBoxHeight,v7271c649:e.SelectionBoxWidth,v0c5aa582:e.ScaleGridStyle,v032c5780:e.OffsetStyle})),(e,t)=>{const s=J("font-awesome-icon"),n=Ce("tooltip");return w(),V("div",{class:"graph-renderer dot",ref:"editor",onWheel:t[2]||(t[2]=(...i)=>e.OnWheel&&e.OnWheel(...i)),onMousedown:[t[3]||(t[3]=ue((...i)=>e.OnMouseDownLeft&&e.OnMouseDownLeft(...i),["left"])),t[4]||(t[4]=ue((...i)=>e.OnMouseDownMiddle&&e.OnMouseDownMiddle(...i),["middle"]))],onContextmenu:ue(()=>!1,["prevent","right"]),onDragover:t[5]||(t[5]=ue(()=>{},["prevent"])),onDragenter:t[6]||(t[6]=(...i)=>e.dragenter&&e.dragenter(...i)),onDragleave:t[7]||(t[7]=(...i)=>e.dragleave&&e.dragleave(...i)),onDrop:t[8]||(t[8]=(...i)=>e.drop&&e.drop(...i))},[v(Ct,{class:"top-left"},{default:I(()=>[v(Me,null,{default:I(()=>[q((w(),V("a",null,[v(s,{icon:["far","copy"]})])),[[n,e.$t("tt.copy"),void 0,{bottom:!0}]]),q((w(),V("a",null,[v(s,{icon:["far","paste"]})])),[[n,e.$t("tt.paste"),void 0,{bottom:!0}]]),q((w(),V("a",{class:he([{disabled:!e._Graph.HasSelected}]),style:{color:"var(--vt-c-red)"},onClick:t[0]||(t[0]=i=>e._Graph.DeleteSelected())},[v(s,{icon:["far","trash-can"]})],2)),[[n,e.$t("tt.delete"),void 0,{bottom:!0}]])]),_:1})]),_:1}),v(Ct,{class:"bottom-left"},{default:I(()=>[v(Me,null,{default:I(()=>[b("span",null,[e.Zoom<1?(w(),B(s,{key:0,icon:["fas","magnifying-glass-minus"]})):(w(),B(s,{key:1,icon:["fas","magnifying-glass-plus"]})),R(" "+M((e.Zoom*100).toFixed(0))+"%",1)])]),_:1}),v(Me,null,{default:I(()=>[b("span",null,[v(s,{icon:["fas","up-down-left-right"]}),R(" X: "+M(e.Offset.X.toFixed())+" Y: "+M(e.Offset.Y.toFixed()),1)])]),_:1}),v(Me,null,{default:I(()=>[q((w(),V("a",{onClick:t[1]||(t[1]=i=>{e.Offset.Reset(),e.Zoom=1,e.UpdateOffsetStyle()})},[v(s,{icon:["fas","arrows-rotate"]})])),[[n,e.$t("tt.resetView")]])]),_:1}),v(Me,null,{default:I(()=>[b("span",null,[v(s,{icon:["fas","circle-info"]}),R(" "+M(e.$t("hints.graphLmb")),1)])]),_:1}),v(Me,null,{default:I(()=>[b("span",null,[v(s,{icon:["fas","circle-info"]}),R(" "+M(e.$t("hints.graphWheel")),1)])]),_:1})]),_:1}),e.SelectionBoxVisibility?(w(),V("div",xo)):oe("",!0),b("div",Po,[v(vo,{id:"links-container"},{default:I(()=>[v(Et,{name:"link"},{default:I(()=>[(w(!0),V(K,null,ve(e._Graph.Links,i=>(w(),B(wo,{key:i.Id,Link:i},null,8,["Link"]))),128))]),_:1}),e.dragStore.IsDragging?(w(),V("polyline",{key:0,class:"ghost-line",points:e.points},null,8,ko)):oe("",!0)]),_:1}),v(Et,{name:"delete",tag:"div"},{default:I(()=>[(w(!0),V(K,null,ve(e.Nodes,i=>(w(),B(co,{key:i.Id,Offset:e.Offset,Zoom:e.Zoom,Node:i},null,8,["Offset","Zoom","Node"]))),128))]),_:1})],512),e.isDragOver?(w(),V("div",No,[b("div",Mo,[b("span",Io,M(e.$t("hints.placeHere")),1)])])):oe("",!0)],544)}}}),Ro=z($o,[["__scopeId","data-v-1a402020"]]),Lo={style:{height:"100%",display:"flex","flex-direction":"row"}},Ao={style:{"margin-left":"5px"}},Do={style:{"margin-left":"5px"}},To=Y({__name:"EditorView",setup(o){return(e,t)=>{const s=J("font-awesome-icon");return w(),V("div",Lo,[v(ut,{style:{width:"20%","min-width":"300px"}},{header:I(()=>[v(s,{icon:["fas","list"]}),t[0]||(t[0]=R()),b("span",Ao,M(e.$t("windows.nodesList")),1)]),default:I(()=>[v(In)]),_:1}),v(ut,{style:{width:"80%"}},{header:I(()=>[v(s,{icon:["fas","circle-nodes"]}),t[1]||(t[1]=R()),b("span",Do,M(e.$t("windows.graph")),1)]),default:I(()=>[v(Ro)]),_:1})])}}}),Bo={style:{display:"flex","flex-direction":"row"}},Eo={style:{width:"100%","font-weight":"bold","text-align":"left","margin-left":"35px"}},Go={style:{width:"100%","font-weight":"bold","text-align":"right","margin-right":"10px"}},Uo={style:{width:"10px","margin-right":"10px"}},Xo={key:0,class:"dropdown"},Yo=["onClick"],Fo=Y({__name:"SelectDropdown",props:{options:{type:Array,required:!1,default:[]},title:{type:String,required:!1,default:""},default:{type:String,required:!1,default:null},modelValue:{type:String,default:""},RealtimeChange:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(o,{emit:e}){const t=o,s=O(t.default?t.default:t.options.length>0?t.options[0]:null),n=O(!1);qe(()=>t.modelValue,a=>{s.value=a});const i=()=>{var a=ge();t.RealtimeChange&&(a.ChangeEvent=!a.ChangeEvent)};return(a,l)=>{const c=J("font-awesome-icon");return w(),V("div",{class:"dropdown-head input-element value",tabindex:"0",onBlur:l[1]||(l[1]=d=>n.value=!1),style:{width:"100%",position:"relative"}},[b("div",{onClick:l[0]||(l[0]=d=>n.value=!n.value),style:{height:"100%"}},[b("div",Bo,[b("div",Eo,M(t.title)+M(t.title==""?"":":"),1),b("div",Go,M(s.value),1),b("div",Uo,[n.value?(w(),B(c,{key:1,icon:["fas","angle-up"]})):(w(),B(c,{key:0,icon:["fas","angle-down"]}))])])]),n.value?(w(),V("ul",Xo,[(w(!0),V(K,null,ve(o.options,(d,h)=>(w(),V("li",{class:he({selected:d==s.value}),key:h,onClick:_=>{s.value=d,n.value=!1,a.$emit("update:modelValue",s.value),i()}},M(d),11,Yo))),128))])):oe("",!0)],32)}}}),zo=z(Fo,[["__scopeId","data-v-eb9599f8"]]),Ho=Y({__name:"LangSwitch",setup(o){const e=kt(),t=O("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);const s=c=>{e!=null&&(e.appContext.config.globalProperties.$i18n.locale=c,localStorage.setItem("userLang",c),t.value=c)},n=pe("langContextMenu"),i=O(),a=c=>{var d;(i!=null||i!=null)&&((d=n.value)==null||d.OpenUnder(i.value))};var l=new Map;return l.set("en","English"),l.set("ru","Русский"),(c,d)=>{const h=J("flag");return w(),V(K,null,[b("button",{ref_key:"langSwitchBtn",ref:i,class:"btn disable-user-select",onClick:a},[v(h,{iso:t.value=="en"?"gb":t.value},null,8,["iso"]),R(" "+M(D(l).get(t.value)),1)],512),v(Te,{ref:"langContextMenu"},{default:I(()=>[b("button",{class:"btn btnContextMenuPadding",onClick:d[0]||(d[0]=_=>{var f;s("ru"),(f=n.value)==null||f.Close()})},[v(h,{iso:"ru"}),d[2]||(d[2]=R(" Русский",-1))]),b("button",{class:"btn btnContextMenuPadding",onClick:d[1]||(d[1]=_=>{var f;s("en"),(f=n.value)==null||f.Close()})},[v(h,{iso:"gb"}),d[3]||(d[3]=R(" English",-1))])]),_:1},512)],64)}}}),Wo=Y({__name:"ToggleButton",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const e=Nt(o,"modelValue");return(t,s)=>(w(),V("button",{class:he(["btn",{toggled:e.value}]),onClick:s[0]||(s[0]=n=>e.value=!e.value)},[de(t.$slots,"default",{},void 0,!0)],2))}}),qo=z(Wo,[["__scopeId","data-v-4a53f642"]]),Ko=Y({__name:"ResolutionSwitcher",setup(o){const e=kt(),t=O("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);var s=ge();const n=pe("contextMenu"),i=O(),a=_=>{var u,m,y;if(i!=null||i!=null){var f=(u=i.value)==null?void 0:u.getBoundingClientRect();(m=n.value)==null||m.OpenUnder(i.value),f!=null&&((y=n.value)==null||y.SetWidth(f.width))}},l=["0.5K","1K","2K","4K","8K"],c=[512,1024,2048,4096,8192],d=O(0),h=_=>{d.value=_;var f=s.GetRenderer();f!=null&&(f.ChangeResolution(c[_]),requestAnimationFrame(()=>f==null?void 0:f.Render()))};return(_,f)=>{const u=J("font-awesome-icon"),m=Ce("tooltip");return w(),V(K,null,[q((w(),V("button",{ref_key:"switcher",ref:i,class:"btn disable-user-select",onClick:a},[v(u,{icon:["fas","vector-square"]}),R(" "+M(l[d.value])+" ",1),v(u,{icon:["fas","angle-down"]})])),[[m,_.$t("tt.mesh_resolution"),void 0,{bottom:!0}]]),v(Te,{ref_key:"contextMenu",ref:n},{default:I(()=>[(w(),V(K,null,ve(l,(y,p)=>(w(),V(K,null,[p>2?q((w(),B(ae,{key:0,class:"waringText",Active:p==d.value,onClick:C=>{var S;h(p),(S=n.value)==null||S.Close()}},{default:I(()=>[v(u,{icon:["fas","vector-square"]}),R(" "+M(y),1)]),_:2},1032,["Active","onClick"])),[[m,{content:_.$t("tt.resolutionWarning"),html:!0,distance:15},void 0,{right:!0}]]):(w(),B(ae,{key:1,Active:p==d.value,onClick:C=>{var S;h(p),(S=n.value)==null||S.Close()}},{default:I(()=>[v(u,{icon:["fas","vector-square"]}),R(" "+M(y),1)]),_:2},1032,["Active","onClick"]))],64))),64))]),_:1},512)],64)}}}),Ht=z(Ko,[["__scopeId","data-v-97dd3ce3"]]),Zo={style:{height:"100%",width:"100%",position:"relative"}},jo=["value"],Jo=Y({__name:"ProjectNameEditor",props:ot({modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:ot(["update:modelValue"],["update:modelValue"]),setup(o,{emit:e}){const t=Nt(o,"modelValue"),s=e,n=O(!1),i=O(),a=O(),l=()=>{n.value=!0,ye(()=>{var _;a.value=t.value,(_=i.value)==null||_.focus()})},c=_=>{s("update:modelValue",a.value),n.value=!1},d=_=>{_.target!=null&&(a.value=_.target.value,s("update:modelValue",a.value))},h=_=>{_.key=="Enter"&&(_.target!=null&&(a.value=_.target.value,s("update:modelValue",a.value)),n.value=!1)};return(_,f)=>{const u=J("font-awesome-icon"),m=Ce("tooltip");return w(),V("div",Zo,[n.value?(w(),V("input",{key:0,ref_key:"input",ref:i,onFocusout:c,onInput:d,onKeypress:h,class:"editor",value:t.value},null,40,jo)):q((w(),V("div",{key:1,class:"label",onClick:l},[R(M(t.value),1)])),[[m,_.$t("tt.clickForEdit"),void 0,{bottom:!0}]]),v(u,{class:"icon",icon:["fas","pen"]})])}}}),Qo=z(Jo,[["__scopeId","data-v-7b27f16a"]]),ei={class:"modal-container"},ti={class:"modal-header"},si={class:"title"},ni={key:0,class:"closeButton"},oi={class:"modal-slot"},ii={class:"modal-footer"},ai=Y({__name:"Modal",props:{closeButton:{type:Boolean,default:!0}},setup(o,{expose:e}){const t=o,s=O(!1);return e({Open:()=>{s.value=!0},Close:()=>{s.value=!1}}),(a,l)=>{const c=J("font-awesome-icon");return s.value?(w(),V("div",{key:0,class:"modal-back",onClick:l[2]||(l[2]=d=>s.value=!1)},[b("div",{class:"modal-main",onClick:l[1]||(l[1]=ue(()=>{},["stop"]))},[b("div",ei,[b("div",ti,[b("div",si,[de(a.$slots,"title",{},void 0,!0)]),l[3]||(l[3]=b("div",{style:{width:"100%"}},null,-1)),t.closeButton?(w(),V("div",ni,[b("button",{class:"btn",style:{margin:"0"},onClick:l[0]||(l[0]=d=>s.value=!1)},[v(c,{icon:"fa-solid fa-xmark"})])])):oe("",!0)]),b("div",oi,[de(a.$slots,"default",{},void 0,!0)]),b("div",ii,[de(a.$slots,"footer",{},void 0,!0)])])])])):oe("",!0)}}}),Dt=z(ai,[["__scopeId","data-v-56059a2a"]]),ri={style:{display:"flex"}},li={style:{"margin-left":"0"},class:"btn btn-green footer-btn"},ui=Y({__name:"SettingsModal",setup(o,{expose:e}){const t=pe("settingsModal");return e({Open:()=>{var n;(n=t.value)==null||n.Open()}}),(n,i)=>{const a=J("font-awesome-icon");return w(),B(Dt,{ref_key:"settingsModal",ref:t},{title:I(()=>[v(a,{icon:["fas","gear"]}),R(" "+M(n.$t("tt.settings")),1)]),footer:I(()=>[b("div",ri,[b("button",li,[v(a,{icon:["fas","floppy-disk"]}),R(" "+M(n.$t("tt.saveSettings")),1)]),b("button",{class:"btn btn-red footer-btn",onClick:i[0]||(i[0]=l=>{var c;return(c=t.value)==null?void 0:c.Close()})},[v(a,{icon:"fa-solid fa-circle-xmark"}),R(" "+M(n.$t("tt.cancel")),1)])])]),_:1},512)}}}),di={class:"container"},ci={class:"node-name"},hi={class:"file-name"},fi=Y({__name:"ExportInput",props:{node:{type:Ue,required:!0}},setup(o){var d,h,_;const{t:e}=gs({useScope:"global"});var t=o;const s=pe("contextMenu"),n=O(),i=f=>{var u;console.log("Open"),(n!=null||n!=null)&&((u=s.value)==null||u.OpenUnder(n.value))},a=f=>{var u;t.node.SetBuildType(f),(u=s.value)==null||u.Close()},l=new Map([[le.EXR16,"EXR 16 bit"],[le.EXR32,"EXR 32 bit"],[le.PNG8,"PNG 8 bit"],[le.PNG16,"PNG 16 bit"],[le.RAW16,"RAW 16 bit float"],[le.RAW32,"RAW 32 bit float"]]),c=O(t.node.InputTermianl!=null?(h=(d=t.node.InputTermianl)==null?void 0:d.ParentNode)==null?void 0:h.Name:"");return(t.node.ExportFileName===""||t.node.ExportFileName==null)&&t.node.SetFileName(e(c.value).replace(" ","_")+"_"+((_=t.node.InputTermianl)==null?void 0:_.Name)),(f,u)=>{var y;const m=J("font-awesome-icon");return w(),V("div",di,[b("div",ci,[R(M(f.$t(c.value))+" ",1),v(m,{icon:"fa-solid fa-arrow-right-long"}),R(" "+M((y=D(t).node.InputTermianl)==null?void 0:y.Name)+":",1)]),b("div",hi,[q(b("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=p=>D(t).node.ExportFileName=p)},null,512),[[ws,D(t).node.ExportFileName]])]),b("button",{onClick:i,ref_key:"contextMenuButton",ref:n,class:"format"},[R(M(D(l).get(D(t).node.BuildType))+" ",1),v(m,{icon:["fas","angle-down"]})],512),v(Te,{ref_key:"contextMenu",ref:s},{default:I(()=>[(w(!0),V(K,null,ve(D(l),p=>(w(),B(ae,{Active:p[0]==D(t).node.BuildType,onClick:C=>a(p[0])},{default:I(()=>[R(M(p[1]),1)]),_:2},1032,["Active","onClick"]))),256))]),_:1},512)])}}}),pi=z(fi,[["__scopeId","data-v-8164d87c"]]);class vi{static DownloadArray(e,t){const s=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(n)},100)}static DownloadBlob(e,t){const s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),URL.revokeObjectURL(s)},100)}}const mi={class:"container"},gi={ref:"contextMenuButton",class:"format"},wi=Y({__name:"ComboBox",setup(o){return(e,t)=>{const s=J("font-awesome-icon");return w(),V("div",mi,[t[1]||(t[1]=b("div",{class:"node-name"},"some text:",-1)),b("button",gi,[t[0]||(t[0]=R("some value ",-1)),v(s,{icon:["fas","angle-down"]})],512),v(Te,{ref:"contextMenu"},{default:I(()=>[v(ae)]),_:1},512)])}}}),tt=z(wi,[["__scopeId","data-v-41f710d9"]]),yi={class:"tabs-container"},_i={class:"tabs"},bi={key:0,class:"input-container"},Vi={key:1,class:"input-container"},Si={style:{display:"flex"}},Ci=["disabled"],xi=Y({__name:"BuildModal",setup(o,{expose:e}){const t=pe("buildModal"),s=()=>{var u;(u=t.value)==null||u.Open(),l()},n=O(0);var i=me(),a=O();const l=()=>{i.CurrentGraph!=null&&(a.value=Re(i.CurrentGraph.Nodes).where(u=>u instanceof Ue&&u.InputTermianl!=null).toArray())};var c=["0.5K (512x512)","1K   (1024x1024)","2K   (2048x2048)","4K   (4096x4096)","8K   (8192x8192)"];const d=new Map([[le.PNG8,".png"],[le.PNG16,".png"],[le.RAW16,".raw"],[le.RAW32,".raw"],[le.EXR16,".exr"],[le.EXR32,".exr"],[le.TIFF16,".tiff"],[le.TIFF32,".tiff"]]),h=O(4096),_=O(!1),f=async()=>{var u=new ys;_.value=!0;var m=ge(),y=m.GetRenderer();if(y!=null){var p=new no(y.GPURenderer,h.value);if(a.value!=null&&a.value.length!=0){for(var C of a.value){var S=C,T=await p.Build(S);u.file(S.ExportFileName+d.get(S.BuildType),T)}var H=await u.generateAsync({type:"blob"});vi.DownloadBlob(H,"build.zip")}}_.value=!1};return e({Open:s}),(u,m)=>{const y=J("font-awesome-icon");return w(),B(Dt,{ref:"buildModal"},{title:I(()=>[v(y,{icon:"fa-solid fa-hammer"}),R(" "+M(u.$t("tt.buildSettings")),1)]),footer:I(()=>[b("div",Si,[b("button",{style:{"margin-left":"0"},class:"btn btn-green footer-btn",onClick:m[5]||(m[5]=p=>f()),disabled:_.value},[v(y,{icon:"fa-solid fa-hammer"}),R(" "+M(u.$t("tt.build")),1)],8,Ci),b("button",{class:"btn btn-red footer-btn",onClick:m[6]||(m[6]=p=>{var C;return(C=t.value)==null?void 0:C.Close()})},[v(y,{icon:"fa-solid fa-circle-xmark"}),R(" "+M(u.$t("tt.cancel")),1)])])]),default:I(()=>[b("div",yi,[b("div",_i,[b("button",{onClick:m[0]||(m[0]=p=>n.value=0),class:he(["tab-item",{"tab-item-active":n.value==0}])},[v(y,{icon:["fas","vector-square"]}),R(" "+M(u.$t("buildModal.resolution")),1)],2),b("button",{onClick:m[1]||(m[1]=p=>n.value=1),class:he(["tab-item",{"tab-item-active":n.value==1}]),disabled:""},[v(y,{icon:"fa-solid fa-border-all"}),R(" "+M(u.$t("buildModal.tiles"))+" ",1),v(y,{icon:"fa-solid fa-triangle-exclamation"})],2),b("button",{onClick:m[2]||(m[2]=p=>n.value=2),class:he(["tab-item",{"tab-item-active":n.value==2}])},[v(y,{icon:"fa-solid fa-mountain"}),R(" "+M(u.$t("buildModal.terrain")),1)],2),b("button",{onClick:m[3]||(m[3]=p=>n.value=3),class:he(["tab-item",{"tab-item-active":n.value==3}])},[v(y,{icon:"fa-solid fa-hammer"}),R(" "+M(u.$t("buildModal.build")),1)],2),b("button",{onClick:m[4]||(m[4]=p=>n.value=4),class:he(["tab-item",{"tab-item-active":n.value==4}])},[v(y,{icon:"fa-solid fa-circle-nodes"}),R(" "+M(u.$t("buildModal.nodes")),1)],2)]),n.value==0?(w(),V("div",bi,[v(tt,{options:D(c)},null,8,["options"]),v(tt,{options:D(c)},null,8,["options"]),v(tt,{options:D(c)},null,8,["options"]),v(tt,{options:D(c)},null,8,["options"])])):oe("",!0),n.value==4?(w(),V("div",Vi,[(w(!0),V(K,null,ve(D(a),p=>(w(),B(pi,{node:p},null,8,["node"]))),256))])):oe("",!0)]),_.value?(w(),B(ls,{key:0,style:{scale:"3"}})):oe("",!0)]),_:1},512)}}}),Pi=z(xi,[["__scopeId","data-v-e5b2dcbf"]]),ki={style:{display:"flex"}},Ni={style:{"margin-left":"0"},class:"btn btn-green footer-btn"},Mi=Y({__name:"OpenModal",setup(o,{expose:e}){const t=pe("openModal");return e({Open:()=>{var n;(n=t.value)==null||n.Open()}}),(n,i)=>{const a=J("font-awesome-icon");return w(),B(Dt,{ref_key:"openModal",ref:t},{title:I(()=>[v(a,{icon:["fas","folder-open"]}),R(" "+M(n.$t("tt.load")),1)]),footer:I(()=>[b("div",ki,[b("button",Ni,[v(a,{icon:["fas","folder-open"]}),R(" "+M(n.$t("tt.load")),1)]),b("button",{class:"btn btn-red footer-btn",onClick:i[0]||(i[0]=l=>{var c;return(c=t.value)==null?void 0:c.Close()})},[v(a,{icon:"fa-solid fa-circle-xmark"}),R(" "+M(n.$t("tt.cancel")),1)])])]),_:1},512)}}}),Ii={style:{"margin-left":"auto",right:"0px",height:"100%","white-space":"nowrap",overflow:"hidden"}},Oi=["disabled"],$i=["disabled"],Ri={class:"btn"},Li=["disabled"],Ai=["disabled"],Di={class:"btn"},Ti=550,Bi=Y({__name:"ActionButtonsBar",setup(o){const e=O(),t=pe("contextMenu"),s=O(),n=O(),i=me(),a=pe("settingsModal"),l=pe("buildModal"),c=pe("openModal"),d=f=>{var u;(s!=null||s!=null)&&((u=t.value)==null||u.OpenUnder(s.value))},h=()=>{var m;var f=(m=e.value)==null?void 0:m.getBoundingClientRect();if(f!=null){var u=f==null?void 0:f.width;u!=null&&u<Ti?n.value=!0:n.value=!1}};Fe(()=>{ye(()=>{h(),window.addEventListener("resize",()=>{h()})})});const _=()=>{if(i.CurrentGraph!=null){var f=Ge.Serialize(i.CurrentGraph),u=JSON.stringify(f),m=document.createElement("a"),y=new Blob([u],{type:"text/plain"});m.href=URL.createObjectURL(y),m.download="untitled.json",m.click()}};return(f,u)=>{const m=J("font-awesome-icon"),y=J("font-awesome-layers"),p=Ce("tooltip");return w(),V(K,null,[b("div",{ref_key:"menuContainer",ref:e,style:{display:"flex",height:"100%",width:"100%","white-space":"nowrap",overflow:"hidden"}},[b("div",Ii,[n.value?(w(),V(K,{key:0},[v(Ht),u[18]||(u[18]=b("div",{class:"separator"},null,-1)),q((w(),V("button",{onClick:d,ref_key:"contextMenuButton",ref:s,class:"btn"},[v(m,{icon:["fas","fa-bars"]})])),[[p,f.$t("tt.menu"),void 0,{bottom:!0}]]),v(Te,{ref_key:"contextMenu",ref:t},{default:I(()=>[v(ae,null,{default:I(()=>[v(m,{icon:["fas","file"]}),R(" "+M(f.$t("tt.new")),1)]),_:1}),v(ae,null,{default:I(()=>[v(m,{icon:["fas","floppy-disk"]}),R(" "+M(f.$t("tt.save")),1)]),_:1}),v(ae,{onClick:u[0]||(u[0]=C=>{var S,T;(S=c.value)==null||S.Open(),(T=t.value)==null||T.Close()})},{default:I(()=>[v(m,{icon:["fas","folder-open"]}),R(" "+M(f.$t("tt.load")),1)]),_:1}),u[14]||(u[14]=b("hr",null,null,-1)),v(ae,{disabled:!D(W).CanUndo.value,onClick:u[1]||(u[1]=C=>{var S;D(W).Undo(),(S=t.value)==null||S.Close()})},{default:I(()=>[v(m,{icon:["fas","rotate-left"]}),R(" "+M(f.$t("tt.undo")),1)]),_:1},8,["disabled"]),v(ae,{disabled:!D(W).CanRedo.value,onClick:u[2]||(u[2]=C=>{var S;D(W).Redo(),(S=t.value)==null||S.Close()})},{default:I(()=>[v(m,{icon:["fas","rotate-right"]}),R(" "+M(f.$t("tt.redo")),1)]),_:1},8,["disabled"]),u[15]||(u[15]=b("hr",null,null,-1)),v(ae,{onClick:u[3]||(u[3]=C=>{var S,T;(S=a.value)==null||S.Open(),(T=t.value)==null||T.Close()})},{default:I(()=>[v(m,{icon:["fas","gear"]}),R(" "+M(f.$t("tt.settings")),1)]),_:1}),u[16]||(u[16]=b("hr",null,null,-1)),v(ae,{onClick:u[4]||(u[4]=C=>{var S,T;(S=l.value)==null||S.Open(),(T=t.value)==null||T.Close()})},{default:I(()=>[v(y,{style:{width:"20px"}},{default:I(()=>[v(m,{icon:"fa-solid fa-hammer"}),v(m,{icon:["fas","gear"],transform:"shrink-8 left-8 up-6"})]),_:1}),R(" "+M(f.$t("tt.buildSettings")),1)]),_:1}),v(ae,{onClick:u[5]||(u[5]=C=>{var S;return(S=t.value)==null?void 0:S.Close()})},{default:I(()=>[v(m,{icon:"fa-solid fa-hammer"}),R(" "+M(f.$t("tt.build")),1)]),_:1}),u[17]||(u[17]=b("hr",null,null,-1)),v(ae,null,{default:I(()=>[v(m,{icon:["fas","expand"]}),R(" "+M(f.$t("tt.fullscreen")),1)]),_:1})]),_:1},512),u[19]||(u[19]=b("div",{class:"separator"},null,-1)),q((w(),V("button",{disabled:!D(W).CanUndo.value,onClick:u[6]||(u[6]=C=>{D(W).Undo()}),class:"btn"},[v(m,{icon:["fas","rotate-left"]})],8,Oi)),[[p,f.$t("tt.undo"),void 0,{bottom:!0}]]),q((w(),V("button",{disabled:!D(W).CanRedo.value,onClick:u[7]||(u[7]=C=>{D(W).Redo()}),class:"btn"},[v(m,{icon:["fas","rotate-right"]})],8,$i)),[[p,f.$t("tt.redo"),void 0,{bottom:!0}]])],64)):(w(),V(K,{key:1},[v(Ht),u[20]||(u[20]=b("div",{class:"separator"},null,-1)),q((w(),V("button",Ri,[v(m,{icon:["fas","file"]})])),[[p,f.$t("tt.new"),void 0,{bottom:!0}]]),q((w(),V("button",{onClick:u[8]||(u[8]=C=>_()),class:"btn"},[v(m,{icon:["fas","floppy-disk"]})])),[[p,f.$t("tt.save"),void 0,{bottom:!0}]]),q((w(),V("button",{onClick:u[9]||(u[9]=C=>{var S;return(S=c.value)==null?void 0:S.Open()}),class:"btn"},[v(m,{icon:["fas","folder-open"]})])),[[p,f.$t("tt.load"),void 0,{bottom:!0}]]),u[21]||(u[21]=b("div",{class:"separator"},null,-1)),q((w(),V("button",{disabled:!D(W).CanUndo.value,onClick:u[10]||(u[10]=C=>{D(W).Undo()}),class:"btn"},[v(m,{icon:["fas","rotate-left"]})],8,Li)),[[p,f.$t("tt.undo"),void 0,{bottom:!0}]]),q((w(),V("button",{disabled:!D(W).CanRedo.value,onClick:u[11]||(u[11]=C=>{D(W).Redo()}),class:"btn"},[v(m,{icon:["fas","rotate-right"]})],8,Ai)),[[p,f.$t("tt.redo"),void 0,{bottom:!0}]]),u[22]||(u[22]=b("div",{class:"separator"},null,-1)),q((w(),V("button",{onClick:u[12]||(u[12]=C=>{var S;return(S=a.value)==null?void 0:S.Open()}),class:"btn"},[v(m,{icon:["fas","gear"]})])),[[p,f.$t("tt.settings"),void 0,{bottom:!0}]]),u[23]||(u[23]=b("div",{class:"separator"},null,-1)),q((w(),V("button",{onClick:u[13]||(u[13]=C=>{var S;return(S=l.value)==null?void 0:S.Open()}),class:"btn"},[v(y,{style:{width:"20px"}},{default:I(()=>[v(m,{icon:"fa-solid fa-hammer"}),v(m,{icon:["fas","gear"],transform:"shrink-8 left-8 up-6"})]),_:1})])),[[p,f.$t("tt.buildSettings"),void 0,{bottom:!0}]]),q((w(),V("button",Di,[v(m,{style:{color:"var(--vt-c-green)"},icon:"fa-solid fa-hammer"})])),[[p,f.$t("tt.build"),void 0,{bottom:!0}]]),u[24]||(u[24]=b("div",{class:"separator"},null,-1)),q((w(),B(qo,null,{default:I(()=>[v(m,{icon:["fas","expand"]})]),_:1})),[[p,f.$t("tt.fullscreen"),void 0,{bottom:!0}]])],64))])],512),v(ui,{ref_key:"settingsModal",ref:a},null,512),v(Pi,{ref_key:"buildModal",ref:l},null,512),v(Mi,{ref_key:"openModal",ref:c},null,512)],64)}}}),Ei=z(Bi,[["__scopeId","data-v-dea749bc"]]),Gi={class:"disable-user-select left-section",style:{display:"flex","flex-direction":"row"}},Ui={class:"logo disable-user-select",style:{"text-transform":"uppercase"}},Xi={class:"padding"},Yi={class:"middle-actions",style:{}},Fi={style:{display:"flex","flex-direction":"row"}},zi=Y({__name:"MainMenuBar",setup(o){const e=O(!1);qe(e,(s,n)=>{s?document.documentElement.requestFullscreen():document.exitFullscreen()});const t=O("Untitled");return(s,n)=>(w(),V("div",{class:"main",onContextmenu:n[1]||(n[1]=ue(()=>{},["prevent"]))},[b("div",Gi,[b("div",Ui,M(s.$t("logo")),1),v(Ei)]),b("div",Xi,[b("div",Yi,[v(Qo,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value=i)},null,8,["modelValue"])])]),b("div",Fi,[v(Ho)])],32))}}),Hi=z(zi,[["__scopeId","data-v-58738f50"]]),Wi={style:{display:"flex"}},qi=["value","placeholder"],Ki=Y({__name:"ContextMenuInput",props:ot({Active:{type:Boolean,default:!1},Placeholder:{type:String,default:""},modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:ot(["update:modelValue"],["update:modelValue"]),setup(o,{emit:e}){var t=o;const s=Nt(o,"modelValue"),n=e,i=O(),a=d=>{n("update:modelValue",i.value)},l=d=>{d.target!=null&&(i.value=d.target.value,n("update:modelValue",i.value))},c=d=>{d.key=="Enter"&&d.target!=null&&(i.value=d.target.value,n("update:modelValue",i.value))};return(d,h)=>(w(),V("div",Wi,[b("input",{onFocusout:a,onInput:l,onKeypress:c,value:s.value,class:he([{active:o.Active}]),placeholder:D(t).Placeholder,style:{padding:"5px"}},null,42,qi),de(d.$slots,"default",{},void 0,!0)]))}}),Zi=z(Ki,[["__scopeId","data-v-a59750ae"]]),ji={ref:"inputRange",class:"input-range"},Ji=["value"],Qi={class:"title"},ea={class:"valueText"},ta=Y({props:{Min:Number,Max:Number,Suffix:String,Title:String,RealtimeChange:{type:Boolean,default:!0},Step:{type:Number,default:0},modelValue:{type:Number,default:0}},emits:["update:modelValue"],data(){return{IsDragging:!1,Value:0,lastPosition:new L(0,0),lastValue:0,IsInputVisible:!1,moveDistance:0}},created(){document.addEventListener("mousemove",this.OnMouseMove),document.addEventListener("mouseup",this.OnMouseUp),this.Value=this.modelValue},watch:{modelValue(o,e){this.Value=o}},methods:{ClickValue(o){this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+o,this.Min,this.Max):this.Value=this.Clamp(this.Value+(o>0?this.Step:-this.Step),this.Min,this.Max):this.Step==0?this.Value+=o:this.Value+=o>0?this.Step:-this.Step,this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnInput(o){this.Value=Number(o.target.value),this.Min!=null&&this.Max!=null&&(this.Value=this.Clamp(this.Value,this.Min,this.Max)),this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnMouseDown(o){this.IsInputVisible||(this.$el.requestPointerLock(),this.IsDragging=!0,this.lastPosition=new L(o.clientX,o.clientY),this.lastValue=this.Value,this.moveDistance=0)},OnMouseMove(o){this.IsDragging&&(this.moveDistance+=o.movementX,this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+o.movementX/(o.shiftKey?25:50),this.Min,this.Max):o.movementX!=0&&Math.abs(this.moveDistance)>=(o.shiftKey?25:50)&&(this.moveDistance=0,this.Value=this.Clamp(this.Value+(o.movementX>0?this.Step:-this.Step),this.Min,this.Max)):this.Step==0?this.Value+=o.movementX/(o.shiftKey?25:50):o.movementX!=0&&Math.abs(this.moveDistance)>=(o.shiftKey?25:50)&&(this.moveDistance=0,this.Value+=o.movementX>0?this.Step:-this.Step),this.$emit("update:modelValue",this.Value),this.UpdateEvent())},OnMouseUp(o){var e=new L(o.clientX,o.clientY);e.X==this.lastPosition.X&&e.Y==this.lastPosition.Y&&this.Value==this.lastValue&&(this.IsInputVisible=!0,this.$nextTick(()=>{var t=this.$refs.input;t.focus(),t.select()})),this.IsDragging=!1,document.exitPointerLock()},UpdateEvent(){var o=ge();this.RealtimeChange&&(o.ChangeEvent=!o.ChangeEvent)},validate(o){o.key=="Enter"&&o.target.blur();var e=/[0-9-]|\./;e.test(o.key)||o.preventDefault()},Clamp(o,e,t){return Math.min(Math.max(o,e),t)}}}),sa=Y({...ta,__name:"InputRange",setup(o){return(e,t)=>{const s=J("font-awesome-icon");return w(),V("div",ji,[b("div",{class:"button",onClick:t[0]||(t[0]=n=>e.ClickValue(-.1))},[v(s,{icon:["fas","caret-left"]})]),b("div",{class:"value",onMousedown:t[4]||(t[4]=ue((...n)=>e.OnMouseDown&&e.OnMouseDown(...n),["left"]))},[e.IsInputVisible?(w(),V("input",{key:0,onKeypress:t[1]||(t[1]=(...n)=>e.validate&&e.validate(...n)),ref:"input",class:"input-element",value:e.modelValue,onInput:t[2]||(t[2]=(...n)=>e.OnInput&&e.OnInput(...n)),onBlur:t[3]||(t[3]=n=>e.IsInputVisible=!1)},null,40,Ji)):(w(),V(K,{key:1},[b("div",Qi,M(e.Title)+": ",1),b("div",ea,M(Number(e.Value.toFixed(4)))+" "+M(e.Suffix),1)],64))],32),b("div",{class:"button",onClick:t[5]||(t[5]=n=>e.ClickValue(.1))},[v(s,{icon:["fas","caret-right"]})])],512)}}}),na=z(sa,[["__scopeId","data-v-5ba96ddd"]]);class vt{constructor(){r(this,"Name");r(this,"Node");r(this,"Values")}static SavePreset(e){var t=localStorage.getItem("presets");if(t!=null){var s=JSON.parse(t),n=Re(s).firstOrDefault(a=>a.Node==e.Node&&a.Name==e.Name);if(n!=null){var i=s.indexOf(n);s.splice(i,1)}s.push(e),localStorage.setItem("presets",JSON.stringify(s))}else{var s=new Array;s.push(e),localStorage.setItem("presets",JSON.stringify(s))}}static GetPresets(){var e=localStorage.getItem("presets");return e!=null?JSON.parse(e):new Array}}const oa={class:"properties"},ia={key:0,class:"not-selected"},aa={class:"header"},ra={style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},la={class:"buttons",style:{display:"flex","font-weight":"bold"}},ua={key:0},da={key:0,style:{margin:"0px 10px"}},ca={class:"input-group",style:{width:"100%",padding:"0px"}},ha={key:1,style:{padding:"10px"}},fa={class:"notice"},pa=Y({__name:"PropertiesView",setup(o){const e=me(),t=fe(()=>e.SelectedNode),s=fe(()=>e.SelectedNode==null||e.SelectedNode instanceof Oe),n=O(),i=fe(()=>{var y;return l((y=t.value)==null?void 0:y.Properties)}),a=()=>{if(e.SelectedNode!=null&&e.SelectedNode!=null&&e.SelectedNode){for(var y of e.SelectedNode.Properties)y.Reset();var p=ge();p.ChangeEvent=!p.ChangeEvent}};var l=y=>{var p=new Map;return y==null||y.length==0||y.forEach(C=>{var S;p.has(C.Category)||p.set(C.Category,new Array),(S=p.get(C.Category))==null||S.push(C)}),p};const c=pe("presetsContextMenu"),d=O(),h=y=>{var T;if(d!=null||d!=null){if(t.value!=null){var p=t.value.Name,C=vt.GetPresets(),S=Re(C).where(H=>H.Node==p).toArray();n.value=S}(T=c.value)==null||T.OpenUnder(d.value)}},_=O(""),f=()=>{var S,T;if(t.value!=null&&!(_.value==""||_.value==null)){var y=t.value.Properties,p=new vt,C=new Array;y.forEach(H=>{C.push(H.Value)}),p.Name=_.value,p.Node=t.value.Name,p.Values=C,(S=n.value)==null||S.push(p),vt.SavePreset(p),(T=c.value)==null||T.Close(),_.value=""}},u=y=>{var p;s.value||(t.value.Properties.forEach((C,S)=>{C.Value=y.Values[S]}),(p=c.value)==null||p.Close(),m())},m=()=>{var y=ge();t.value.IsRealtimeUpdate&&(y.ChangeEvent=!y.ChangeEvent)};return(y,p)=>{var T;const C=J("font-awesome-icon"),S=Ce("tooltip");return w(),V("div",oa,[s.value?(w(),V("div",ia,[v(C,{icon:["fas","sliders"]})])):oe("",!0),s.value?oe("",!0):(w(),V(K,{key:1},[b("div",aa,[b("div",ra,M(y.$t((T=t.value)==null?void 0:T.Name)),1),b("div",la,[q((w(),V("button",{ref_key:"presetsButton",ref:d,onClick:h,class:"btn"},[v(C,{icon:["fas","sliders"]})])),[[S,y.$t("tt.presets"),void 0,{bottom:!0}]]),q((w(),V("button",{class:"btn",onClick:a},[v(C,{icon:["fas","arrows-rotate"]})])),[[S,y.$t("tt.resetParams"),void 0,{bottom:!0}]]),v(Te,{ref_key:"presetsContextMenu",ref:c},{default:I(()=>{var H;return[(w(!0),V(K,null,ve(n.value,te=>(w(),B(ae,{onClick:G=>u(te)},{default:I(()=>[v(C,{icon:["fas","sliders"]}),R(" "+M(te.Name),1)]),_:2},1032,["onClick"]))),256)),((H=n.value)==null?void 0:H.length)>0?(w(),V("hr",ua)):oe("",!0),v(Zi,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=te=>_.value=te),Placeholder:"New preset name..."},{default:I(()=>[b("button",{onClick:f,class:"btn",style:{padding:"6px"}},[v(C,{icon:"fa-solid fa-circle-plus"})])]),_:1},8,["modelValue"])]}),_:1},512)])]),t.value.Name?(w(),V("hr",da)):oe("",!0),(w(!0),V(K,null,ve(i.value,([H,te])=>(w(),B(as,{style:{"background-color":"transparent",padding:"0px"}},{header:I(()=>[R(M(H),1)]),default:I(()=>[b("div",ca,[(w(!0),V(K,null,ve(te,G=>(w(),V(K,null,[typeof G.Value=="number"?(w(),B(na,{key:0,modelValue:G.Value,"onUpdate:modelValue":ce=>G.Value=ce,Min:G.Min,Max:G.Max,Step:G.Step,Suffix:G.Suffix,Title:G.Name},null,8,["modelValue","onUpdate:modelValue","Min","Max","Step","Suffix","Title"])):oe("",!0),G.valueList!=null?(w(),B(zo,{key:1,modelValue:G.Value,"onUpdate:modelValue":ce=>G.Value=ce,default:G.Value,title:G.Name,options:G.valueList},null,8,["modelValue","onUpdate:modelValue","default","title","options"])):oe("",!0)],64))),256))])]),_:2},1024))),256)),t.value.IsRealtimeUpdate==!1?(w(),V("div",ha,[p[2]||(p[2]=b("button",{class:"btn apply-btn"}," Apply changes ",-1)),b("div",fa,[v(C,{icon:["fas","circle-exclamation"]}),p[1]||(p[1]=R(' This node performs a heavy operation, so the update occurs when you click the "Apply Changes" button and is cached. ',-1))])])):oe("",!0)],64))])}}}),va=z(pa,[["__scopeId","data-v-10cf94de"]]);class ma{constructor(){r(this,"GridMaterial");r(this,"GridMesh");const e=g(.5).toVar(),t=g(5).toVar(),s=g(1*window.devicePixelRatio).toVar(),n=g(500).toVar(),i=g(200).toVar(),a=Ze(.2,.2,.2,.2).toVar(),l=Ze(.05,.05,.05,.2).toVar(),c=Ds,d=Ts,h=A(([$,U])=>{const se=gt($,U),ee=Xe(j(Se(j(se,.5)),.5)),re=gt(ee,es(se));return Ve(re.x,re.y)}),_=h(c.xz,e),f=h(c.xz,t),u=j(1,ze(0,s,_)),m=j(1,ze(0,s,f)),y=j(c,d),p=At(y),C=ze(g(n),g(0),p),S=ze(g(i),g(0),p),T=ie(a,ie(u,S)).toVar(),H=ie(l,ie(m,C)).toVar(),te=Bs(H,T),G=new ts;G.colorNode=te,G.transparent=!0,G.side=Je,G.lights=!1;const ce=new ct(1e3,1e3,1,1);ce.rotateX(-Math.PI/2);const N=new je(ce,G);this.GridMesh=N,this.GridMaterial=G}}class ga{constructor(){r(this,"Mesh");const e=A(([i,a,l])=>{const c=x(i.x,i.y).toVar(),d=x(Xe(c.mul(2).sub(1)).sub(x(a,l))).toVar();return d.assign(g(1).sub(d.div(es(d)))),Es(Ve(d.x,d.y))});var t=new Ot({color:"#fff",transparent:!0,side:Je});t.colorNode=A(()=>{const i=e(Ie(),1,1).toVar(),a=e(Ie(),.9,1).toVar(),l=e(Ie(),1,.9).toVar(),c=e(Ie(),.98,.98).toVar(),d=De(0,1,i.sub(a).sub(l).sub(c)).toVar();return Ze(.8,.8,.8,d)})();var s=new ct(1,1,1,1);s.rotateX(-Math.PI/2);var n=new je(s,t);n.castShadow=!1,n.receiveShadow=!1,n.scale.set(10,1,10),n.position.set(0,.005,0),this.Mesh=n}}class wa{static async Generate(e=1,t=1,s=1,n=1){var i=new Gs;const a=e/2,l=t/2,c=Math.floor(s),d=Math.floor(n),h=c+1,_=d+1,f=e/c,u=t/d,m=h*_,y=c*d*6,p=m*2,C=new Float32Array(m*3),S=new Float32Array(m*3),T=new Float32Array(p),H=new Uint32Array(y);let te=0,G=0,ce=0;for(let $=0;$<_;$++){const U=$*u-l;for(let se=0;se<h;se++){const ee=se*f-a;C[te]=ee,C[te+1]=-U,C[te+2]=0,te+=3,S[ce]=0,S[ce+1]=0,S[ce+2]=1,ce+=3,T[G]=se/c,T[G+1]=1-$/d,G+=2}$%1e4===0&&await new Promise(se=>setTimeout(se,0))}let N=0;for(let $=0;$<d;$++){for(let U=0;U<c;U++){const se=U+h*$,ee=U+h*($+1),re=U+1+h*($+1),Pe=U+1+h*$;H[N++]=se,H[N++]=ee,H[N++]=Pe,H[N++]=ee,H[N++]=re,H[N++]=Pe}$%1e4===0&&await new Promise(U=>setTimeout(U,0))}return i.setIndex(new Qe(H,1)),i.setAttribute("position",new Qe(C,3)),i.setAttribute("normal",new Qe(S,3)),i.setAttribute("uv",new Qe(T,2)),i}}class ya{constructor(){r(this,"Height",2);r(this,"GPURenderer");r(this,"HeightTexture");r(this,"TerrainMaterial");r(this,"IsMeshGenerated",O(!0));r(this,"Scene");r(this,"Camera");r(this,"Controls");r(this,"TerrainMesh");r(this,"GridMesh");r(this,"DirectionalLight");r(this,"DirectionalLight2");r(this,"_resolution",512);r(this,"_textureResolution",512);r(this,"_canvas");r(this,"_isColorized",!1);this.CreateRenderer(),this.Scene=new It,this.Scene.environmentNode=Us("#ffffff"),this.Scene.environmentIntensity=.05,this.Camera=new Xs(75,1,.01,1e3),this.Camera.position.z=10,this.Camera.position.y=10,this.CreateMaterial(),this.CreateTexture(this._resolution),this.CreateTerrainMesh(this.Resolution),this.CreateLight();const e=new ma;this.GridMesh=e.GridMesh,this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2),this.Scene.add(this.GridMesh);var t=new ga;this.Scene.add(t.Mesh);const s=ge();s.SetRenderer(this),s.Resolution=this.Resolution}get Resolution(){return this._resolution}get TextureResolution(){return this._textureResolution}CreateMaterial(){this.TerrainMaterial=new ts({color:"#a2a2a2"}),this.TerrainMaterial.side=Je,this.TerrainMaterial.needsUpdate=!0,this.TerrainMaterial.metalness=0,this.TerrainMaterial.roughness=1,this.TerrainMaterial.positionNode=A(()=>{const e=g(1/this.Resolution),t=g(1).sub(e).toVar(),s=Ee.xyz.toVar(),n=we(this.HeightTexture,Ee.xz.add(.5).mul(t)).mul(this.Height);return s.y.addAssign(n),s})(),this.TerrainMaterial.normalNode=A(()=>{const e=g(1/this.TextureResolution).toVar(),t=g(1).sub(e).toVar(),s=Ee.xyz.add(Gt(e,0,0)).toVar(),n=Ee.xyz.add(Gt(0,0,e.negate())).toVar(),i=Ee.xyz.toVar(),a=we(this.HeightTexture,Ee.xz.add(.5).mul(t)).mul(this.Height);i.y.addAssign(a),s.y.addAssign(we(this.HeightTexture,s.xz.add(.5)).mul(t).mul(this.Height)),n.y.addAssign(we(this.HeightTexture,n.xz.add(.5)).mul(t).mul(this.Height));const l=s.sub(i).normalize(),c=n.sub(i).normalize();return Ys(Fs(l,c))})()}CreateRenderer(){this.GPURenderer=new zs({alpha:!0,antialias:!0}),this.GPURenderer.shadowMap.enabled=!0,this.GPURenderer.shadowMap.type=Hs,this.GPURenderer.toneMapping=Ws,this.GPURenderer.setClearColor(0,0),this.GPURenderer.setPixelRatio(window.devicePixelRatio)}CreateTexture(e){this.HeightTexture=new $t(Math.floor(this.TextureResolution),Math.floor(this.TextureResolution)),this.HeightTexture.format=Ke,this.HeightTexture.type=Ae}CreateLight(){const e=new Ut(16777215,2);e.position.set(-10,10,0),e.castShadow=!0,e.shadow.autoUpdate=!0,e.shadow.camera.near=.1,e.shadow.camera.far=30,e.shadow.camera.top=8,e.shadow.camera.right=8,e.shadow.camera.bottom=-8,e.shadow.camera.left=-8,e.shadow.mapSize.set(8192,8192),e.shadow.radius=5,e.shadow.blurSamples=25,e.shadow.normalBias=.05,this.DirectionalLight=e;const t=new Ut(16777215,.5);t.position.set(10,10,0),this.DirectionalLight2=t}SetIsMeshGenerated(e){this.IsMeshGenerated.value=e}CreateTerrainMesh(e){this.SetIsMeshGenerated(!1),wa.Generate(1,1,e,e).then(t=>{t.rotateX(-Math.PI/2),this.TerrainMesh=new je(t,this.TerrainMaterial),this.TerrainMesh.castShadow=!0,this.TerrainMesh.receiveShadow=!0,this.TerrainMesh.scale.set(10,1,10),this.TerrainMesh.position.set(0,.006,0),this.GPURenderer.compile(this.TerrainMesh,this.Camera).finally(()=>{this.Scene.add(this.TerrainMesh),this.SetIsMeshGenerated(!0)})})}ChangeResolution(e){this._textureResolution=e,this.TerrainMaterial.dispose(),this.HeightTexture.dispose(),this.CreateTexture(this.TextureResolution),this.CreateMaterial(),this.TerrainMesh.material=this.TerrainMaterial,this.Scene.remove(this.DirectionalLight),this.Scene.remove(this.DirectionalLight2),this.DirectionalLight.dispose(),this.DirectionalLight2.dispose(),this.CreateLight(),this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2);const t=ge();t.Resolution=this.TextureResolution;const s=me();s.LockedNode!=null?this.Recalculate(s.LockedNode):s.SelectedNode!=null&&this.Recalculate(s.SelectedNode),requestAnimationFrame(()=>this.Render())}OnWindowResize(){if(this.GPURenderer==null||this.Camera==null||this._canvas==null)return;var e=this._canvas.offsetHeight,t=this._canvas.offsetWidth;this.GPURenderer.setSize(t,e);const s=t/e;this.Camera.aspect=s,this.Camera.updateProjectionMatrix(),requestAnimationFrame(()=>this.Render())}async Render(){await this.GPURenderer.renderAsync(this.Scene,this.Camera)}Mount(e){this._canvas=e;var t=this._canvas.offsetHeight,s=this._canvas.offsetWidth;this._canvas.appendChild(this.GPURenderer.domElement),this.GPURenderer.setSize(s,t),this.Camera.aspect=s/t,this.Controls=new qs(this.Camera,this.GPURenderer.domElement),this.Controls.enablePan=!1,this.Controls.update(),window.addEventListener("resize",()=>this.OnWindowResize()),this.Render(),requestAnimationFrame(()=>this.Render)}RequestRender(){requestAnimationFrame(()=>this.Render)}async Recalculate(e,t=!1){if(this.IsMeshGenerated.value==!1||e.Outputs.length==0)return;t||await e.Calculate();var s=e.Outputs[e.DefaultOutput].Value;const i=A(()=>{const a=Ye.modInt(this.TextureResolution),l=Ye.div(this.TextureResolution),c=Rt(a,l),d=x(c.x,c.y).div(this.TextureResolution).toVar(),h=s(d).toVar();h.assign(De(h,0,1)),Lt(this.HeightTexture,c,h).toWriteOnly()})().compute(this.TextureResolution*this.TextureResolution);this.GPURenderer.computeAsync(i).then(()=>{e.CalculationState=be.Calculated,requestAnimationFrame(()=>this.Render())})}SetGridVisible(e){this.GridMesh.visible=e,requestAnimationFrame(()=>this.Render())}}const _a={class:"container"},ba={key:0,style:{position:"relative",height:"100%",width:"100%"}},Va={style:{position:"absolute !important",top:"calc(50% + 30px)",width:"100%","text-align":"center"}},Sa=Y({__name:"Preview3D",setup(o){const e=O();e.value=new ya;const t=O();var s=ge();const n=fe(()=>s.ChangeEvent);var i=me();const a=fe(()=>i.SelectedNode),l=fe(()=>{var y;return(y=e.value)==null?void 0:y.IsMeshGenerated});qe(l,async(y,p)=>{requestAnimationFrame(()=>{var C;return(C=e.value)==null?void 0:C.Render()})}),qe(n,async(y,p)=>{var C,S;i.LockedNode!=null?(C=e.value)==null||C.Recalculate(i.LockedNode,!1):a.value!=null&&((S=e.value)==null||S.Recalculate(a.value,!1))}),qe(a,async y=>{var C,S;if(i.LockedNode!=null)(C=e.value)==null||C.Recalculate(i.LockedNode);else if(y!=null){var p=y;await((S=e.value)==null?void 0:S.Recalculate(p))}}),Fe(()=>{ye(()=>{var y;(y=e.value)==null||y.Mount(t.value)})});let c=!1;const d=()=>{c=!0},h=()=>{c=!1};window.addEventListener("mouseup",h),window.addEventListener("pointerup",h);const _=()=>{c&&requestAnimationFrame(()=>{var y;return(y=e.value)==null?void 0:y.Render()})},f=()=>{requestAnimationFrame(()=>{var y;return(y=e.value)==null?void 0:y.Render()})},u=O(!0),m=()=>{var y;u.value=!u.value,(y=e.value)==null||y.SetGridVisible(u.value)};return(y,p)=>{var T;const C=J("font-awesome-icon"),S=Ce("tooltip");return w(),V("div",_a,[(T=e.value)!=null&&T.IsMeshGenerated?oe("",!0):(w(),V("div",ba,[v(ls,{style:{scale:"2"}}),b("span",Va,M(y.$t("hints.initializingMesh")),1)])),b("div",{onMousedown:d,onMousemove:_,onWheel:f,onPointerdown:d,onPointermove:_,ref_key:"canvas",ref:t,style:{height:"100%",width:"100%"}},[v(Ct,{class:"top-left"},{default:I(()=>[v(Me,null,{default:I(()=>[q((w(),V("a",{onClick:m},[v(C,{icon:["fas","hashtag"]})])),[[S,"Switch Grid visibility",void 0,{bottom:!0}]])]),_:1})]),_:1})],544)])}}}),Ca=z(Sa,[["__scopeId","data-v-64b096ee"]]),xa={style:{width:"100%",height:"100%"}},Pa={style:{height:"calc(100% - 80px)",display:"flex","flex-direction":"row"}},ka={style:{width:"80%",height:"100%"}},Na={style:{height:"50%",width:"100%",display:"block"}},Ma={style:{"margin-left":"5px"}},Ia={style:{height:"50%"}},Oa={style:{width:"20%",height:"100%"}},$a={style:{"margin-left":"5px"}},Ra=Y({__name:"LayoutView",setup(o){return(e,t)=>{const s=J("font-awesome-icon");return w(),V("div",xa,[v(Hi,{style:{height:"50px"}}),b("div",Pa,[b("div",ka,[b("div",Na,[v(ut,{style:{display:"inline-block",width:"100%"}},{header:I(()=>[v(s,{icon:["fas","mountain-sun"]}),b("span",Ma,M(e.$t("windows.thirdPreview")),1)]),default:I(()=>[v(Ca)]),_:1})]),b("div",Ia,[v(To)])]),b("div",Oa,[v(ut,{style:{width:"100%"},"wheel-focus":!1},{header:I(()=>[v(s,{icon:["fas","sliders"]}),b("span",$a,M(e.$t("windows.properties")),1)]),default:I(()=>[v(va)]),_:1})])]),v(wn,{style:{height:"30px"}})])}}}),La=z(Ra,[["__scopeId","data-v-96fdc7ac"]]),Aa=_s({history:bs("/"),routes:[{path:"/",name:"home",component:La}]});class Da extends Q{constructor(){super(...arguments);r(this,"Name","nodes.clamp");r(this,"Inputs",[new E(!0,this,"Source")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Min",0,0,1),new P("Max",1,0,1)]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value),s=k(this.Properties[1].Value);this.Outputs[0].Value=A(([n])=>{var a;if(!this.Inputs[0].IsConnected)return g(0);const i=(a=this.Inputs[0].Links[0].In)==null?void 0:a.Value(n);return De(i,t,s)})}}class Ta extends Q{constructor(){super(...arguments);r(this,"Name","nodes.constant");r(this,"Outputs",[new E(!1,this,"Output")]);r(this,"Properties",[new P("Height",0,0,1)]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value);this.Outputs[0].Value=A(([s])=>g(t))}}class Ba extends Q{constructor(){super(...arguments);r(this,"Name","nodes.cracks");r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Angle",0,0,100,0,"Noise",""),new P("Thickness",.03,0,1,0,"Noise",""),new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value),a=k(this.Properties[4].Value),l=k(this.Properties[5].Value),c=k(this.Properties[6].Value),d=k(this.Properties[7].Value);this.Outputs[0].Value=A(([h])=>{const _=x(h.x,h.y).toVar(),f=x(ht(_.mul(2).mul(.5),a,x(c,d),l)).mul(i).mul(.2);return Cn({uv:_.add(f),angle:s,scale:t,thickness:n})})}}const Ea=A(([o,e,t])=>{const s=g(t).toVar(),n=g(e).toVar(),i=g(o).toVar();s.assign($e(0,s));const a=g($e(0,Ve(1,n.sub(i).add(s).div(g(2).mul(s))))).toVar();return i.mul(a).add(n.mul(g(1).sub(a)).sub(s.mul(a).mul(g(1).sub(a))))}).setLayout({name:"smoothMin",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),Ga=A(([o,e,t])=>{const s=g(t).toVar(),n=g(e).toVar(),i=g(o).toVar();s.assign(Ve(0,s.negate()));const a=g($e(0,Ve(1,n.sub(i).add(s).div(g(2).mul(s))))).toVar();return i.mul(a).add(n.mul(g(1).sub(a)).sub(s.mul(a).mul(g(1).sub(a))))}).setLayout({name:"smoothMax",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),Ua=A(([o])=>{const e=x(o).toVar();return Se(_e(ke(e.xy,x(12.9898,78.233))).mul(43758.5453123))}).setLayout({name:"random",type:"float",inputs:[{name:"st",type:"vec2"}]}),Xa=A(([o,e,t])=>{const s=g(t).toVar(),n=g(e).toVar(),i=x(o).toVar(),a=x(i.mul(n)).toVar(),l=x(Le(a)).toVar(),c=x(Se(a)).toVar(),d=g(Ua(l).mul(2).sub(1).mul(s)).toVar(),h=g(_e(d)).toVar(),_=g(it(d)).toVar(),f=x(c.sub(.5)).toVar(),u=x().toVar();return u.x.assign(f.x.mul(_).sub(f.y.mul(h))),u.y.assign(f.x.mul(h).add(f.y.mul(_))),u.add(.5).add(l).mod(1)}).setLayout({name:"tilingWithLimitedRotation",type:"vec2",inputs:[{name:"uv",type:"vec2"},{name:"tileCount",type:"float"},{name:"maxAngle",type:"float"}]});class Ya extends Q{constructor(){super(...arguments);r(this,"Name","nodes.crater");r(this,"Outputs",[new E(!1,this,"Output")]);r(this,"Properties",[new P("Smoothness",.5,0,1,0,"Crater params",""),new P("FloorHeight",-1,-5,5,0,"Crater params",""),new P("Radius",.16,0,1,0,"Crater params",""),new P("RimWidth",1.35,0,100,0,"Crater params",""),new P("RimSteepness",4,0,100,0,"Crater params",""),new P("X",.5,0,1,0,"Transform",""),new P("Y",.5,0,1,0,"Transform","")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value),a=k(this.Properties[4].Value),l=k(this.Properties[5].Value),c=k(this.Properties[6].Value);this.Outputs[0].Value=A(([d])=>{const h=x(d.x,d.y).toVar(),_=x(l,c).toVar(),f=g(At(h.sub(_)).div($e(n,1e-4))).toVar(),u=g(f.mul(f).sub(1)).toVar(),m=g(Ve(f.sub(1).sub(i),0)).toVar(),y=g(a.mul(m).mul(m)).toVar(),p=g(Ga(u,s,t)).toVar();return p.assign(Ea(p,y,t)),p.mul(n).add(.5).toVar()})}}class Fa extends Q{constructor(){super(...arguments);r(this,"Name","nodes.fake");r(this,"Position",new L(1e3,1e3))}}class za extends Q{constructor(){super(...arguments);r(this,"Name","nodes.falloff");r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Strength",0,0,10)]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value);this.Outputs[0].Value=A(([s])=>{const n=x(s.x,s.y).toVar(),i=g(ss(x(.5),n.mod(1))).mul(t).toVar(),a=F(g(1),g(0),i).toVar();return at(De(a,0,1),2)})}}const Ha=A(([o,e])=>{const t=o.mul(e).toVar();return Le(t).add(.5).toVar().div(e)});class Wa extends Q{constructor(){super(...arguments);r(this,"Name","nodes.fastErosion");r(this,"Inputs",[new E(!0,this,"Inpute Height")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Power",.1,0,1,0,"Erosion","")]);r(this,"IsRealtimeUpdate",!1);r(this,"terrainHeight")}async Calculate(){await this.BaseCalculate();const t=ge(),s=t.GetRenderer(),n=t.Resolution;if(this.terrainHeight=new $t(Math.floor(n),Math.floor(n)),this.terrainHeight.type=Ae,!this.IsCalculated){const l=A(()=>{var f;const c=Ye.modInt(n),d=Ye.div(n),h=Rt(c,d);x(1/n).toVar();const _=x(h.x,h.y).div(n).toVar();if(this.Inputs[0].IsConnected){const m=((f=this.Inputs[0].Links[0].In)==null?void 0:f.Value)(_).toVar();Lt(this.terrainHeight,h,m).toWriteOnly()}})().compute(n*n);s==null||s.GPURenderer.computeAsync(l)}this.CalculationState=be.Calculation;for(let a=0;a<1e8;a++)this.CalculationState,a%1e5==0&&await new Promise(l=>setTimeout(l,0));const i=k(this.Properties[0].Value);this.Outputs[0].Value=A(([a])=>{if(this.Inputs[0].IsConnected){const l=x(a.x,a.y).toVar(),c=Ha(l,n).toVar(),d=we(this.terrainHeight,c),h=d.r,_=d.g,f=d.b,u=we(this.terrainHeight,c.add(ft(Kt(-1),0))).r,m=we(this.terrainHeight,c.add(ft(1,0))).r,y=we(this.terrainHeight,c.add(ft(0,1))).r,p=x(m.sub(u),y.sub(h));_.addAssign(5e-4);const S=At(p).mul(_).mul(10).mul(i);return h.subAssign(S),f.addAssign(S),_.mulAssign(.95),f.mulAssign(.99),h}else return 0})}}class qa extends Q{constructor(){super(...arguments);r(this,"Name","nodes.gradientNoise");r(this,"Outputs",[new E(!1,this,"Output")]);r(this,"Properties",[new P("Scale",10,0,100),new P("Offset X",0,0,100),new P("Offset Y",0,0,100)]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value);this.Outputs[0].Value=A(([i])=>{const a=x(i.x,i.y).mul(t).toVar(),l=x(s,n).toVar();return a.addAssign(l),rs(a)})}}class Ka extends Q{constructor(){super(...arguments);r(this,"Name","nodes.invert");r(this,"Inputs",[new E(!0,this,"Source")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate(),this.Outputs[0].Value=A(([t])=>{var n;if(!this.Inputs[0].IsConnected)return g(0);const s=(n=this.Inputs[0].Links[0].In)==null?void 0:n.Value(t);return g(1).sub(s)})}}class Za extends Q{constructor(){super(...arguments);r(this,"Name","nodes.mountain");r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Scale",3.55,0,100,0,"Noise Transform","%"),new P("Octaves Count",10,1,50,1,"Noise Params",""),new P("Offset X",-.08,-100,100,0,"Noise Transform",""),new P("Offset Y",-.54,-100,100,0,"Noise Transform",""),new P("Falloff",3,0,20,0,"Mountain",""),new P("Height",1,0,1,0,"Mountain",""),new P("Position X",.5,0,1,0,"Mountain Transform",""),new P("Position Y",.5,0,1,0,"Mountain Transform","")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value),a=k(this.Properties[4].Value),l=k(this.Properties[5].Value),c=k(this.Properties[6].Value),d=k(this.Properties[7].Value);this.Outputs[0].Value=A(([h])=>{const _=x(h.x,h.y).toVar(),f=g(ss(x(c,d),_)).mul(a).toVar(),u=F(g(1),g(0),f).toVar(),m=at(De(u,0,1),2),y=_.sub(x(c,d).sub(.5)).toVar(),p=ht(y,s,x(n,i),t).toVar();return De(m.mul(p).mul(g(1.45).mul(l)),0,1)})}}class ja extends Q{constructor(){super(...arguments);r(this,"Name","nodes.redistribution");r(this,"Inputs",[new E(!0,this,"Source")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Exponent",1,1,10)]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value);this.Outputs[0].Value=A(([s])=>{var i;return this.Inputs[0].IsConnected?((i=this.Inputs[0].Links[0].In)==null?void 0:i.Value(s)).pow(t):g(0)})}}class Ja extends Q{constructor(){super(...arguments);r(this,"Name","nodes.terrace");r(this,"Inputs",[new E(!0,this,"Param 1")]);r(this,"Outputs",[new E(!1,this,"Output")]);r(this,"Properties",[new P("Smoothness",.1,0,1),new P("Count",3,0,100,1)]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value);this.Outputs[0].Value=A(([n])=>{var i;if(this.Inputs[0].IsConnected){const l=((i=this.Inputs[0].Links[0].In)==null?void 0:i.Value)(n).toVar();if(this.Properties[1].Value==0)return l;const c=g(1).div(s).toVar(),d=Le(l.div(c)).toVar(),h=l.sub(d.mul(c)).div(c).toVar(),_=Ve(g(2).mul(h),g(1)).toVar(),f=d.add(_).mul(c).toVar(),u=gt(1,g(s)),m=Le(l.div(u)),y=Se(l.div(u)),p=m.mul(u).add(ze(0,1,y).mul(u));return F(f,p,t)}else return 0})}}class Qa extends Q{constructor(){super(...arguments);r(this,"Name","nodes.voronoi");r(this,"Outputs",[new E(!1,this,"Output"),new E(!1,this,"Cells"),new E(!1,this,"Bubbles")]);r(this,"Properties",[new P("Scale",10,1,100,0,"Transform","%"),new P("OffsetX",0,0,100,0,"Transform",""),new P("OffsetY",0,0,100,0,"Transform",""),new P("Angle",5,0,100,0,"Noise","")]);r(this,"IsRealtimeUpdate",!0);r(this,"DefaultOutput",0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value);this.Outputs[0].Value=A(([a])=>{const l=x(a.x,a.y).toVar(),c=x(s,n).toVar();l.addAssign(c);const d=pt({UV:l,angleOffset:i,cellDensity:t}).toVar();return at(d.x,2)}),this.Outputs[1].Value=A(([a])=>{const l=x(a.x,a.y).toVar(),c=x(s,n).toVar();return l.addAssign(c),pt({UV:l,angleOffset:i,cellDensity:t}).toVar().y}),this.Outputs[2].Value=A(([a])=>{const l=x(a.x,a.y).toVar(),c=x(s,n).toVar();l.addAssign(c);const d=pt({UV:l,angleOffset:i,cellDensity:t}).toVar();return Ks(at(d.x,2))})}}class er extends Q{constructor(){super(...arguments);r(this,"Name","nodes.transform");r(this,"Inputs",[new E(!0,this,"Input")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Properties",[new P("Scale X",1,0,100,0,"Scale",""),new P("Scale Y",1,0,100,0,"Scale",""),new P("Position X",0,-100,100,0,"Position",""),new P("Position Y",0,-100,100,0,"Position",""),new P("Midpoint X",.5,0,1,0,"Rotation",""),new P("Midpoint Y",.5,0,1,0,"Rotation",""),new P("Angle",0,-360,360,0,"Rotation","")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value),a=k(this.Properties[4].Value),l=k(this.Properties[5].Value),c=k(this.Properties[6].Value);this.Outputs[0].Value=A(([d])=>{var C;const h=x(d.x,d.y).toVar(),_=x(t,s).toVar(),f=x(n,i).toVar(),u=x(a,l).toVar(),m=c.mul(ns.div(180)).toVar(),y=x(it(m).mul(h.x.sub(u.x)).add(_e(m).mul(h.y.sub(u.y))).add(u.x),it(m).mul(h.y.sub(u.y)).sub(_e(m).mul(h.x.sub(u.x))).add(u.y));return h.assign(y),h.addAssign(f),h.mulAssign(_),(C=this.Inputs[0].Links[0].In)==null?void 0:C.Value(h).toVar()})}}class tr extends Q{constructor(){super(...arguments);r(this,"Inputs",[new E(!0,this,"Input")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Name","nodes.tile");r(this,"Properties",[new P("Tile Count",1,0,100,1),new P("Angle Threshold",0,0,360,0)]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value),s=k(this.Properties[1].Value);this.Outputs[0].Value=A(([n])=>{var d;var i=x(n).toVar(),a=s.mul(ns.div(180));const l=Xa(i,t,a).toVar();return(d=this.Inputs[0].Links[0].In)==null?void 0:d.Value(l).toVar()})}}class sr extends Q{constructor(){super(...arguments);r(this,"Inputs",[new E(!0,this,"Input")]);r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Name","nodes.height");r(this,"IsRealtimeUpdate",!0);r(this,"Properties",[new P("Height",1,0,100,0,"","%")])}async Calculate(){this.BaseCalculate();const t=k(this.Properties[0].Value);this.Outputs[0].Value=A(([s])=>{var a;if(!this.Inputs[0].IsConnected)return g(0);var n=x(s).toVar();return((a=this.Inputs[0].Links[0].In)==null?void 0:a.Value(n).toVar()).mul(t.mul(.01))})}}class nr extends Q{constructor(){super(...arguments);r(this,"Name","nodes.distortion");r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Inputs",[new E(!0,this,"Input")]);r(this,"Properties",[new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();var t=k(this.Properties[0].Value),s=k(this.Properties[1].Value),n=k(this.Properties[2].Value),i=k(this.Properties[3].Value),a=k(this.Properties[4].Value);this.Outputs[0].Value=A(([l])=>{var c;if(this.Inputs[0].IsConnected){const d=(c=this.Inputs[0].Links[0].In)==null?void 0:c.Value,h=x(l.x,l.y).toVar(),_=x(ht(h.mul(2).mul(.5),s,x(i,a),n)).mul(t).mul(.2);return d(h.add(_)).toVar()}else return 0})}}class or extends Q{constructor(){super(...arguments);r(this,"Name","nodes.dune");r(this,"Outputs",[new E(!1,this,"Result")]);r(this,"Inputs",[]);r(this,"Properties",[new P("Scale",0,0,0,0,"Tramsform","%"),new P("Height",0,0,0,0,"Tramsform","%"),new P("Wind Direction",0,0,0,0,"Tramsform","%"),new P("Octaves",0,0,0,0,"Noise","%"),new P("Sand Roughness",0,0,0,0,"Noise","%"),new P("Seed",0,0,0,0,"Random","%"),new P("Time",0,0,0,0,"Random","%")]);r(this,"IsRealtimeUpdate",!0)}async Calculate(){this.BaseCalculate();const t=k(this.Properties[6].Value),s=k(this.Properties[5].Value),n=k(this.Properties[0].Value),i=k(this.Properties[1].Value),a=k(this.Properties[4].Value),l=k(this.Properties[2].Value);k(this.Properties[3].Value);const c=A(([u])=>{const m=u.toVar();return m.assign(x(ke(m,x(127.1,311.7)),ke(m,x(269.5,183.3)))),g(-1).add(ie(2,Se(_e(m.x.add(m.y)).mul(g(43758.5453123)))))}),d=A(([u])=>{const m=Le(u),y=Se(u),p=y.mul(y).mul(j(3,ie(2,y))),C=c(m),S=c(m.add(x(1,0))),T=c(m.add(x(0,1))),H=c(m.add(x(1,1)));return F(F(C,S,p.x),F(T,H,p.x),p.y)}),h=A(([u,m,y])=>{const p=g(0),C=g(1),S=g(1),T=g(0);return Zt(m,({i:H})=>{p.addAssign(C.mul(d(u.mul(S).add(s)))),T.addAssign(C),C.mulAssign(y),S.mulAssign(2)}),p.div(T)}),_=A(([u,m])=>j(1,Xe(_e(u.mul(3.14159).mul(m))))),f=A(([u,m])=>{const y=x(it(m),_e(m)),p=h(u.mul(n).add(y.mul(.5)),4,.5);x(y.y.negate(),y.x);const C=_e(u.x.mul(n).mul(.3).add(d(u.mul(2)).mul(2))).mul(_e(u.y.mul(n).mul(.2))).mul(.3),S=p.mul(.7).add(C.mul(.3));S.assign(F(S,_(S,1.5),.4));const T=h(u.mul(n).mul(4),2,.3).mul(a);return S.add(T.mul(.1))});this.Outputs[0].Value=A(([u])=>{const m=u,y=x(t.mul(.01),0),p=f(m.mul(x(2,1)).add(y),l);return p.assign(p.mul(.5).add(.5).mul(i)),p})}}function ir(){Z.registerStr("nodes.buffer","",Oe),Z.registerStr("nodes.fake","",Fa),Z.registerStr("nodes.constant","nodeCategories.testNodes",Ta),Z.registerStr("nodes.perlinNoise","nodeCategories.testNodes",xn),Z.registerStr("nodes.mountain","nodeCategories.testNodes",Za),Z.registerStr("nodes.terrace","nodeCategories.testNodes",Ja),Z.registerStr("nodes.combine","nodeCategories.testNodes",nt),Z.registerStr("nodes.clamp","nodeCategories.testNodes",Da),Z.registerStr("nodes.invert","nodeCategories.testNodes",Ka),Z.registerStr("nodes.redistribution","nodeCategories.testNodes",ja),Z.registerStr("nodes.gradientNoise","nodeCategories.testNodes",qa),Z.registerStr("nodes.voronoi","nodeCategories.testNodes",Qa),Z.registerStr("nodes.crater","nodeCategories.testNodes",Ya),Z.registerStr("nodes.falloff","nodeCategories.testNodes",za),Z.registerStr("nodes.fastErosion","nodeCategories.testNodes",Wa),Z.registerStr("nodes.cracks","nodeCategories.testNodes",Ba),Z.registerStr("nodes.transform","nodeCategories.testNodes",er),Z.registerStr("nodes.tile","nodeCategories.testNodes",tr),Z.registerStr("nodes.height","nodeCategories.testNodes",sr),Z.registerStr("nodes.distortion","nodeCategories.testNodes",nr),Z.registerStr("nodes.dune","nodeCategories.testNodes",or),Z.registerStr("nodes.export","nodeCategories.testNodes",Ue)}const ar={en:{"":"",logo:"Mashuk",windows:{thirdPreview:"3D Preview",secondPreview:"2D Preview",properties:"Node properties",graph:"Graph",nodesList:"Nodes list"},tt:{undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",delete:"Delete node/selected",fullscreen:"Fullscreen",save:"Save project",cancel:"Cancel",load:"Load project",presets:"Presets",resetView:"Reset view",resetParams:"Reset node parameters to default",lockPreview:"Lock Preview",unlockPreview:"Unlock Preview",mesh_resolution:"Resolution",new:"New project",settings:"Project settings",menu:"Menu",resolutionWarning:"Warning! Selecting a high resolution will increase video memory consumption and processing speed.",build:"Build project",buildSettings:"Build settings",clickForEdit:"Click for edit",saveSettings:"Save settings"},hints:{graphLmb:"LMB: Select/Drag node",graphWheel:"Wheel: Zoom/Drag work space",placeHere:"PLACE HERE",initializingMesh:"Initializing Mesh..."},nodes:{constant:"Constant",perlinNoise:"Perlin Noise",mountain:"Mountain",terrace:"Terrace",combine:"Combine",clamp:"Clamp",invert:"Invert",redistribution:"Redistribution",gradientNoise:"Gradient Noise",voronoi:"Voronoi",crater:"Crater",falloff:"Falloff",fastErosion:"Fast Erosion",cracks:"Cracks",transform:"Transform",tile:"Tile",height:"Height",distortion:"Distortion",dune:"Dunes",export:"Export"},buildModal:{resolution:"Resolution",tiles:"Tiles",terrain:"Terrain",build:"Build",nodes:"Nodes"},nodeCategories:{testNodes:"Test nodes",colorNodes:"Color nodes"}},ru:{logo:"Машук",windows:{thirdPreview:"3D Просмотр",secondPreview:"2D Просмотр",properties:"Параметры узла",graph:"Граф",nodesList:"Список узлов"},tt:{undo:"Отменить",redo:"Повторить",copy:"Копировать",paste:"Вставить",delete:"Удалить узел/выделенные",fullscreen:"На весь экран",save:"Сохранить проект",cancel:"Отменить",load:"Загрузить проект",presets:"Предустановки",resetView:"Сбросить вид",resetParams:"Сбросить параметры узла до значений по умолчанию",lockPreview:"Закрепить отображение",unlockPreview:"Открепить отображение",mesh_resolution:"Разрешение",new:"Новый проект",settings:"Настройки проекта",menu:"Меню",resolutionWarning:"Внимание! Выбор высокого разрешения влечет за собой увеличение потребления видеопамяти и скорости обработки",build:"Собрать проект",buildSettings:"Настройка сборки",clickForEdit:"Нажмите что-бы отредактировать",saveSettings:"Сохранить настройки"},hints:{graphLmb:"ЛКМ: Выделить/Передвинуть узел",graphWheel:"Колесо мыши: Приближение/Перемещение рабочей области",placeHere:"РАЗМЕСТИТЕ ЗЕСЬ",initializingMesh:"Инициализация Меша..."},nodes:{constant:"Константа",perlinNoise:"Шум Перлина",mountain:"Гора",terrace:"Террасы",combine:"Комбинирование",clamp:"Ограничение",invert:"Инверсия",redistribution:"Перераспределение",gradientNoise:"Градиентный Шум",voronoi:"Шум Вороного",crater:"Кратер",falloff:"Спад",fastErosion:"Быстрая Эрозия",cracks:"Трещины",transform:"Преобразование",tile:"Плитка",height:"Высота",distortion:"Искажения",dune:"Дюны",export:"Экспорт"},buildModal:{resolution:"Разрешение",tiles:"Тайлы",terrain:"Ландшафт",build:"Сборка",nodes:"Узлы"},nodeCategories:{testNodes:"Тестовые узлы",colorNodes:"Красящие узлы"}}};Mt.options.themes.tooltip.delay.show=0;Mt.options.distance=10;Vs.add(Zs,Ss);const rr=Cs({legacy:!1,locale:"en",fallbackLocale:"en",messages:ar}),xe=xs(hn);xe.component("font-awesome-icon",Ps);xe.component("font-awesome-layers",ks);xe.component("font-awesome-layers-text",Ns);xe.use(Ms());xe.use(Aa);xe.use(Mt);xe.use(rr);xe.use(Is);xe.mount("#app");ir();
