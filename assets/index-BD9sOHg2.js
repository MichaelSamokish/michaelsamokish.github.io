var qt=Object.defineProperty;var Zt=(i,e,t)=>e in i?qt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>Zt(i,typeof e!="symbol"?e+"":e,t);import{d as W,g as gt,c as re,r as te,a as q,b as V,o as m,u as Q,R as Kt,e as I,f as v,_ as z,v as wt,h as Pt,i as Vt,j as R,k as qe,l as Ne,w as ue,m as F,n as H,t as T,p as ne,q as ge,F as K,s as ye,x as L,T as jt,y as Jt,z as Ve,A as Oe,B as Rt,C as Fe,D as Qt,E as It,G as ze,H as Dt,I as Ct,J as es,K as ts,L as yt,M as ss,N as ns,O as os,P as is,Q as as,S as rs,V as ls}from"./vendor-jUf6HuyN.js";import{w as Tt,F as k,i as le,f as u,v as b,L as St,a as Ye,b as Se,d as Ie,m as B,n as At,c as Ee,s as pe,u as x,e as ht,g as ft,h as U,j as Gt,k as oe,p as us,l as We,o as ds,q as st,r as J,t as cs,M as Xt,D as _t,P as Bt,x as bt,y as hs,z as fs,A as je,B as Ce,C as ps,E as ut,S as ms,G as vs,H as gs,I as Te,J as Je,K as Nt,N as ws,O as Vs,W as ys,Q as Ss,R as _s,T as bs,U as xs,V as Ps,X as Mt,Y as Is,Z as xe,_ as tt,$ as Cs,a0 as Ae,a1 as Ns,a2 as ve,a3 as Ms,a4 as nt,a5 as Yt,a6 as ot,a7 as Ge,a8 as Qe,a9 as Xe,aa as kt,ab as dt,ac as ks,ad as Et}from"./three-CoysxtaA.js";import{i as Os}from"./icons-CNPGi31y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const Ls={key:1,class:"gpu-error-box disable-user-select"},$s={class:"gpu-error-message-box"},Rs={style:{"font-size":"100px","text-align":"center",color:"var(--vt-c-red)"}},Ds=W({__name:"App",setup(i){const e=gt(),t=localStorage.getItem("userLang");t&&e!=null&&(e.appContext.config.globalProperties.$i18n.locale=t);const s=re(()=>navigator.gpu);return(n,o)=>{const r=te("font-awesome-icon");return s.value?(m(),q(Q(Kt),{key:0})):(m(),V("div",Ls,[I("div",$s,[I("div",Rs,[v(r,{icon:["fas","circle-xmark"]})]),o[0]||(o[0]=I("h1",null,"WebGPU is not supported on this browser.",-1))])]))}}}),Ts=z(Ds,[["__scopeId","data-v-286205d8"]]);class Ht{constructor(){a(this,"Id",wt());a(this,"In",null);a(this,"Out",null);a(this,"IsSelected",!1)}SetSelected(e){var s,n,o;var t=this.In!=null?(s=this.In.ParentNode)==null?void 0:s.ParentGraph:(o=(n=this.Out)==null?void 0:n.ParentNode)==null?void 0:o.ParentGraph;t!=null&&e==!0&&t.DeselectAll(),this.IsSelected=e}DeleteLinkFromTerminals(){var s,n;var e=(s=this.In)==null?void 0:s.Links.indexOf(this);e!=null&&this.In!=null&&this.In.Links.splice(e,1);var t=(n=this.Out)==null?void 0:n.Links.indexOf(this);t!=null&&this.Out!=null&&this.Out.Links.splice(t,1)}}class O{constructor(e,t){a(this,"X",0);a(this,"Y",0);this.X=e,this.Y=t}get Length(){return Math.sqrt(this.X*this.X+this.Y*this.Y)}get Normalized(){return O.Div(this,this.Length)}Reset(){this.X=0,this.Y=0}static Add(e,t){return t instanceof O?new O(e.X+t.X,e.Y+t.Y):typeof t=="number"?new O(e.X+t,e.Y+t):e}static Sub(e,t){return t instanceof O?new O(e.X-t.X,e.Y-t.Y):typeof t=="number"?new O(e.X-t,e.Y-t):e}static Mul(e,t){return t instanceof O?new O(e.X*t.X,e.Y*t.Y):typeof t=="number"?new O(e.X*t,e.Y*t):e}static Div(e,t){return t instanceof O?new O(e.X/t.X,e.Y/t.Y):typeof t=="number"?new O(e.X/t,e.Y/t):e}}var Ut=(i=>(i[i.none=0]="none",i[i.Buffer=1]="Buffer",i[i.Primitives=2]="Primitives",i[i.GeoPrimitives=3]="GeoPrimitives",i[i.Warps=4]="Warps",i[i.Adjastments=5]="Adjastments",i[i.Profile=6]="Profile",i[i.Filters=7]="Filters",i[i.Erosion=8]="Erosion",i[i.Snow=9]="Snow",i[i.Water=10]="Water",i[i.Data=11]="Data",i[i.Color=12]="Color",i[i.Render=13]="Render",i[i.Output=14]="Output",i))(Ut||{}),ke=(i=>(i[i.NotCalculated=0]="NotCalculated",i[i.Calculation=1]="Calculation",i[i.Calculated=2]="Calculated",i))(ke||{});class P{constructor(e,t,s,n=0,o=0,r="",c=""){a(this,"Name","");a(this,"Description","");a(this,"Value");a(this,"Min",-10);a(this,"Max",10);a(this,"Suffix");a(this,"Category");a(this,"Step");a(this,"valueList");a(this,"Default");this.Name=e,this.Value=t,this.Default=t,this.Min=typeof s=="number"?s:0,this.Max=n,this.Suffix=c,this.Category=r,this.Step=o,this.valueList=s instanceof Array?s:void 0}Reset(){this.Value=this.Default}}class j{constructor(){a(this,"Id",wt());a(this,"Position",new O(0,0));a(this,"LastPosition",new O(0,0));a(this,"Name","");a(this,"Category",Ut.none);a(this,"Properties");a(this,"Inputs",[]);a(this,"Outputs",[]);a(this,"IsSelected",!1);a(this,"Height",0);a(this,"Width",0);a(this,"IsCalculated",!1);a(this,"ParentGraph",null);a(this,"CalculationState",ke.NotCalculated);a(this,"IsRealtimeUpdate",!1);a(this,"DefaultOutput",0)}Move(e,t){this.Position=new O(e,t)}SetSize(e,t){this.Height=e,this.Width=t}SetSelected(e){this.IsSelected=e;const t=he();e?t.SelectedNode=this:t.SelectedNode==this&&(t.SelectedNode=null)}SetLastPosition(e,t){this.LastPosition.X=e,this.LastPosition.Y=t}BaseCalculate(){this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,n;(n=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||n.SetNotCalculated()})}),this.Inputs.forEach(e=>{var t,s,n,o;e.IsConnected&&((s=(t=e.Links[0].In)==null?void 0:t.ParentNode)==null||s.Calculate(),(o=(n=e.Links[0].In)==null?void 0:n.ParentNode)==null||o.SetCalculated())})}SetNotCalculated(){this.CalculationState=ke.NotCalculated,this.Outputs.forEach(e=>{e.Links.forEach(t=>{var s,n;(n=(s=t==null?void 0:t.Out)==null?void 0:s.ParentNode)==null||n.SetNotCalculated()})})}SetCalculated(){this.CalculationState=ke.Calculated}Calculate(){}}class G{constructor(e,t,s){a(this,"Guid",wt());a(this,"Links",new Array);a(this,"IsInput",!1);a(this,"ParentNode",null);a(this,"Position",new O(0,0));a(this,"OffsetPosition",new O(0,0));a(this,"Value",null);a(this,"Name","");this.ParentNode=t,this.IsInput=e,this.Name=s}get IsConnected(){return this.Links.length>0}SetOffset(e,t){this.OffsetPosition=new O(e,t)}SetPosition(e,t){this.Position=new O(e,t)}}class Z{static register(e){var t=new e;this.classMap.set(t.constructor.name,e)}static registerStr(e,t,s){this.classMap.set(e,s),this.groupsMap.has(t)||this.groupsMap.set(t,new Map);var n=this.groupsMap.get(t);n==null||n.set(e,s)}static create(e,...t){const s=this.classMap.get(e);if(!s)throw new Error(`Class ${e} not registered`);return new s(...t)}static getGroups(){return this.groupsMap}}a(Z,"classMap",new Map),a(Z,"groupsMap",new Map);class Be{static Serialize(e){var r,c,h,d,l,f,p,y;var t=new As;if(e.Nodes!=null&&e.Nodes.length>0)for(const g of e.Nodes){var s=new Gs;if(s.NodeType=g.Name,s.NodeGuid=g.Id,s.NodePostition=g.Position,g.Properties!=null&&g.Properties.length>0)for(const w of g.Properties){var n=new Xs;n.Value=w.Value,s.Properties==null&&(s.Properties=new Array),s.Properties.push(n)}t.Nodes==null&&(t.Nodes=new Array),t.Nodes.push(s)}if(e.Links!=null&&e.Links.length>0)for(const g of e.Links){var o=new Bs;o.FromNodeGuid=(c=(r=g.In)==null?void 0:r.ParentNode)==null?void 0:c.Id,o.ToNodeGuid=(d=(h=g.Out)==null?void 0:h.ParentNode)==null?void 0:d.Id,o.FromTerminalIndex=(f=(l=g.In)==null?void 0:l.ParentNode)==null?void 0:f.Outputs.indexOf(g.In),o.ToTerminalIndex=(y=(p=g.Out)==null?void 0:p.ParentNode)==null?void 0:y.Inputs.indexOf(g.Out),t.Links==null&&(t.Links=new Array),t.Links.push(o)}return t}static Deserialize(e){var t=new pt;if(e.Nodes!=null&&e.Nodes.length>0)for(var s of e.Nodes){var n=Z.create(s.NodeType);if(n.Id=s.NodeGuid,n.Move(s.NodePostition.X,s.NodePostition.Y),s.Properties!=null&&s.Properties.length>0)for(var o=0;o<s.Properties.length;o++)n.Properties[o].Value=s.Properties[o].Value;t.AddNode(n,!1)}if(e.Links!=null&&e.Links.length>0)for(var r of e.Links){var c=Pt(t.Nodes).firstOrDefault(d=>d.Id==r.FromNodeGuid),h=Pt(t.Nodes).firstOrDefault(d=>d.Id==r.ToNodeGuid);c==null||h==null||t.AddLink(c.Outputs[r.FromTerminalIndex],h.Inputs[r.ToTerminalIndex],!1)}return t}}class As{constructor(){a(this,"Nodes");a(this,"Links")}static ToJson(e){return JSON.stringify(e)}}class Gs{constructor(){a(this,"NodeGuid");a(this,"NodeType");a(this,"NodePostition");a(this,"Properties")}}class Xs{constructor(){a(this,"Value")}}class Bs{constructor(){a(this,"FromNodeGuid");a(this,"ToNodeGuid");a(this,"FromTerminalIndex");a(this,"ToTerminalIndex")}}class Ys{constructor(e){a(this,"buffer");a(this,"capacity");a(this,"head",0);a(this,"tail",0);a(this,"size",0);a(this,"poppedItems",[]);if(e<=0)throw new Error("Capacity must be greater than 0");this.capacity=e,this.buffer=new Array(e)}get hasValues(){return this.size>0}get hasPoppedItems(){return this.poppedItems.length>0}push(e){this.poppedItems=[],this.size===this.capacity?(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.head=(this.head+1)%this.capacity):(this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++)}pop(){if(!this.hasValues)return;this.tail=(this.tail-1+this.capacity)%this.capacity;const e=this.buffer[this.tail];return this.size--,this.poppedItems.push(e),e}unpop(){if(!this.hasPoppedItems)return;const e=this.poppedItems.pop();return this.size===this.capacity&&(this.head=(this.head+1)%this.capacity),this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.size++,e}toArray(){const e=[];for(let t=0;t<this.size;t++){const s=(this.head+t)%this.capacity;e.push(this.buffer[s])}return e}peek(){if(this.hasValues)return this.buffer[(this.tail-1+this.capacity)%this.capacity]}get length(){return this.size}}class me{static get HasValues(){return this.ActionHistoryBuffer.hasValues}static get HasPopped(){return this.ActionHistoryBuffer.hasPoppedItems}static PushState(e){this.ActionHistoryBuffer.push(Be.Serialize(e))}static UnpopState(){if(this.ActionHistoryBuffer.hasPoppedItems){var e=this.ActionHistoryBuffer.unpop();return Be.Deserialize(e)}return null}static PopState(){if(this.ActionHistoryBuffer.hasValues){var e=this.ActionHistoryBuffer.pop();return Be.Deserialize(e)}return null}}a(me,"ActionHistoryBuffer",new Ys(25));class pt{constructor(){a(this,"IsSubGraph",!1);a(this,"Nodes",new Array);a(this,"Links",new Array)}get HasSelected(){return this.Nodes.some(e=>e.IsSelected)||this.Links.some(e=>e.IsSelected)}AddNode(e,t=!0){var s=this.Nodes.indexOf(e);s==-1&&(e.ParentGraph=this,this.Nodes.push(e),t&&me.PushState(this))}DeleteLink(e,t=!0){var s=this.Links.indexOf(e);s!=-1&&(e.DeleteLinkFromTerminals(),this.Links.splice(s,1),t&&me.PushState(this))}AddLink(e,t,s=!0){if(!(e.IsInput&&t.IsInput||!e.IsInput&&!t.IsInput)){var n=new Ht;e.IsInput?(n.In=t,n.Out=e):(n.In=e,n.Out=t),t.Links.push(n),e.Links.push(n),this.Links.push(n),s&&me.PushState(this)}}DeleteNode(e,t=!0){if(e!=null){var s=he();s.SelectedNode==e&&(s.SelectedNode=null),s.LockedNode==e&&(s.LockedNode=null),e.Inputs.forEach(o=>{var r=o.Links.map(c=>c);r.forEach(c=>{this.DeleteLink(c)})}),e.Outputs.forEach(o=>{var r=o.Links.map(c=>c);r.forEach(c=>{this.DeleteLink(c)})});var n=this.Nodes.indexOf(e);n!=-1&&this.Nodes.splice(n,1),t&&me.PushState(this)}}DeleteSelected(e=!0){this.Nodes.filter(s=>s.IsSelected).forEach(s=>this.DeleteNode(s,!1));var t=he();t.SelectedNode=void 0,this.Links.filter(s=>s.IsSelected).forEach(s=>this.DeleteLink(s,!1)),e&&me.PushState(this)}DeselectAll(){var e=he();e.SelectedNode=void 0,this.Nodes.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1)),this.Links.filter(t=>t.IsSelected).forEach(t=>t.SetSelected(!1))}SelectAll(){this.Nodes.forEach(e=>e.SetSelected(!0))}}const it=Vt("drag",()=>{const i=R(!1),e=R(),t=R(),s=R();function n(r){s.value=r}function o(){return s.value}return{setNode:n,getNode:o,SourceTerminal:e,DestinationTerminal:t,IsDragging:i}}),he=Vt("nodes",()=>{const i=R(),e=R(),t=R();return{SelectedNode:i,LockedNode:e,CurrentGraph:t}}),we=Vt("renderer",()=>{const i=R(!1),e=R(),t=o=>{e.value=o},s=()=>e.value,n=R();return{ChangeEvent:i,Resolution:n,SetRenderer:t,GetRenderer:s}}),Es=W({__name:"HeapMonitor",setup(i){const e=R(0),t=R(0),s=()=>{setInterval(n,1e3)};qe(()=>{s()});const n=()=>{performance&&performance.memory&&(e.value=performance.memory.usedJSHeapSize/1024/1024/1024,t.value=performance.memory.jsHeapSizeLimit/1024/1024/1024)};return(o,r)=>{const c=te("font-awesome-icon"),h=Ne("tooltip");return m(),V("div",{onContextmenu:r[0]||(r[0]=ue(()=>{},["prevent"])),class:"memory-usage"},[F((m(),V("span",null,[v(c,{icon:["fas","memory"]}),H(" "+T(e.value.toFixed(2))+" / "+T(t.value.toFixed(2))+" ",1),r[1]||(r[1]=I("span",null," GB",-1))])),[[h,"Heap memory usage",void 0,{up:!0}]])],32)}}}),Hs=z(Es,[["__scopeId","data-v-72365581"]]),Us={class:"status-bar-grid disable-user-select"},Ws={class:"working-status"},zs=W({__name:"StatusBar",setup(i){we();const e=R(0);return re(()=>e.value),(t,s)=>{const n=te("font-awesome-icon");return m(),V("div",Us,[I("div",Ws,[v(n,{icon:["fas","bars-progress"]}),s[0]||(s[0]=H(" Idle "))]),I("div",null,[v(Hs)])])}}}),Fs=z(zs,[["__scopeId","data-v-ddd0f7cf"]]),qs={class:"collapse"},Zs={class:"carete"},Ks={key:0,class:"collapse-body"},js=W({__name:"Collapse",setup(i){var e=R(!1);const t=()=>{e.value=!e.value};return(s,n)=>{const o=te("font-awesome-icon");return m(),V("div",qs,[I("div",{onClick:t,class:"header"},[I("div",Zs,[Q(e)?(m(),q(o,{key:0,icon:["fas","angle-right"]})):(m(),q(o,{key:1,icon:["fas","angle-down"]}))]),ge(s.$slots,"header",{},void 0,!0)]),Q(e)?ne("",!0):(m(),V("div",Ks,[ge(s.$slots,"default",{},void 0,!0)]))])}}}),Wt=z(js,[["__scopeId","data-v-ed8ad461"]]),et=k(([i])=>{const e=b(i).toVar();e.assign(e.modInt(u(289)));const t=u(u(34).mul(e.x).add(1).mul(e.x).modInt(289).add(e.y)).toVar();return t.assign(u(34).mul(t).add(u(1)).mul(t).modInt(289)),t.assign(Se(t.div(u(41))).mul(u(2)).sub(1)),At(b(t.sub(Ye(t.add(.5))),Ee(t).sub(.5)))}).setLayout({name:"gradientNoiseDir",type:"vec2",inputs:[{name:"p",type:"vec2"}]}),Js=k(([i])=>{const e=b(i).toVar(),t=b(Ye(e)).toVar(),s=b(Se(e)).toVar(),n=u(Ie(et(t),s)).toVar(),o=u(Ie(et(t.add(b(u(0),u(1)))),s.sub(b(u(0),u(1))))).toVar(),r=u(Ie(et(t.add(b(u(1),u(0)))),s.sub(b(u(1),u(0))))).toVar(),c=u(Ie(et(t.add(b(u(1),u(1)))),s.sub(b(u(1),u(1))))).toVar();return s.assign(s.mul(s).mul(s).mul(s.mul(s.mul(u(6)).sub(u(15))).add(u(10)))),B(B(n,o,s.y),B(r,c,s.y),s.x)}).setLayout({name:"gradientNoise",type:"float",inputs:[{name:"p",type:"vec2"}]}),zt=k(([i])=>Js(i).add(.5)),rt=k(([i,e,t,s])=>{const n=le(e).toVar(),o=u(s).toVar(),r=b(t.x,t.y).toVar(),c=b(i.x,i.y).sub(u(.5)).mul(o).toVar();c.addAssign(r);const h=u(0).toVar(),d=u(1).div(2).toVar();return St(n,({i:l})=>{const f=c.mul(u(2).pow(u(l))).toVar(),p=zt(f).mul(d).toVar();d.divAssign(2),h.addAssign(p)}),h}).setLayout({name:"perlinNoise",type:"float",inputs:[{name:"UV",type:"vec2"},{name:"octaves",type:"int"},{name:"offset",type:"vec2"},{name:"scale",type:"float"}]}),Qs=Tt(`
fn cracks(uv: vec2<f32>, angle: f32, scale: f32, thickness: f32) -> f32  {
	let st: vec2<f32> = (uv - 0.5) * scale;
	let i_st: vec2<f32> = floor(st);
	let f_st: vec2<f32> = fract(st);
	var m1: f32 = 1.;
	var m2: f32 = 1.;

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let neighbor: vec2<f32> = vec2<f32>(x, y);
			var point: vec2<f32> = random2(i_st + neighbor);
			point = 0.5 + 0.5 * sin(angle + 6.2831 * point);
			let diff: vec2<f32> = neighbor + point - f_st;
			let dist: f32 = length(diff);
			let cond: f32 = step(dist, m1);
			m2 = mix(min(max(m1, dist), m2), m1, cond);
			m1 = mix(m1, dist, cond);
		}

	}

	let edge: f32 = smoothstep(0.01, thickness, m2 - m1);
	return edge;
} 

fn random2(p: vec2<f32>) -> vec2<f32> {
	return fract(sin(vec2<f32>(dot(p, vec2<f32>(127.1, 311.7)), dot(p, vec2<f32>(269.5, 183.3)))) * 43758.547);
} 
`),ct=Tt(`
fn voronoi(UV: vec2<f32>, angleOffset: f32, cellDensity: f32) -> vec2<f32> {
	let g: vec2<f32> = floor((UV - 0.5) * cellDensity);
	let f: vec2<f32> = fract((UV - 0.5) * cellDensity);
	var res: vec3<f32> = vec3<f32>(8., 0., 0.);

	for (var y: f32 = -1; y <= 1; y = y + 1) {

		for (var x: f32 = -1; x <= 1; x = x + 1) {
			let lattice: vec2<f32> = vec2<f32>(x, y);
			let offset: vec2<f32> = voronoiNoiseRandomVector(lattice + g, angleOffset);
			let d: f32 = distance(lattice + offset, f);
			res = mix(res, vec3<f32>(d, offset.x, offset.y), step(d, res.x));
		}

	}

	return vec2<f32>(res.x, res.y);
} 

fn voronoiNoiseRandomVector(UV: vec2<f32>, offset: f32) -> vec2<f32> {
	var UV_var = UV;
	let m: mat2x2<f32> = mat2x2<f32>(15.27, 47.63, 99.41, 89.98);
	UV_var = fract(sin(UV_var * m) * 46839.32);
	return vec2<f32>(sin(UV_var.y * offset) * 0.5 + 0.5, cos(UV_var.x * offset) * 0.5 + 0.5);
}
`);class en extends j{constructor(){super(...arguments);a(this,"Name","nodes.perlinNoise");a(this,"Outputs",[new G(!1,this,"Output")]);a(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Octaves Count",10,1,50,1,"Noise",""),new P("Offset X",0,-100,100,0,"Transform",""),new P("Offset Y",0,-100,100,0,"Transform",""),new P("Warp Scale",0,0,1,.001,"Warp","%"),new P("Seed",0,0,99999,0,"Random",""),new P("Height",.4,0,1,0,"Noise","")]);a(this,"IsRealtimeUpdate",!0);a(this,"DefaultOutput",0);a(this,"Random",k(([t])=>{const s=b(t).toVar();return Se(pe(Ie(s,b(12.9898,78.233))).mul(43758.5453))}))}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value);x(this.Properties[4].Value);const r=x(this.Properties[5].Value),c=x(this.Properties[6].Value);this.Outputs[0].Value=k(([h])=>{const d=b(h.x,h.y).toVar();return d.addAssign(this.Random(b(r).mul(r))),rt(d,s,b(n,o),t).mul(c)})}}const tn=W({__name:"DraggableNode",props:{GraphNode:{type:Function,required:!0}},setup(i){const e=it(),t=i,s=R(),n=d=>{var f;if((f=d.dataTransfer)==null||f.setData("string","1"),t.GraphNode!=null&&t.GraphNode!=null){var l=t.GraphNode;e.setNode(new l)}};var o=void 0;const r=d=>{var p;o=(p=s.value)==null?void 0:p.cloneNode(!0);var l=o.getBoundingClientRect();if(o.style.position="fixed",o.style.left=`${d.touches[0].pageX-l.width/2}px`,o.style.top=`${d.touches[0].pageY-l.height/2}px`,o.style.zIndex="1000",document.body.appendChild(o),t.GraphNode!=null&&t.GraphNode!=null){var f=t.GraphNode;e.setNode(new f)}},c=d=>{if(o!=null){var l=o.getBoundingClientRect();o.style.left=`${d.touches[0].pageX-l.width/2}px`,o.style.top=`${d.touches[0].pageY-l.height/2}px`}},h=d=>{if(o!=null){document.body.removeChild(o),o=void 0,d.preventDefault(),d.stopPropagation();var l=d.changedTouches[0],f=document.elementFromPoint(l.clientX,l.clientY);console.log(f)}};return window.addEventListener("touchmove",c),window.addEventListener("touchend",h),(d,l)=>(m(),V("div",{onTouchstart:r,onDragstart:n,draggable:"true",class:"node",ref_key:"selfEl",ref:s},[ge(d.$slots,"default",{},void 0,!0)],544))}}),sn=z(tn,[["__scopeId","data-v-ee47cd3c"]]),nn={class:"node-list"},on=W({__name:"NodeList",setup(i){var e=Z.getGroups();return(t,s)=>{const n=te("font-awesome-icon");return m(),V("div",nn,[(m(!0),V(K,null,ye(Q(e),([o,r])=>(m(),V(K,null,[o!=""?(m(),q(Wt,{key:0},{header:L(()=>[H(T(t.$t(o)),1)]),default:L(()=>[(m(!0),V(K,null,ye(r,([c,h])=>(m(),q(sn,{"-graph-node":h},{default:L(()=>[v(n,{icon:["fas","circle-nodes"]}),H(" "+T(t.$t(c)),1)]),_:2},1032,["-graph-node"]))),256))]),_:2},1024)):ne("",!0)],64))),256))])}}}),an=z(on,[["__scopeId","data-v-ff1a0b3e"]]),rn={class:"padding"},ln={class:"header disable-user-select"},un={class:"body disable-user-select"},dn=W({__name:"FrameTab",props:{wheelFocus:{type:Boolean,default:!0}},setup(i){const e=i,t=R(),s=n=>{t.value&&e.wheelFocus&&t.value.focus()};return(n,o)=>(m(),V("div",rn,[I("div",{class:"main",tabindex:"0",ref_key:"selfEl",ref:t,onWheel:s},[I("div",ln,[ge(n.$slots,"header",{},void 0,!0)]),I("div",un,[ge(n.$slots,"default",{},void 0,!0)])],544)]))}}),at=z(dn,[["__scopeId","data-v-1982f366"]]);class Me extends j{constructor(){super(...arguments);a(this,"Name","nodes.buffer");a(this,"Inputs",[new G(!0,this,"")]);a(this,"Outputs",[new G(!1,this,"")])}Calculate(){this.BaseCalculate();var t=this.Inputs[0].Links[0].In,s=this.Outputs[0];s.Value=t==null?void 0:t.Value}}class mt{constructor(e,t,s,n){a(this,"X",0);a(this,"Y",0);a(this,"Height",0);a(this,"Width",0);this.X=e,this.Y=t,this.Height=s,this.Width=n}ContainsRect(e){return this.X<=e.X&&e.X+e.Width<=this.X+this.Width&&this.Y<=e.Y&&e.Y+e.Height<=this.Y+this.Height}ContainsPoint(e,t){return this.X<=e&&e<this.X+this.Width&&this.Y<=t&&t<this.Y+this.Height}IntersectsWith(e){return e.X<this.X+this.Width&&this.X<e.X+e.Width&&e.Y<this.Y+this.Height&&this.Y<e.Y+e.Height}static Intersects(e,t){return e.X<t.X+t.Width&&t.X<e.X+e.Width&&e.Y<t.Y+t.Height&&t.Y<e.Y+e.Height}}const cn=W({__name:"ContextMenu",props:{CloseOnAnyClick:{type:Boolean,default:!0},CloseOnMouseOut:{type:Boolean,default:!0}},emits:["lost-focus"],setup(i,{expose:e,emit:t}){const s=R(!1),n=R(),o=t,r=i,c=w=>{s.value=!0,Ve(()=>{n.value!=null&&n.value!=null&&(n.value.style.left=w.pageX+"px",n.value.style.top=w.pageY+"px",d(),window.addEventListener("mousedown",g))})},h=w=>{Ve(()=>{n.value!=null&&(n.value.style.width=w+"px")})},d=()=>{if(n.value!=null&&n.value!=null){const S=n.value.getBoundingClientRect();if(S.y+S.height>window.innerHeight){var w=S.y+S.height-window.innerHeight;n.value.style.top=S.y-w+"px"}if(S.y<0&&(n.value.style.top="0px"),S.x+S.width>window.innerWidth){var w=S.x+S.width-window.innerWidth;n.value.style.left=S.x-w+"px"}S.x<0&&(n.value.style.left="0px")}},l=w=>{s.value=!0,Ve(()=>{if(n.value!=null&&n.value!=null){var S=w.getBoundingClientRect();n.value.style.left=S.x+"px",n.value.style.top=S.y+S.height+"px",d(),window.addEventListener("mousedown",g)}})},f=w=>{s.value=!0,Ve(()=>{if(n.value!=null&&n.value!=null){var S=w.getBoundingClientRect(),N=n.value.getBoundingClientRect();n.value.style.left=S.x-N.width+"px",n.value.style.top=S.y+"px",d(),window.addEventListener("mousedown",g)}})},p=w=>{s.value=!0,Ve(()=>{if(n.value!=null&&n.value!=null){var S=w.getBoundingClientRect();n.value.style.left=S.x+S.width+"px",n.value.style.top=S.y+"px",d(),window.addEventListener("mousedown",g)}})},y=()=>{window.removeEventListener("mousedown",g),s.value=!1},g=w=>{if(r.CloseOnMouseOut&&n.value!=null){var S=n.value.getBoundingClientRect(),N=new mt(S.x,S.y,S.height,S.width);N.ContainsPoint(w.clientX,w.clientY)||(s.value=!1,window.removeEventListener("mousedown",g),o("lost-focus"))}};return e({Open:c,Close:y,OpenUnder:l,OpenLeft:f,OpenRight:p,SetWidth:h,isOpened:s}),(w,S)=>(m(),q(Jt,{name:"open"},{default:L(()=>[(m(),q(jt,{to:"body"},[s.value?(m(),V("div",{key:0,onContextmenu:S[0]||(S[0]=ue(()=>{},["prevent"])),onMousedown:S[1]||(S[1]=ue(()=>{},["stop"])),ref_key:"ContextMenu",ref:n,class:"context-menu disable-user-select"},[ge(w.$slots,"default",{},void 0,!0)],544)):ne("",!0)]))]),_:3}))}}),lt=z(cn,[["__scopeId","data-v-bc41e1a3"]]);class Ot{static pathExists(e,t){if(e===t)return!0;const s=new Set;return this.dfs(e,t,s)}static dfs(e,t,s){if(e===t)return!0;if(s.has(e))return!1;s.add(e);for(const n of e.Outputs)for(const o of n.Links)if(o.Out!=null&&o.Out!=null){const r=o.Out.ParentNode;if(this.dfs(r,t,s))return!0}return!1}}const hn=W({__name:"TerminalRenderer",props:{Term:{type:G,required:!0}},setup(i,{expose:e}){const t=it(),s=i,n=l=>{t.SourceTerminal=s.Term,t.IsDragging=!0,window.addEventListener("mouseup",o)},o=l=>{var g,w,S;window.removeEventListener("mouseup",o),t.IsDragging=!1;var f=t.DestinationTerminal,p=t.SourceTerminal;if(f!=null&&f!=p&&!(p!=null&&p.IsInput&&f.IsInput)&&(p==null?void 0:p.ParentNode)!=f.ParentNode){if(p!=null&&p.IsInput){if(Ot.pathExists(p==null?void 0:p.ParentNode,f.ParentNode))return;p.Links.forEach(N=>{var M,X;(X=(M=p==null?void 0:p.ParentNode)==null?void 0:M.ParentGraph)==null||X.DeleteLink(N)})}if(f.IsInput){if(Ot.pathExists(f==null?void 0:f.ParentNode,p==null?void 0:p.ParentNode))return;f.Links.forEach(N=>{var M,X;(X=(M=f==null?void 0:f.ParentNode)==null?void 0:M.ParentGraph)==null||X.DeleteLink(N)})}(w=(g=s.Term.ParentNode)==null?void 0:g.ParentGraph)==null||w.AddLink(f,p);var y=we();(S=s.Term.ParentNode)!=null&&S.IsRealtimeUpdate&&(y.ChangeEvent=!y.ChangeEvent)}},r=l=>{t.IsDragging&&(t.DestinationTerminal=s.Term)},c=l=>{t.IsDragging&&(t.DestinationTerminal=null)},h=R();qe(()=>{Ve(()=>{d()})});const d=()=>{var p,y,g,w;var l=((p=h.value)==null?void 0:p.offsetLeft)+((y=h.value)==null?void 0:y.offsetWidth)/2+2,f=((g=h.value)==null?void 0:g.offsetTop)+((w=h.value)==null?void 0:w.offsetHeight)/2+2;s.Term.SetOffset(l,f)};return e({SetOffset:d}),(l,f)=>{const p=Ne("tooltip");return F((m(),V("div",{class:Oe(["node-terminal",{connected:s.Term.IsConnected},"disable-user-select"]),onMousedown:[f[0]||(f[0]=ue(()=>{},["right","stop"])),ue(n,["left"])],onMouseover:r,onMouseleave:c,ref_key:"selfEl",ref:h},null,34)),[[p,{content:s.Term.Name,placement:s.Term.IsInput?"left":"right"}]])}}}),Lt=z(hn,[["__scopeId","data-v-278bc81c"]]),fn=W({__name:"ContextMenuItem",props:{Active:{type:Boolean,default:!1}},setup(i){return(e,t)=>(m(),V("button",{class:Oe([["btn",{active:i.Active}],"btn"]),style:{padding:"5px"}},[ge(e.$slots,"default",{},void 0,!0)],2))}}),ce=z(fn,[["__scopeId","data-v-3e13e567"]]),pn={},mn={class:"loader"};function vn(i,e){return m(),V("span",mn)}const Ft=z(pn,[["render",vn],["__scopeId","data-v-8c5c5c6f"]]),gn={class:"node-container"},wn={class:"node-terminals left"},Vn={class:"node-center"},yn={class:"node-name"},Sn={class:"node-terminals right"},_n=W({__name:"NodeRenderer",props:{Offset:{type:O,required:!0},Zoom:{type:Number,required:!0},Node:{type:j,required:!0},AllNodes:{type:Array,default:new Array}},setup(i){Rt(_=>({"0ab3956c":h.value,"2f84f68e":d.value}));var e=i;const t=R(),s=Fe("contextMenu"),n=Fe("terminals");qe(()=>{window.addEventListener("mousemove",de),window.addEventListener("mouseup",M),Ve(()=>{var _=e.Node,C=t.value;if(_.SetSize(C.offsetHeight,C.offsetWidth),_.Move(_.Position.X-_.Width/2,_.Position.Y-_.Height/2),t!=null){var D=new ResizeObserver(y);D.observe(t.value)}})});const o=R(new O(0,0)),r=R(!1),c=re(()=>{var _=he();return _.LockedNode==e.Node});re(()=>{var _=e.Node.Position.Y;return _+"px"}),re(()=>{var _=e.Node.Position.X;return _+"px"});const h=re(()=>r.value?"grabbing":"default"),d=re(()=>e.Node.IsSelected?"1":"0"),l=re(()=>{var _=he(),C=_.LockedNode;return C!=null&&C==e.Node}),f=_=>{var C;(C=s.value)==null||C.Open(_)},p=()=>{var _;(_=s.value)==null||_.Close()},y=()=>{var _;n.value!=null&&((_=n.value)==null||_.forEach(C=>{C==null||C.SetOffset()}))},g=()=>{var _=he(),C=we();_.LockedNode==e.Node?_.LockedNode=null:(_.LockedNode=e.Node,e.Node.SetSelected(!0),C.ChangeEvent=!C.ChangeEvent)},w=(_,C,D)=>{var $,Y,E,ae,se;if(r.value=!0,o.value.X=_,o.value.Y=C,D)e.Node.SetSelected(!(($=e.Node)!=null&&$.IsSelected));else{var A=(Y=e.Node.ParentGraph)==null?void 0:Y.Nodes.filter(ie=>ie.IsSelected);A.length>1?e.Node.IsSelected==!1&&((E=e.Node.ParentGraph)==null||E.DeselectAll(),e.Node.SetSelected(!0)):((ae=e.Node.ParentGraph)==null||ae.DeselectAll(),e.Node.SetSelected(!0))}(se=e.Node.ParentGraph)==null||se.Nodes.filter(ie=>ie.IsSelected).forEach(ie=>{ie.SetLastPosition(ie.Position.X,ie.Position.Y)}),me.PushState(e.Node.ParentGraph)},S=_=>{if(n.value!=null&&n.value.some(A=>A.$el==_.target||A==_.target))return;let C=_.touches[0].clientX,D=_.touches[0].clientY;w(C,D,!1)},N=_=>{n.value!=null&&n.value.some(C=>C.$el==_.target||C==_.target)||w(_.clientX,_.clientY,_.shiftKey)},M=_=>{r.value=!1},X=_=>{r.value=!1},ee=_=>{let C=_.touches[0].clientX,D=_.touches[0].clientY;fe(C,D)},fe=(_,C)=>{var $;if(r.value){var D=(_-o.value.X)/e.Zoom,A=(C-o.value.Y)/e.Zoom;($=e.Node.ParentGraph)==null||$.Nodes.filter(Y=>Y.IsSelected).forEach(Y=>{Y.Move(Y.LastPosition.X+D,Y.LastPosition.Y+A)})}},de=_=>{fe(_.clientX,_.clientY)};return(_,C)=>{const D=te("font-awesome-icon"),A=Ne("tooltip");return m(),V("div",{class:Oe([{node:!(i.Node instanceof Q(Me))},{"node-buffer":i.Node instanceof Q(Me)},"disable-user-select",{"not-calculated":i.Node.CalculationState==Q(ke).NotCalculated&&!(i.Node instanceof Q(Me))},{selected:i.Node.IsSelected},{lockedPreview:c.value},{"node-without-inputs":i.Node.Inputs.length==0}]),style:Qt({top:Q(e).Node.Position.Y+"px",left:Q(e).Node.Position.X+"px"}),ref_key:"rootEl",ref:t,onMousedown:[ue(N,["left"]),ue(f,["right"])],onTouchmove:ee,onTouchstart:S,onTouchend:X},[I("div",gn,[I("div",wn,[(m(!0),V(K,null,ye(i.Node.Inputs,$=>(m(),q(Lt,{ref_for:!0,ref_key:"terminals",ref:n,key:$.Guid,Term:$},null,8,["Term"]))),128))]),I("div",Vn,[i.Node instanceof Q(Me)?ne("",!0):(m(),V(K,{key:0},[F((m(),V("a",{class:"lock-icon",onClick:C[0]||(C[0]=$=>g())},[l.value?(m(),q(D,{key:0,icon:["fas","lock"]})):(m(),q(D,{key:1,icon:["fas","lock-open"]}))])),[[A,{content:_.$t("tt.lockPreview"),placement:"bottom"}]]),I("div",yn,T(_.$t(i.Node.Name)),1),i.Node.CalculationState==Q(ke).Calculation?(m(),q(Ft,{key:0})):ne("",!0)],64))]),I("div",Sn,[(m(!0),V(K,null,ye(i.Node.Outputs,$=>(m(),q(Lt,{ref_for:!0,ref_key:"terminals",ref:n,key:$.Guid,Term:$},null,8,["Term"]))),128))])]),v(lt,{ref_key:"contextMenu",ref:s,CloseOnAnyClick:!0},{default:L(()=>[v(ce,null,{default:L(()=>[v(D,{icon:["far","copy"]}),H(" "+T(_.$t("tt.copy")),1)]),_:1}),v(ce,{onClick:C[1]||(C[1]=$=>{var Y,E;(Y=i.Node.ParentGraph)==null||Y.DeleteNode(i.Node),(E=i.Node.ParentGraph)==null||E.DeleteSelected(),p()}),style:{color:"var(--vt-c-red)"}},{default:L(()=>[v(D,{icon:["far","trash-can"]}),H(" "+T(_.$t("tt.delete")),1)]),_:1}),C[3]||(C[3]=I("hr",null,null,-1)),v(ce,{onClick:C[2]||(C[2]=$=>{g(),p()})},{default:L(()=>[l.value?(m(),q(D,{key:0,icon:["fas","lock"]})):(m(),q(D,{key:1,icon:["fas","lock-open"]})),l.value?(m(),V(K,{key:2},[H("  "+T(_.$t("tt.unlockPreview")),1)],64)):(m(),V(K,{key:3},[H("  "+T(_.$t("tt.lockPreview")),1)],64))]),_:1})]),_:1,__:[3]},512)],38)}}}),bn=z(_n,[["__scopeId","data-v-2f5df3e5"]]),xn={},Pn={class:"canvas",xmlns:"http://www.w3.org/2000/svg"};function In(i,e){return m(),V("svg",Pn,[ge(i.$slots,"default",{},void 0,!0)])}const Cn=z(xn,[["render",In],["__scopeId","data-v-81940268"]]),Nn=["points"],Mn=W({computed:{Points(){var t,s,n,o,r,c;var i=O.Add((s=(t=this.Link.In)==null?void 0:t.ParentNode)==null?void 0:s.Position,(n=this.Link.In)==null?void 0:n.OffsetPosition),e=O.Add((r=(o=this.Link.Out)==null?void 0:o.ParentNode)==null?void 0:r.Position,(c=this.Link.Out)==null?void 0:c.OffsetPosition);return`${i.X},${i.Y} ${i.X+20},${i.Y} ${e.X-20},${e.Y} ${e.X},${e.Y}`}}}),kn=W({...Mn,__name:"LinkRenderer",props:{Link:{type:Ht,required:!0}},setup(i){const e=i,t=()=>{e.Link.SetSelected(!0)},s=n=>{var d;var o=e.Link.In,r=e.Link.Out;if(!(o==null||r==null)){var c=new Me;c.Move(n.offsetX,n.offsetY);var h=(d=o.ParentNode)==null?void 0:d.ParentGraph;h!=null&&(h.DeleteLink(e.Link),h.AddNode(c),h.AddLink(o,c.Inputs[0]),h.AddLink(c.Outputs[0],r))}};return(n,o)=>(m(),V("polyline",{onClick:t,onDblclick:s,points:n.Points,class:Oe(["line",{selected:e.Link.IsSelected}])},null,42,Nn))}}),On=z(kn,[["__scopeId","data-v-a61d9acd"]]),Ln={},$n={class:"tool-bar-container"};function Rn(i,e){return m(),V("div",$n,[ge(i.$slots,"default",{},void 0,!0)])}const vt=z(Ln,[["render",Rn],["__scopeId","data-v-b20ca96b"]]),Dn={},Tn={class:"tool-bar-body"};function An(i,e){return m(),V("div",Tn,[ge(i.$slots,"default")])}const be=z(Dn,[["render",An]]),Gn={key:0,class:"selection-box"},Xn={class:"offset-container",ref:"offset_container"},Bn=["points"],Yn={key:1,style:{"pointer-events":"none",height:"100%",width:"100%",padding:"30px",position:"absolute"}},En={style:{display:"flex","justify-content":"center","align-items":"center",height:"100%",width:"100%","border-radius":"50px",border:"4px dashed var(--vt-c-black-mute)",color:"var(--vt-c-black-mute)"}},Hn={style:{"font-size":"50px","font-weight":"bold","text-shadow":"0px 0px 20px black"}},Un=W({props:{MinScale:{type:Number,default:.5},MaxScale:{type:Number,default:2}},data(){return{Offset:new O(0,0),SelectionBox:new mt(0,0,0,0),SelectionBoxVisibility:!1,LastMouse:new O(0,0),LastOffset:new O(0,0),Zoom:1,isDragging:!1,_Graph:new pt,dragStore:it(),points:"",GridSize:20,isDragOver:!1}},computed:{Nodes:function(){return this._Graph.Nodes},OffsetXStyle:function(){return this.Offset.X+"px"},OffsetYStyle:function(){return this.Offset.Y+"px"},EditorCursor:function(){return this.isDragging?"grabbing":"default"},SelectionBoxX:function(){return this.SelectionBox.X+"px"},SelectionBoxY:function(){return this.SelectionBox.Y+"px"},SelectionBoxHeight:function(){return this.SelectionBox.Height+"px"},SelectionBoxWidth:function(){return this.SelectionBox.Width+"px"},OffsetStyle:function(){var i=this.GridSize/2*this.Zoom;return this.Offset.X-i+"px "+(this.Offset.Y-i)+"px"},ScaleGridStyle:function(){var i=(this.GridSize*this.Zoom).toString();return`${i}px ${i}px`}},created(){window.addEventListener("mousemove",this.OnMouseMove),window.addEventListener("mouseup",this.OnMouseUp)},mounted(){this.$nextTick(()=>{var t;this.$el;var i=((t=this.$parent)==null?void 0:t.$el).parentElement;i!=null&&(i.onkeydown=this.KeysHandler),this._Graph=new pt;var e=he();e.CurrentGraph=this._Graph})},methods:{SaveGraph(){var i=Be.Serialize(this._Graph),e=JSON.stringify(i);console.log(e);var t=JSON.parse(e);console.log(t);var s=Be.Deserialize(t);console.log(s)},Undo(){var i=me.PopState();i!=null&&(this._Graph=i)},Redo(){var i=me.UnpopState();i!=null&&(this._Graph=i)},isChild(i,e){for(var t=e.parentNode;t!=null;){if(t==i)return!0;t=t.parentNode}return!1},dragenter(){this.isDragOver=!0},dragleave(i){var e=this.$el,t=i.target;this.isChild(e,t)||(this.isDragOver=!1)},drop(i){this.isDragOver=!1;var e=it(),t=e.getNode();if(t!=null){var s=this.$refs.editor,n=s.getBoundingClientRect();if(n!=null){me.PushState(this._Graph);var o=O.Div(new O(i.clientX-n.x-this.Offset.X,i.clientY-n.y-this.Offset.Y),this.Zoom);t==null||t.Move(o.X,o.Y),this._Graph.AddNode(t)}}},KeysHandler(i){i.key=="Delete"&&(me.PushState(this._Graph),this._Graph.DeleteSelected())},UpdateOffsetStyle(){var i=this.$refs.offset_container;i.style.left=this.OffsetXStyle,i.style.top=this.OffsetYStyle,i.style.scale=this.Zoom.toString()},OnMouseDownLeft:function(i){this.DrawGhostLine(i),i.target==this.$refs.editor&&(this.LastMouse=new O(i.clientX,i.clientY),this.SelectionBox.X=0,this.SelectionBox.Y=0,this.SelectionBox.Width=0,this.SelectionBox.Height=0,this.SelectionBoxVisibility=!0,this._Graph.DeselectAll())},OnMouseDownMiddle:function(i){this.isDragging=!0,this.LastMouse=new O(i.clientX,i.clientY),this.LastOffset={...this.Offset}},OnMouseMove:function(i){if(this.isDragging){i.preventDefault();var e=i.clientX-this.LastMouse.X,t=i.clientY-this.LastMouse.Y;this.Offset.X=this.LastOffset.X+e,this.Offset.Y=this.LastOffset.Y+t,this.UpdateOffsetStyle()}if(this.SelectionBoxVisibility){i.preventDefault();var s=new O(i.clientX,i.clientY),n=new O(Math.min(this.LastMouse.X,s.X),Math.min(this.LastMouse.Y,s.Y)),o=new O(Math.abs(this.LastMouse.X-s.X),Math.abs(this.LastMouse.Y-s.Y)),r=this.$refs.editor,c=r.getBoundingClientRect();this.SelectionBox.X=n.X-c.left,this.SelectionBox.Y=n.Y-c.top,this.SelectionBox.Width=o.X,this.SelectionBox.Height=o.Y,this._Graph.Nodes.forEach(h=>{var d=new mt(this.Offset.X+h.Position.X*this.Zoom,this.Offset.Y+h.Position.Y*this.Zoom,h.Height*this.Zoom,h.Width*this.Zoom);this.SelectionBox.IntersectsWith(d)?h.SetSelected(!0):h.SetSelected(!1)})}this.DrawGhostLine(i)},OnMouseUp:function(i){this.isDragging=!1,this.SelectionBoxVisibility=!1},OnWheel:function(i){let t=this.$refs.editor.getBoundingClientRect(),s=i.deltaY*.001,n=this.Zoom;this.Zoom=this.Clamp(this.Zoom-s,this.MinScale,this.MaxScale);let o=new O(i.clientX-t.left,i.clientY-t.top),r=(n-this.Zoom)/n;this.Offset=O.Add(this.Offset,O.Mul(O.Sub(o,this.Offset),r)),this.UpdateOffsetStyle()},DisableContextMenu(i){i.preventDefault()},Clamp:function(i,e,t){return Math.min(Math.max(i,e),t)},DrawGhostLine(i){var h;if(this.dragStore.IsDragging){var e=this.$refs.editor,t=e.getBoundingClientRect();if(i.preventDefault(),t!=null){var s=this.dragStore.SourceTerminal,n=O.Add((h=s.ParentNode)==null?void 0:h.Position,s.OffsetPosition),o=O.Div(new O(i.clientX-t.x-this.Offset.X,i.clientY-t.y-this.Offset.Y),this.Zoom),r=s.IsInput?o:n,c=s.IsInput?n:o;this.points=`${r.X},${r.Y} ${r.X+20},${r.Y} ${c.X-20},${c.Y} ${c.X},${c.Y}`}}}}}),Wn=W({...Un,__name:"GraphRenderer",setup(i){return Rt(e=>({db6f8752:e.EditorCursor,"37abfe34":e.SelectionBoxY,"37abfe36":e.SelectionBoxX,d162664c:e.SelectionBoxHeight,"682fa09a":e.SelectionBoxWidth,"98be67d6":e.ScaleGridStyle,b4c3d5ac:e.OffsetStyle})),(e,t)=>{const s=te("font-awesome-icon"),n=Ne("tooltip");return m(),V("div",{class:"graph-renderer dot",ref:"editor",onWheel:t[4]||(t[4]=(...o)=>e.OnWheel&&e.OnWheel(...o)),onMousedown:[t[5]||(t[5]=ue((...o)=>e.OnMouseDownLeft&&e.OnMouseDownLeft(...o),["left"])),t[6]||(t[6]=ue((...o)=>e.OnMouseDownMiddle&&e.OnMouseDownMiddle(...o),["middle"]))],onContextmenu:ue(()=>!1,["prevent","right"]),onDragover:t[7]||(t[7]=ue(()=>{},["prevent"])),onDragenter:t[8]||(t[8]=(...o)=>e.dragenter&&e.dragenter(...o)),onDragleave:t[9]||(t[9]=(...o)=>e.dragleave&&e.dragleave(...o)),onDrop:t[10]||(t[10]=(...o)=>e.drop&&e.drop(...o))},[v(vt,{class:"top-left"},{default:L(()=>[v(be,null,{default:L(()=>[F((m(),V("a",{onClick:t[0]||(t[0]=o=>e.Undo())},[v(s,{icon:["fas","rotate-left"]})])),[[n,e.$t("tt.undo"),void 0,{bottom:!0}]]),F((m(),V("a",{onClick:t[1]||(t[1]=o=>e.Redo())},[v(s,{icon:["fas","rotate-right"]})])),[[n,e.$t("tt.redo"),void 0,{bottom:!0}]])]),_:1}),v(be,null,{default:L(()=>[F((m(),V("a",null,[v(s,{icon:["far","copy"]})])),[[n,e.$t("tt.copy"),void 0,{bottom:!0}]]),F((m(),V("a",null,[v(s,{icon:["far","paste"]})])),[[n,e.$t("tt.paste"),void 0,{bottom:!0}]]),F((m(),V("a",{class:Oe([{disabled:!e._Graph.HasSelected}]),style:{color:"var(--vt-c-red)"},onClick:t[2]||(t[2]=o=>e._Graph.DeleteSelected())},[v(s,{icon:["far","trash-can"]})],2)),[[n,e.$t("tt.delete"),void 0,{bottom:!0}]])]),_:1}),v(be,null,{default:L(()=>[F((m(),V("a",null,[v(s,{icon:["fas","expand"]})])),[[n,e.$t("tt.fullscreen"),void 0,{bottom:!0}]])]),_:1})]),_:1}),v(vt,{class:"bottom-left"},{default:L(()=>[v(be,null,{default:L(()=>[I("span",null,[e.Zoom<1?(m(),q(s,{key:0,icon:["fas","magnifying-glass-minus"]})):(m(),q(s,{key:1,icon:["fas","magnifying-glass-plus"]})),H(" "+T((e.Zoom*100).toFixed(0))+"%",1)])]),_:1}),v(be,null,{default:L(()=>[I("span",null,[v(s,{icon:["fas","up-down-left-right"]}),H(" X: "+T(e.Offset.X.toFixed())+" Y: "+T(e.Offset.Y.toFixed()),1)])]),_:1}),v(be,null,{default:L(()=>[F((m(),V("a",{onClick:t[3]||(t[3]=o=>{e.Offset.Reset(),e.Zoom=1,e.UpdateOffsetStyle()})},[v(s,{icon:["fas","arrows-rotate"]})])),[[n,e.$t("tt.resetView")]])]),_:1}),v(be,null,{default:L(()=>[I("span",null,[v(s,{icon:["fas","circle-info"]}),H(" "+T(e.$t("hints.graphLmb")),1)])]),_:1}),v(be,null,{default:L(()=>[I("span",null,[v(s,{icon:["fas","circle-info"]}),H(" "+T(e.$t("hints.graphWheel")),1)])]),_:1})]),_:1}),e.SelectionBoxVisibility?(m(),V("div",Gn)):ne("",!0),I("div",Xn,[v(Cn,{id:"links-container"},{default:L(()=>[v(It,{name:"link"},{default:L(()=>[(m(!0),V(K,null,ye(e._Graph.Links,o=>(m(),q(On,{key:o.Id,Link:o},null,8,["Link"]))),128))]),_:1}),e.dragStore.IsDragging?(m(),V("polyline",{key:0,class:"ghost-line",points:e.points},null,8,Bn)):ne("",!0)]),_:1}),v(It,{name:"delete",tag:"div"},{default:L(()=>[(m(!0),V(K,null,ye(e.Nodes,o=>(m(),q(bn,{key:o.Id,Offset:e.Offset,Zoom:e.Zoom,Node:o},null,8,["Offset","Zoom","Node"]))),128))]),_:1})],512),e.isDragOver?(m(),V("div",Yn,[I("div",En,[I("span",Hn,T(e.$t("hints.placeHere")),1)])])):ne("",!0)],544)}}}),zn=z(Wn,[["__scopeId","data-v-eed6edd1"]]),Fn={style:{height:"100%",display:"flex","flex-direction":"row"}},qn={style:{"margin-left":"5px"}},Zn={style:{"margin-left":"5px"}},Kn=W({__name:"EditorView",setup(i){return(e,t)=>{const s=te("font-awesome-icon");return m(),V("div",Fn,[v(at,{style:{width:"20%","min-width":"300px"}},{header:L(()=>[v(s,{icon:["fas","list"]}),t[0]||(t[0]=H()),I("span",qn,T(e.$t("windows.nodesList")),1)]),default:L(()=>[v(an)]),_:1}),v(at,{style:{width:"80%"}},{header:L(()=>[v(s,{icon:["fas","circle-nodes"]}),t[1]||(t[1]=H()),I("span",Zn,T(e.$t("windows.graph")),1)]),default:L(()=>[v(zn)]),_:1})])}}}),jn={style:{display:"flex","flex-direction":"row"}},Jn={style:{width:"100%","font-weight":"bold","text-align":"left","margin-left":"10px"}},Qn={style:{width:"100%","font-weight":"bold","text-align":"right","margin-right":"10px"}},eo={style:{width:"10px","margin-right":"10px"}},to={key:0,class:"dropdown"},so=["onClick"],no=W({__name:"SelectDropdown",props:{options:{type:Array,required:!1,default:[]},title:{type:String,required:!1,default:""},default:{type:String,required:!1,default:null},modelValue:{type:String,default:""},RealtimeChange:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(i,{emit:e}){R(!1);const t=i,s=R(t.default?t.default:t.options.length>0?t.options[0]:null),n=R(!1);ze(()=>t.modelValue,r=>{s.value=r});const o=()=>{var r=we();t.RealtimeChange&&(r.ChangeEvent=!r.ChangeEvent)};return(r,c)=>{const h=te("font-awesome-icon");return m(),V("div",{class:"dropdown-head input-element value",tabindex:"0",onBlur:c[1]||(c[1]=d=>n.value=!1),style:{width:"100%",position:"relative"}},[I("div",{onClick:c[0]||(c[0]=d=>n.value=!n.value),style:{height:"100%"}},[I("div",jn,[I("div",Jn,T(t.title)+T(t.title==""?"":":"),1),I("div",Qn,T(s.value),1),I("div",eo,[n.value?(m(),q(h,{key:1,icon:["fas","angle-up"]})):(m(),q(h,{key:0,icon:["fas","angle-down"]}))])])]),n.value?(m(),V("ul",to,[(m(!0),V(K,null,ye(i.options,(d,l)=>(m(),V("li",{class:Oe({selected:d==s.value}),key:l,onClick:f=>{s.value=d,n.value=!1,r.$emit("update:modelValue",s.value),o()}},T(d),11,so))),128))])):ne("",!0)],32)}}}),oo=z(no,[["__scopeId","data-v-61887904"]]),io=W({__name:"LangSwitch",setup(i){const e=gt(),t=R("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);const s=h=>{e!=null&&(e.appContext.config.globalProperties.$i18n.locale=h,localStorage.setItem("userLang",h),t.value=h)},n=Fe("langContextMenu"),o=R(),r=h=>{var d;(o!=null||o!=null)&&((d=n.value)==null||d.OpenUnder(o.value))};var c=new Map;return c.set("en","English"),c.set("ru","Русский"),(h,d)=>{const l=te("flag");return m(),V(K,null,[I("button",{ref_key:"langSwitchBtn",ref:o,class:"btn disable-user-select",onClick:r},[v(l,{iso:t.value=="en"?"gb":t.value},null,8,["iso"]),H(" "+T(Q(c).get(t.value)),1)],512),v(lt,{ref:"langContextMenu"},{default:L(()=>[I("button",{class:"btn btnContextMenuPadding",onClick:d[0]||(d[0]=f=>{var p;s("ru"),(p=n.value)==null||p.Close()})},[v(l,{iso:"ru"}),d[2]||(d[2]=H(" Русский"))]),I("button",{class:"btn btnContextMenuPadding",onClick:d[1]||(d[1]=f=>{var p;s("en"),(p=n.value)==null||p.Close()})},[v(l,{iso:"gb"}),d[3]||(d[3]=H(" English"))])]),_:1},512)],64)}}}),ao=W({__name:"ToggleButton",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(i){const e=Dt(i,"modelValue");return(t,s)=>(m(),V("button",{class:Oe(["btn",{toggled:e.value}]),onClick:s[0]||(s[0]=n=>e.value=!e.value)},[ge(t.$slots,"default",{},void 0,!0)],2))}}),ro=z(ao,[["__scopeId","data-v-4a53f642"]]),lo=W({__name:"ResolutionSwitcher",setup(i){const e=gt(),t=R("English");e!=null&&(t.value=e.appContext.config.globalProperties.$i18n.locale);var s=we();const n=Fe("contextMenu"),o=R(),r=f=>{var y,g,w;if(o!=null||o!=null){var p=(y=o.value)==null?void 0:y.getBoundingClientRect();(g=n.value)==null||g.OpenUnder(o.value),p!=null&&((w=n.value)==null||w.SetWidth(p.width))}},c=["0.5K","1K","2K","4K","8K"],h=[512,1024,2048,4096,8192],d=R(0),l=f=>{d.value=f;var p=s.GetRenderer();p!=null&&(p.ChangeResolution(h[f]),requestAnimationFrame(()=>p==null?void 0:p.Render()))};return(f,p)=>{const y=te("font-awesome-icon"),g=Ne("tooltip");return m(),V(K,null,[F((m(),V("button",{ref_key:"switcher",ref:o,class:"btn disable-user-select",onClick:r},[v(y,{icon:["fas","vector-square"]}),H(" "+T(c[d.value])+" ",1),v(y,{icon:["fas","angle-down"]})])),[[g,f.$t("tt.mesh_resolution"),void 0,{bottom:!0}]]),v(lt,{ref_key:"contextMenu",ref:n},{default:L(()=>[(m(),V(K,null,ye(c,(w,S)=>(m(),V(K,null,[S>2?F((m(),q(ce,{key:0,class:"waringText",Active:S==d.value,onClick:N=>{var M;l(S),(M=n.value)==null||M.Close()}},{default:L(()=>[v(y,{icon:["fas","vector-square"]}),H(" "+T(w),1)]),_:2},1032,["Active","onClick"])),[[g,{content:f.$t("tt.resolutionWarning"),html:!0,distance:15},void 0,{right:!0}]]):(m(),q(ce,{key:1,Active:S==d.value,onClick:N=>{var M;l(S),(M=n.value)==null||M.Close()}},{default:L(()=>[v(y,{icon:["fas","vector-square"]}),H(" "+T(w),1)]),_:2},1032,["Active","onClick"]))],64))),64))]),_:1},512)],64)}}}),$t=z(lo,[["__scopeId","data-v-97dd3ce3"]]),uo={style:{height:"100%",width:"100%",position:"relative"}},co=["value"],ho=W({__name:"ProjectNameEditor",props:Ct({modelValue:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:Ct(["update:modelValue"],["update:modelValue"]),setup(i,{emit:e}){const t=Dt(i,"modelValue"),s=e,n=R(!1),o=R(),r=R(),c=()=>{n.value=!0,Ve(()=>{var f;r.value=t.value,(f=o.value)==null||f.focus()})},h=f=>{s("update:modelValue",r.value),n.value=!1},d=f=>{f.target!=null&&(r.value=f.target.value,s("update:modelValue",r.value))},l=f=>{f.key=="Enter"&&(f.target!=null&&(r.value=f.target.value,s("update:modelValue",r.value)),n.value=!1)};return(f,p)=>{const y=te("font-awesome-icon");return m(),V("div",uo,[n.value?(m(),V("input",{key:0,ref_key:"input",ref:o,onFocusout:h,onInput:d,onKeypress:l,class:"editor",value:t.value},null,40,co)):(m(),V("div",{key:1,class:"label",onClick:c},T(t.value),1)),v(y,{class:"icon",icon:["fas","pen"]})])}}}),fo=z(ho,[["__scopeId","data-v-1b5ff080"]]),po={style:{"margin-left":"auto",right:"0px",height:"100%","white-space":"nowrap",overflow:"hidden"}},mo={class:"btn"},vo={class:"btn"},go={class:"btn"},wo={class:"btn"},Vo={class:"btn"},yo={class:"btn"},So={class:"btn"},_o={class:"btn"},bo=450,xo=W({__name:"ActionButtonsBar",setup(i){const e=R(),t=Fe("contextMenu"),s=R(),n=R(),o=he(),r=d=>{var l;(s!=null||s!=null)&&((l=t.value)==null||l.OpenUnder(s.value))},c=()=>{var f;var d=(f=e.value)==null?void 0:f.getBoundingClientRect();if(d!=null){var l=d==null?void 0:d.width;l!=null&&l<bo?n.value=!0:n.value=!1}};qe(()=>{Ve(()=>{c(),window.addEventListener("resize",()=>{c()})})});const h=()=>{if(o.CurrentGraph!=null){var d=Be.Serialize(o.CurrentGraph),l=JSON.stringify(d),f=document.createElement("a"),p=new Blob([l],{type:"text/plain"});f.href=URL.createObjectURL(p),f.download="untitled.json",f.click()}};return(d,l)=>{const f=te("font-awesome-icon"),p=Ne("tooltip");return m(),V("div",{ref_key:"menuContainer",ref:e,style:{display:"flex",height:"100%",width:"100%","white-space":"nowrap",overflow:"hidden"}},[I("div",po,[n.value?(m(),V(K,{key:0},[v($t),l[4]||(l[4]=I("div",{class:"separator"},null,-1)),F((m(),V("button",{onClick:r,ref_key:"contextMenuButton",ref:s,class:"btn"},[v(f,{icon:["fas","fa-bars"]})])),[[p,d.$t("tt.menu"),void 0,{bottom:!0}]]),v(lt,{ref_key:"contextMenu",ref:t},{default:L(()=>[v(ce,null,{default:L(()=>[v(f,{icon:["fas","file"]}),H(" "+T(d.$t("tt.new")),1)]),_:1}),v(ce,null,{default:L(()=>[v(f,{icon:["fas","floppy-disk"]}),H(" "+T(d.$t("tt.save")),1)]),_:1}),v(ce,null,{default:L(()=>[v(f,{icon:["fas","folder-open"]}),H(" "+T(d.$t("tt.load")),1)]),_:1}),l[1]||(l[1]=I("hr",null,null,-1)),v(ce,null,{default:L(()=>[v(f,{icon:["fas","rotate-left"]}),H(" "+T(d.$t("tt.undo")),1)]),_:1}),v(ce,null,{default:L(()=>[v(f,{icon:["fas","rotate-right"]}),H(" "+T(d.$t("tt.redo")),1)]),_:1}),l[2]||(l[2]=I("hr",null,null,-1)),v(ce,null,{default:L(()=>[v(f,{icon:["fas","gear"]}),H(" "+T(d.$t("tt.settings")),1)]),_:1}),l[3]||(l[3]=I("hr",null,null,-1)),v(ce,null,{default:L(()=>[v(f,{icon:["fas","expand"]}),H(" "+T(d.$t("tt.fullscreen")),1)]),_:1})]),_:1,__:[1,2,3]},512),l[5]||(l[5]=I("div",{class:"separator"},null,-1)),F((m(),V("button",mo,[v(f,{icon:["fas","rotate-left"]})])),[[p,d.$t("tt.undo"),void 0,{bottom:!0}]]),F((m(),V("button",vo,[v(f,{icon:["fas","rotate-right"]})])),[[p,d.$t("tt.redo"),void 0,{bottom:!0}]])],64)):(m(),V(K,{key:1},[v($t),l[6]||(l[6]=I("div",{class:"separator"},null,-1)),F((m(),V("button",go,[v(f,{icon:["fas","file"]})])),[[p,d.$t("tt.new"),void 0,{bottom:!0}]]),F((m(),V("button",{onClick:l[0]||(l[0]=y=>h()),class:"btn"},[v(f,{icon:["fas","floppy-disk"]})])),[[p,d.$t("tt.save"),void 0,{bottom:!0}]]),F((m(),V("button",wo,[v(f,{icon:["fas","folder-open"]})])),[[p,d.$t("tt.load"),void 0,{bottom:!0}]]),l[7]||(l[7]=I("div",{class:"separator"},null,-1)),F((m(),V("button",Vo,[v(f,{icon:["fas","rotate-left"]})])),[[p,d.$t("tt.undo"),void 0,{bottom:!0}]]),F((m(),V("button",yo,[v(f,{icon:["fas","rotate-right"]})])),[[p,d.$t("tt.redo"),void 0,{bottom:!0}]]),l[8]||(l[8]=I("div",{class:"separator"},null,-1)),F((m(),V("button",So,[v(f,{icon:["fas","gear"]})])),[[p,d.$t("tt.settings"),void 0,{bottom:!0}]]),F((m(),V("button",_o,[v(f,{icon:"fa-solid fa-hammer"})])),[[p,d.$t("tt.build"),void 0,{bottom:!0}]]),l[9]||(l[9]=I("div",{class:"separator"},null,-1)),F((m(),q(ro,null,{default:L(()=>[v(f,{icon:["fas","expand"]})]),_:1})),[[p,d.$t("tt.fullscreen"),void 0,{bottom:!0}]])],64))])],512)}}}),Po=z(xo,[["__scopeId","data-v-be3370e1"]]),Io={class:"disable-user-select left-section",style:{display:"flex","flex-direction":"row"}},Co={class:"logo disable-user-select",style:{"text-transform":"uppercase"}},No={class:"padding"},Mo={class:"middle-actions",style:{}},ko={style:{display:"flex","flex-direction":"row"}},Oo=W({__name:"MainMenuBar",setup(i){const e=R(!1);ze(e,(s,n)=>{s?document.documentElement.requestFullscreen():document.exitFullscreen()});const t=R("Untitled");return(s,n)=>(m(),V("div",{class:"main",onContextmenu:n[1]||(n[1]=ue(()=>{},["prevent"]))},[I("div",Io,[I("div",Co,T(s.$t("logo")),1),v(Po)]),I("div",No,[I("div",Mo,[v(fo,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=o=>t.value=o)},null,8,["modelValue"])])]),I("div",ko,[v(io)])],32))}}),Lo=z(Oo,[["__scopeId","data-v-58738f50"]]);class $o{constructor(e,t,s){a(this,"R",0);a(this,"G",0);a(this,"B",0);this.R=e,this.G=t,this.B=s}}const Ro={ref:"inputRange",class:"input-range"},Do=["value"],To={class:"title"},Ao={class:"valueText"},Go=W({props:{Min:Number,Max:Number,Suffix:String,Title:String,RealtimeChange:{type:Boolean,default:!0},Step:{type:Number,default:0},modelValue:{type:Number,default:0}},emits:["update:modelValue"],data(){return{IsDragging:!1,Value:0,lastPosition:new O(0,0),lastValue:0,IsInputVisible:!1,moveDistance:0}},created(){document.addEventListener("mousemove",this.OnMouseMove),document.addEventListener("mouseup",this.OnMouseUp),this.Value=this.modelValue},watch:{modelValue(i,e){this.Value=i}},methods:{ClickValue(i){this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+i,this.Min,this.Max):this.Value=this.Clamp(this.Value+(i>0?this.Step:-this.Step),this.Min,this.Max):this.Step==0?this.Value+=i:this.Value+=i>0?this.Step:-this.Step,this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnInput(i){this.Value=Number(i.target.value),this.Min!=null&&this.Max!=null&&(this.Value=this.Clamp(this.Value,this.Min,this.Max)),this.$emit("update:modelValue",this.Value),this.UpdateEvent()},OnMouseDown(i){this.IsInputVisible||(this.$el.requestPointerLock(),this.IsDragging=!0,this.lastPosition=new O(i.clientX,i.clientY),this.lastValue=this.Value,this.moveDistance=0)},OnMouseMove(i){this.IsDragging&&(this.moveDistance+=i.movementX,this.Min!=null&&this.Max!=null?this.Step==0?this.Value=this.Clamp(this.Value+i.movementX/(i.shiftKey?25:50),this.Min,this.Max):i.movementX!=0&&Math.abs(this.moveDistance)>=(i.shiftKey?25:50)&&(this.moveDistance=0,this.Value=this.Clamp(this.Value+(i.movementX>0?this.Step:-this.Step),this.Min,this.Max)):this.Step==0?this.Value+=i.movementX/(i.shiftKey?25:50):i.movementX!=0&&Math.abs(this.moveDistance)>=(i.shiftKey?25:50)&&(this.moveDistance=0,this.Value+=i.movementX>0?this.Step:-this.Step),this.$emit("update:modelValue",this.Value),this.UpdateEvent())},OnMouseUp(i){var e=new O(i.clientX,i.clientY);e.X==this.lastPosition.X&&e.Y==this.lastPosition.Y&&this.Value==this.lastValue&&(this.IsInputVisible=!0,this.$nextTick(()=>{var t=this.$refs.input;t.focus(),t.select()})),this.IsDragging=!1,document.exitPointerLock()},UpdateEvent(){var i=we();this.RealtimeChange&&(i.ChangeEvent=!i.ChangeEvent)},validate(i){i.key=="Enter"&&i.target.blur();var e=/[0-9-]|\./;e.test(i.key)||i.preventDefault()},Clamp(i,e,t){return Math.min(Math.max(i,e),t)}}}),Xo=W({...Go,__name:"InputRange",setup(i){return(e,t)=>{const s=te("font-awesome-icon");return m(),V("div",Ro,[I("div",{class:"button",onClick:t[0]||(t[0]=n=>e.ClickValue(-.1))},[v(s,{icon:["fas","caret-left"]})]),I("div",{class:"value",onMousedown:t[4]||(t[4]=ue((...n)=>e.OnMouseDown&&e.OnMouseDown(...n),["left"]))},[e.IsInputVisible?(m(),V("input",{key:0,onKeypress:t[1]||(t[1]=(...n)=>e.validate&&e.validate(...n)),ref:"input",class:"input-element",value:e.modelValue,onInput:t[2]||(t[2]=(...n)=>e.OnInput&&e.OnInput(...n)),onBlur:t[3]||(t[3]=n=>e.IsInputVisible=!1)},null,40,Do)):(m(),V(K,{key:1},[I("div",To,T(e.Title)+": ",1),I("div",Ao,T(Number(e.Value.toFixed(4)))+" "+T(e.Suffix),1)],64))],32),I("div",{class:"button",onClick:t[5]||(t[5]=n=>e.ClickValue(.1))},[v(s,{icon:["fas","caret-right"]})])],512)}}}),Bo=z(Xo,[["__scopeId","data-v-5ba96ddd"]]),Yo={class:"properties"},Eo={key:0,class:"not-selected"},Ho={class:"header"},Uo={style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},Wo={class:"buttons",style:{display:"flex","font-weight":"bold"}},zo={class:"btn"},Fo={key:0,style:{margin:"0px 10px"}},qo={class:"input-group",style:{width:"100%",padding:"0px"}},Zo={key:1,style:{padding:"10px"}},Ko={class:"notice"},jo=W({__name:"PropertiesView",setup(i){const e=he();R(new $o(0,0,1));var t=re(()=>e.SelectedNode),s=re(()=>e.SelectedNode==null||e.SelectedNode instanceof Me),n=re(()=>{var c;return r((c=t.value)==null?void 0:c.Properties)});const o=()=>{if(e.SelectedNode!=null&&e.SelectedNode!=null&&e.SelectedNode){for(var c of e.SelectedNode.Properties)c.Reset();var h=we();h.ChangeEvent=!h.ChangeEvent}};var r=c=>{var h=new Map;return c==null||c.length==0||c.forEach(d=>{var l;h.has(d.Category)||h.set(d.Category,new Array),(l=h.get(d.Category))==null||l.push(d)}),h};return(c,h)=>{var f;const d=te("font-awesome-icon"),l=Ne("tooltip");return m(),V("div",Yo,[Q(s)?(m(),V("div",Eo,[v(d,{icon:["fas","sliders"]})])):ne("",!0),Q(s)?ne("",!0):(m(),V(K,{key:1},[I("div",Ho,[I("div",Uo,T(c.$t((f=Q(t))==null?void 0:f.Name)),1),I("div",Wo,[F((m(),V("button",zo,[v(d,{icon:["fas","sliders"]})])),[[l,c.$t("tt.presets"),void 0,{bottom:!0}]]),F((m(),V("button",{class:"btn",onClick:o},[v(d,{icon:["fas","arrows-rotate"]})])),[[l,c.$t("tt.resetParams"),void 0,{bottom:!0}]])])]),Q(t).Name?(m(),V("hr",Fo)):ne("",!0),(m(!0),V(K,null,ye(Q(n),([p,y])=>(m(),q(Wt,{style:{"background-color":"transparent",padding:"0px"}},{header:L(()=>[H(T(p),1)]),default:L(()=>[I("div",qo,[(m(!0),V(K,null,ye(y,g=>(m(),V(K,null,[typeof g.Value=="number"?(m(),q(Bo,{key:0,modelValue:g.Value,"onUpdate:modelValue":w=>g.Value=w,Min:g.Min,Max:g.Max,Step:g.Step,Suffix:g.Suffix,Title:g.Name},null,8,["modelValue","onUpdate:modelValue","Min","Max","Step","Suffix","Title"])):ne("",!0),g.valueList!=null?(m(),q(oo,{key:1,modelValue:g.Value,"onUpdate:modelValue":w=>g.Value=w,default:g.Value,title:g.Name,options:g.valueList},null,8,["modelValue","onUpdate:modelValue","default","title","options"])):ne("",!0)],64))),256))])]),_:2},1024))),256)),Q(t).IsRealtimeUpdate==!1?(m(),V("div",Zo,[h[1]||(h[1]=I("button",{class:"btn apply-btn"}," Apply changes ",-1)),I("div",Ko,[v(d,{icon:["fas","circle-exclamation"]}),h[0]||(h[0]=H(' This node performs a heavy operation, so the update occurs when you click the "Apply Changes" button and is cached. '))])])):ne("",!0)],64))])}}}),Jo=z(jo,[["__scopeId","data-v-46464937"]]);class Qo{constructor(){a(this,"GridMaterial");a(this,"GridMesh");const e=u(.5).toVar(),t=u(5).toVar(),s=u(1*window.devicePixelRatio).toVar(),n=u(500).toVar(),o=u(200).toVar(),r=ht(.2,.2,.2,.2).toVar(),c=ht(.05,.05,.05,.2).toVar(),h=us,d=ds,l=k(([D,A])=>{const $=ft(D,A),Y=Ee(U(Se(U($,.5)),.5)),E=ft(Y,Gt($));return oe(E.x,E.y)}),f=l(h.xz,e),p=l(h.xz,t),y=U(1,We(0,s,f)),g=U(1,We(0,s,p)),w=U(h,d),S=st(w),N=We(u(n),u(0),S),M=We(u(o),u(0),S),X=J(r,J(y,M)).toVar(),ee=J(c,J(g,N)).toVar(),fe=cs(ee,X),de=new Xt;de.colorNode=fe,de.transparent=!0,de.side=_t,de.lights=!1;const _=new Bt(1e3,1e3,1,1);_.rotateX(-Math.PI/2);const C=new bt(_,de);this.GridMesh=C,this.GridMaterial=de}}class ei{constructor(){a(this,"Mesh");const e=k(([o,r,c])=>{const h=b(o.x,o.y).toVar(),d=b(Ee(h.mul(2).sub(1)).sub(b(r,c))).toVar();return d.assign(u(1).sub(d.div(Gt(d)))),hs(oe(d.x,d.y))});var t=new fs({color:"#fff",transparent:!0,side:_t});t.colorNode=k(()=>{const o=e(je(),1,1).toVar(),r=e(je(),.9,1).toVar(),c=e(je(),1,.9).toVar(),h=e(je(),.98,.98).toVar(),d=Ce(0,1,o.sub(r).sub(c).sub(h)).toVar();return ht(.8,.8,.8,d)})();var s=new Bt(1,1,1,1);s.rotateX(-Math.PI/2);var n=new bt(s,t);n.castShadow=!1,n.receiveShadow=!1,n.scale.set(10,1,10),n.position.set(0,.005,0),this.Mesh=n}}class ti{static async Generate(e=1,t=1,s=1,n=1){var o=new ps;const r=e/2,c=t/2,h=Math.floor(s),d=Math.floor(n),l=h+1,f=d+1,p=e/h,y=t/d,g=[],w=[],S=[],N=[];for(let M=0;M<f;M++){const X=M*y-c;for(let ee=0;ee<l;ee++){const fe=ee*p-r;w.push(fe,-X,0),S.push(0,0,1),N.push(ee/h),N.push(1-M/d)}await new Promise(ee=>setTimeout(ee,0))}for(let M=0;M<d;M++){for(let X=0;X<h;X++){const ee=X+l*M,fe=X+l*(M+1),de=X+1+l*(M+1),_=X+1+l*M;g.push(ee,fe,_),g.push(fe,de,_)}await new Promise(X=>setTimeout(X,0))}return o.setIndex(g),o.setAttribute("position",new ut(w,3)),o.setAttribute("normal",new ut(S,3)),o.setAttribute("uv",new ut(N,2)),o}}class si{constructor(){a(this,"Height",2);a(this,"GPURenderer");a(this,"HeightTexture");a(this,"TerrainMaterial");a(this,"IsMeshGenerated",R(!0));a(this,"Scene");a(this,"Camera");a(this,"Controls");a(this,"TerrainMesh");a(this,"GridMesh");a(this,"DirectionalLight");a(this,"DirectionalLight2");a(this,"_resolution",512);a(this,"_textureResolution",512);a(this,"_canvas");a(this,"_isColorized",!1);this.CreateRenderer(),this.Scene=new ms,this.Scene.environmentNode=vs("#ffffff"),this.Scene.environmentIntensity=.05,this.Camera=new gs(75,1,.01,1e3),this.Camera.position.z=10,this.Camera.position.y=10,this.CreateMaterial(),this.CreateTexture(this._resolution),this.CreateTerrainMesh(this.Resolution),this.CreateLight();const e=new Qo;this.GridMesh=e.GridMesh,this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2),this.Scene.add(this.GridMesh);var t=new ei;this.Scene.add(t.Mesh);const s=we();s.SetRenderer(this),s.Resolution=this.Resolution}get Resolution(){return this._resolution}get TextureResolution(){return this._textureResolution}CreateMaterial(){this.TerrainMaterial=new Xt({color:"#a2a2a2"}),this.TerrainMaterial.side=_t,this.TerrainMaterial.needsUpdate=!0,this.TerrainMaterial.metalness=0,this.TerrainMaterial.roughness=1,this.TerrainMaterial.positionNode=k(()=>{const e=u(1/this.Resolution),t=u(1).sub(e).toVar(),s=Te.xyz.toVar(),n=Je(this.HeightTexture,Te.xz.add(.5).mul(t)).mul(this.Height);return s.y.addAssign(n),s})(),this.TerrainMaterial.normalNode=k(()=>{const e=u(1/this.TextureResolution).toVar(),t=u(1).sub(e).toVar(),s=Te.xyz.add(Nt(e,0,0)).toVar(),n=Te.xyz.add(Nt(0,0,e.negate())).toVar(),o=Te.xyz.toVar(),r=Je(this.HeightTexture,Te.xz.add(.5).mul(t)).mul(this.Height);o.y.addAssign(r),s.y.addAssign(Je(this.HeightTexture,s.xz.add(.5)).mul(t).mul(this.Height)),n.y.addAssign(Je(this.HeightTexture,n.xz.add(.5)).mul(t).mul(this.Height));const c=s.sub(o).normalize(),h=n.sub(o).normalize();return ws(Vs(c,h))})()}CreateRenderer(){this.GPURenderer=new ys({alpha:!0,antialias:!0}),this.GPURenderer.shadowMap.enabled=!0,this.GPURenderer.shadowMap.type=Ss,this.GPURenderer.toneMapping=_s,this.GPURenderer.setClearColor(0,0),this.GPURenderer.setPixelRatio(window.devicePixelRatio)}CreateTexture(e){this.HeightTexture=new bs(Math.floor(this.TextureResolution),Math.floor(this.TextureResolution)),this.HeightTexture.format=xs,this.HeightTexture.type=Ps}CreateLight(){const e=new Mt(16777215,2);e.position.set(-10,10,0),e.castShadow=!0,e.shadow.autoUpdate=!0,e.shadow.camera.near=.1,e.shadow.camera.far=30,e.shadow.camera.top=8,e.shadow.camera.right=8,e.shadow.camera.bottom=-8,e.shadow.camera.left=-8,e.shadow.mapSize.set(8192,8192),e.shadow.radius=5,e.shadow.blurSamples=25,e.shadow.normalBias=.05,this.DirectionalLight=e;const t=new Mt(16777215,.5);t.position.set(10,10,0),this.DirectionalLight2=t}SetIsMeshGenerated(e){this.IsMeshGenerated.value=e}CreateTerrainMesh(e){this.SetIsMeshGenerated(!1),ti.Generate(1,1,e,e).then(t=>{t.rotateX(-Math.PI/2),this.TerrainMesh=new bt(t,this.TerrainMaterial),this.TerrainMesh.castShadow=!0,this.TerrainMesh.receiveShadow=!0,this.TerrainMesh.scale.set(10,1,10),this.TerrainMesh.position.set(0,.006,0),this.Scene.add(this.TerrainMesh),this.SetIsMeshGenerated(!0)})}ChangeResolution(e){this._textureResolution=e,this.TerrainMaterial.dispose(),this.HeightTexture.dispose(),this.CreateTexture(this.TextureResolution),this.CreateMaterial(),this.TerrainMesh.material=this.TerrainMaterial,this.Scene.remove(this.DirectionalLight),this.Scene.remove(this.DirectionalLight2),this.DirectionalLight.dispose(),this.DirectionalLight2.dispose(),this.CreateLight(),this.Scene.add(this.DirectionalLight),this.Scene.add(this.DirectionalLight2);const t=we();t.Resolution=this.TextureResolution;const s=he();s.LockedNode!=null?this.Recalculate(s.LockedNode):s.SelectedNode!=null&&this.Recalculate(s.SelectedNode),requestAnimationFrame(()=>this.Render())}OnWindowResize(){if(this.GPURenderer==null||this.Camera==null||this._canvas==null)return;var e=this._canvas.offsetHeight,t=this._canvas.offsetWidth;this.GPURenderer.setSize(t,e);const s=t/e;this.Camera.aspect=s,this.Camera.updateProjectionMatrix(),requestAnimationFrame(()=>this.Render())}async Render(){await this.GPURenderer.renderAsync(this.Scene,this.Camera)}Mount(e){this._canvas=e;var t=this._canvas.offsetHeight,s=this._canvas.offsetWidth;this._canvas.appendChild(this.GPURenderer.domElement),this.GPURenderer.setSize(s,t),this.Camera.aspect=s/t,this.Controls=new Is(this.Camera,this.GPURenderer.domElement),this.Controls.enablePan=!1,this.Controls.update(),window.addEventListener("resize",()=>this.OnWindowResize()),this.Render(),requestAnimationFrame(()=>this.Render)}RequestRender(){requestAnimationFrame(()=>this.Render)}async Recalculate(e,t=!1){if(this.IsMeshGenerated.value==!1)return;t||e.Calculate();var s=e.Outputs[e.DefaultOutput].Value;const o=k(()=>{const r=xe.modInt(this.TextureResolution),c=xe.div(this.TextureResolution),h=tt(r,c),d=b(h.x,h.y).div(this.TextureResolution).toVar(),l=s(d).toVar();l.assign(Ce(l,0,1)),Cs(this.HeightTexture,h,l).toWriteOnly()})().compute(this.TextureResolution*this.TextureResolution);this.GPURenderer.computeAsync(o).then(()=>{e.CalculationState=ke.Calculated,requestAnimationFrame(()=>this.Render())})}SetGridVisible(e){this.GridMesh.visible=e,requestAnimationFrame(()=>this.Render())}}const ni={class:"container"},oi={key:0,style:{position:"relative",height:"100%",width:"100%"}},ii=W({__name:"Preview3D",setup(i){const e=R();e.value=new si;const t=R();var s=we();const n=re(()=>s.ChangeEvent);var o=he();const r=re(()=>o.SelectedNode),c=re(()=>{var w;return(w=e.value)==null?void 0:w.IsMeshGenerated});ze(c,async(w,S)=>{requestAnimationFrame(()=>{var N;return(N=e.value)==null?void 0:N.Render()})}),ze(n,async(w,S)=>{var N,M;o.LockedNode!=null?(N=e.value)==null||N.Recalculate(o.LockedNode,!1):r.value!=null&&((M=e.value)==null||M.Recalculate(r.value,!1))}),ze(r,async w=>{var N,M;if(o.LockedNode!=null)(N=e.value)==null||N.Recalculate(o.LockedNode);else if(w!=null){var S=w;await((M=e.value)==null?void 0:M.Recalculate(S))}}),qe(()=>{Ve(()=>{var w;(w=e.value)==null||w.Mount(t.value)})});let h=!1;const d=()=>{h=!0},l=()=>{h=!1};window.addEventListener("mouseup",l),window.addEventListener("pointerup",l);const f=()=>{h&&requestAnimationFrame(()=>{var w;return(w=e.value)==null?void 0:w.Render()})},p=()=>{requestAnimationFrame(()=>{var w;return(w=e.value)==null?void 0:w.Render()})},y=R(!0),g=()=>{var w;y.value=!y.value,(w=e.value)==null||w.SetGridVisible(y.value)};return(w,S)=>{var X;const N=te("font-awesome-icon"),M=Ne("tooltip");return m(),V("div",ni,[(X=e.value)!=null&&X.IsMeshGenerated?ne("",!0):(m(),V("div",oi,[v(Ft,{style:{scale:"2"}}),S[0]||(S[0]=I("span",{style:{position:"absolute !important",top:"calc(50% + 20px)",width:"100%","text-align":"center"}}," Initializing mesh...",-1))])),I("div",{onMousedown:d,onMousemove:f,onWheel:p,onPointerdown:d,onPointermove:f,ref_key:"canvas",ref:t,style:{height:"100%",width:"100%"}},[v(vt,{class:"top-left"},{default:L(()=>[v(be,null,{default:L(()=>[F((m(),V("a",{onClick:g},[v(N,{icon:["fas","hashtag"]})])),[[M,"Switch Grid visibility",void 0,{bottom:!0}]])]),_:1})]),_:1})],544)])}}}),ai=z(ii,[["__scopeId","data-v-f4b894cd"]]),ri={style:{width:"100%",height:"100%"}},li={style:{height:"calc(100% - 80px)",display:"flex","flex-direction":"row"}},ui={style:{width:"80%",height:"100%"}},di={style:{height:"50%",width:"100%",display:"block"}},ci={style:{"margin-left":"5px"}},hi={style:{height:"50%"}},fi={style:{width:"20%",height:"100%"}},pi={style:{"margin-left":"5px"}},mi=W({__name:"LayoutView",setup(i){return(e,t)=>{const s=te("font-awesome-icon");return m(),V("div",ri,[v(Lo,{style:{height:"50px"}}),I("div",li,[I("div",ui,[I("div",di,[v(at,{style:{display:"inline-block",width:"100%"}},{header:L(()=>[v(s,{icon:["fas","mountain-sun"]}),I("span",ci,T(e.$t("windows.thirdPreview")),1)]),default:L(()=>[v(ai)]),_:1})]),I("div",hi,[v(Kn)])]),I("div",fi,[v(at,{style:{width:"100%"},"wheel-focus":!1},{header:L(()=>[v(s,{icon:["fas","sliders"]}),I("span",pi,T(e.$t("windows.properties")),1)]),default:L(()=>[v(Jo)]),_:1})])]),v(Fs,{style:{height:"30px"}})])}}}),vi=z(mi,[["__scopeId","data-v-415e308f"]]),gi=es({history:ts("/"),routes:[{path:"/",name:"home",component:vi}]});class wi extends j{constructor(){super(...arguments);a(this,"Name","nodes.clamp");a(this,"Inputs",[new G(!0,this,"Source")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Min",0,0,1),new P("Max",1,0,1)]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value);this.Outputs[0].Value=k(([n])=>{var r;if(!this.Inputs[0].IsConnected)return u(0);const o=(r=this.Inputs[0].Links[0].In)==null?void 0:r.Value(n);return Ce(o,t,s)})}}class Vi extends j{constructor(){super(...arguments);a(this,"Name","nodes.combine");a(this,"Inputs",[new G(!0,this,"Source 1"),new G(!0,this,"Source 2")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Mode","Burn",["Burn","Darken","Difference","Dodge","Divide","Exclusion","HardLight","HardMix","Lighten","LinearBurn","LinearDodge","LinearLight","LinearLightAddSub","Multiply","Negation","Overlay","PinLight","Screen","SoftLight","Subtract","VividLight","Overwrite"]),new P("Strength",0,0,100,0,"","%")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=this.Properties[0].Value,s=x(this.Properties[1].Value);this.Outputs[0].Value=k(([n])=>{var h,d;if(!this.Inputs[0].IsConnected||!this.Inputs[1].IsConnected)return u(0);const o=(h=this.Inputs[0].Links[0].In)==null?void 0:h.Value(n).toVar(),r=(d=this.Inputs[1].Links[0].In)==null?void 0:d.Value(n).toVar(),c=s.mul(.01);switch(t){case"Burn":{const l=u(1).sub(u(1).sub(r).div(o)).toVar();return B(o,l,c)}case"Darken":{const l=oe(o,r).toVar();return B(o,l,c)}case"Difference":{const l=Ee(r.sub(o)).toVar();return B(o,l,c)}case"Dodge":{const l=o.div(r.add(u(1e-12))).toVar();return B(o,l,c)}case"Divide":{const l=o.div(u(1).sub(r)).toVar();return B(o,l,c)}case"Exclusion":{const l=r.add(o).sub(u(2).mul(r).mul(o)).toVar();return B(o,l,c)}case"HardLight":{const l=u(U(1,J(2,U(1,o)).mul(U(1,r)))).toVar(),f=u(J(2,o).mul(r)).toVar(),p=u(Ae(r,.5)).toVar(),y=u(f.mul(p).add(u(1).sub(p).mul(l))).toVar();return B(o,y,c)}case"HardMix":{const l=u(Ae(u(1).sub(o),r)).toVar();return B(o,l,c)}case"Lighten":{const l=ve(r,o).toVar();return B(o,l,c)}case"LinearBurn":{const l=u(o.add(r.sub(1))).toVar();return B(o,l,c)}case"LinearDodge":{const l=o.add(r).toVar();return B(o,l,c)}case"LinearLight":{const l=u(Ms(r.lessThan(.5),ve(o.add(u(2).mul(r).sub(u(1))),u(0)),oe(o.add(u(2).mul(r.sub(.5))),u(1)))).toVar();return B(o,l,c)}case"LinearLightAddSub":{const l=u(r.add(J(2,o).sub(1))).toVar();return B(o,l,c)}case"Multiply":{const l=o.mul(r).toVar();return B(o,l,c)}case"Negation":{const l=u(U(1,Ee(U(1,r).sub(o)))).toVar();return B(o,l,c)}case"Overlay":{const l=u(U(1,J(2,U(1,o)).mul(U(1,r)))).toVar(),f=u(J(2,o).mul(r)).toVar(),p=u(Ae(o,.5)).toVar(),y=u(f.mul(p).add(u(1).sub(p).mul(l))).toVar();return B(o,y,c)}case"PinLight":{const l=u(Ae(.5,r)).toVar(),f=u(l.mul(ve(J(2,o.sub(.5)),r))).toVar(),p=u(f.add(U(1,l).mul(oe(J(2,o),r)))).toVar();return B(o,p,c)}case"Screen":{const l=u(U(1,U(1,r).mul(U(1,o)))).toVar();return B(o,l,c)}case"SoftLight":{const l=u(U(1,J(2,U(1,o)).mul(U(1,r)))).toVar(),f=u(Ns(o).mul(J(2,r).sub(1)).add(J(2,o).mul(U(1,r)))).toVar(),p=u(Ae(r,.5)).toVar(),y=u(f.mul(p).add(u(1).sub(p).mul(l))).toVar();return B(o,y,c)}case"Subtract":{const l=o.sub(r).toVar();return B(o,l,c)}case"VividLight":{const l=u(U(1,U(1,r).div(J(2,o)))).toVar(),f=u(r.div(J(2,U(1,o)))).toVar(),p=u(Ae(.5,o)).toVar(),y=u(f.mul(p).add(u(1).sub(p).mul(l))).toVar();return B(o,y,c)}case"Overwrite":return B(o,r,c)}return u(0)})}}class yi extends j{constructor(){super(...arguments);a(this,"Name","nodes.constant");a(this,"Outputs",[new G(!1,this,"Output")]);a(this,"Properties",[new P("Height",0,0,1)]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=k(([s])=>u(t))}}class Si extends j{constructor(){super(...arguments);a(this,"Name","nodes.cracks");a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Scale",10,0,100,0,"Transform","%"),new P("Angle",0,0,100,0,"Noise",""),new P("Thickness",.03,0,1,0,"Noise",""),new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value),r=x(this.Properties[4].Value),c=x(this.Properties[5].Value),h=x(this.Properties[6].Value),d=x(this.Properties[7].Value);this.Outputs[0].Value=k(([l])=>{const f=b(l.x,l.y).toVar(),p=b(rt(f.mul(2).mul(.5),r,b(h,d),c)).mul(o).mul(.2);return Qs({uv:f.add(p),angle:s,scale:t,thickness:n})})}}const _i=k(([i,e,t])=>{const s=u(t).toVar(),n=u(e).toVar(),o=u(i).toVar();s.assign(ve(0,s));const r=u(ve(0,oe(1,n.sub(o).add(s).div(u(2).mul(s))))).toVar();return o.mul(r).add(n.mul(u(1).sub(r)).sub(s.mul(r).mul(u(1).sub(r))))}).setLayout({name:"smoothMin",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),bi=k(([i,e,t])=>{const s=u(t).toVar(),n=u(e).toVar(),o=u(i).toVar();s.assign(oe(0,s.negate()));const r=u(ve(0,oe(1,n.sub(o).add(s).div(u(2).mul(s))))).toVar();return o.mul(r).add(n.mul(u(1).sub(r)).sub(s.mul(r).mul(u(1).sub(r))))}).setLayout({name:"smoothMax",type:"float",inputs:[{name:"a",type:"float"},{name:"b",type:"float"},{name:"k",type:"float"}]}),xi=k(([i])=>{const e=b(i).toVar();return Se(pe(Ie(e.xy,b(12.9898,78.233))).mul(43758.5453123))}).setLayout({name:"random",type:"float",inputs:[{name:"st",type:"vec2"}]}),Pi=k(([i,e,t])=>{const s=u(t).toVar(),n=u(e).toVar(),o=b(i).toVar(),r=b(o.mul(n)).toVar(),c=b(Ye(r)).toVar(),h=b(Se(r)).toVar(),d=u(xi(c).mul(2).sub(1).mul(s)).toVar(),l=u(pe(d)).toVar(),f=u(nt(d)).toVar(),p=b(h.sub(.5)).toVar(),y=b().toVar();return y.x.assign(p.x.mul(f).sub(p.y.mul(l))),y.y.assign(p.x.mul(l).add(p.y.mul(f))),y.add(.5).add(c).mod(1)}).setLayout({name:"tilingWithLimitedRotation",type:"vec2",inputs:[{name:"uv",type:"vec2"},{name:"tileCount",type:"float"},{name:"maxAngle",type:"float"}]});class Ii extends j{constructor(){super(...arguments);a(this,"Name","nodes.crater");a(this,"Outputs",[new G(!1,this,"Output")]);a(this,"Properties",[new P("Smoothness",.5,0,1,0,"Crater params",""),new P("FloorHeight",-1,-5,5,0,"Crater params",""),new P("Radius",.16,0,1,0,"Crater params",""),new P("RimWidth",1.35,0,100,0,"Crater params",""),new P("RimSteepness",4,0,100,0,"Crater params",""),new P("X",.5,0,1,0,"Transform",""),new P("Y",.5,0,1,0,"Transform","")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value),r=x(this.Properties[4].Value),c=x(this.Properties[5].Value),h=x(this.Properties[6].Value);this.Outputs[0].Value=k(([d])=>{const l=b(d.x,d.y).toVar(),f=b(c,h).toVar(),p=u(st(l.sub(f)).div(ve(n,1e-4))).toVar(),y=u(p.mul(p).sub(1)).toVar(),g=u(oe(p.sub(1).sub(o),0)).toVar(),w=u(r.mul(g).mul(g)).toVar(),S=u(bi(y,s,t)).toVar();return S.assign(_i(S,w,t)),S.mul(n).add(.5).toVar()})}}class Ci extends j{constructor(){super(...arguments);a(this,"Name","nodes.fake");a(this,"Position",new O(1e3,1e3))}}class Ni extends j{constructor(){super(...arguments);a(this,"Name","nodes.falloff");a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Strength",0,0,10)]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=k(([s])=>{const n=b(s.x,s.y).toVar(),o=u(Yt(b(.5),n.mod(1))).mul(t).toVar(),r=B(u(1),u(0),o).toVar();return ot(Ce(r,0,1),2)})}}class Mi extends j{constructor(){super(...arguments);a(this,"Name","nodes.fastErosion");a(this,"Inputs",[new G(!0,this,"Inpute Height")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Tiles",4,0,20,0,"Erosion",""),new P("Octaves",5,0,20,1,"Erosion",""),new P("Gain",.5,0,1,0,"Erosion",""),new P("Lacunarity",2,0,10,0,"Erosion",""),new P("Slope strength",3,0,10,0,"Erosion",""),new P("Branch strength",3,0,10,0,"Erosion",""),new P("Erosion Strength",.04,0,1,0,"Erosion","")]);a(this,"IsRealtimeUpdate",!1);a(this,"terrainHeight");a(this,"waterVolume");a(this,"sedimentAmount");a(this,"tempTerrainHeight");a(this,"tempWaterVolume");a(this,"tempSedimentAmount")}Calculate(){this.BaseCalculate();const t=we(),s=t.GetRenderer(),n=t.Resolution,o=x(.1),r=x(.1),c=x(.1),h=x(1),d=x(.1),l=x(.1),f=x(9.8),p=x(.01),y=x(3),g=x(n),w=x(n);this.terrainHeight=Ge(n*n,"float"),this.waterVolume=Ge(n*n,"float"),this.sedimentAmount=Ge(n*n,"float"),this.tempTerrainHeight=Ge(n*n,"float"),this.tempWaterVolume=Ge(n*n,"float"),this.tempSedimentAmount=Ge(n*n,"float");const S=k(()=>{var $;const _=xe.modInt(n),C=xe.div(n),D=tt(_,C),A=b(D.x,D.y).div(n).toVar();if(this.Inputs[0].IsConnected){const E=(($=this.Inputs[0].Links[0].In)==null?void 0:$.Value)(A).toVar();this.terrainHeight.element(xe).assign(E)}}),N=k(([_,C])=>{const D=u(C).toVar(),A=u(_).toVar();return A.assign(Ce(A,le(0),g.sub(le(1)))),D.assign(Ce(D,le(0),w.sub(le(1)))),D.mul(g).add(A)}),M=k(([_,C])=>{const D=u(C).toVar(),A=b(_).toVar(),$=u(J(.01,Se(pe(u(D).mul(12.9898)).mul(43758.5453)).mul(2).sub(1))).toVar();return At(A.add(b($)))});k(([_,C,D])=>{const A=le(D).toVar(),$=u(C).toVar(),Y=u(_).toVar(),E=u(N(Y,$)).toVar(),ae=u(this.tempWaterVolume.element(E).add(r.mul(o))).toVar(),se=u(this.tempSedimentAmount.element(E)).toVar(),ie=u(this.tempTerrainHeight.element(E)).toVar(),Ze=b(b(this.tempTerrainHeight.element(N(Y.add(1),$)).sub(this.tempTerrainHeight.element(N(Y.sub(1),$))),this.tempTerrainHeight.element(N(Y,$.add(1))).sub(this.tempTerrainHeight.element(N(Y,$.sub(1))))).mul(.5)).toVar(),He=u(st(Ze)).toVar();Qe(ae.greaterThan(0).and(He.greaterThan(0)),()=>{const $e=b(M(Ze,A)).toVar(),Ke=u(oe(ae,He.mul(f).mul(o))).toVar(),Pe=u(oe(ae,Ke)).toVar(),Re=Xe(Xe(Y,$).add(Xe(kt($e)))).toVar(),De=le(N(Re.x,Re.y)).toVar();this.tempWaterVolume.element(De).addAssign(Pe),ae.subAssign(Pe);const _e=u(ve(He,p).mul(Pe).mul(h)).toVar();Qe(se.lessThan(_e),()=>{const Ue=u(oe(_e.sub(se).mul(d),ie.sub(this.tempTerrainHeight.element(De)))).toVar();se.addAssign(Ue),this.tempTerrainHeight.element(E).assign(ie.sub(Ue))}).Else(()=>{const Ue=u(se.sub(_e).mul(l)).toVar();se.subAssign(Ue),this.tempTerrainHeight.element(E).assign(ie.add(Ue))});const xt=u(se.mul(Pe).div(ae)).toVar();this.tempSedimentAmount.element(De).addAssign(xt),se.subAssign(xt)}),ae.mulAssign(U(1,c.mul(o))),se.assign(ve(0,se)),this.tempWaterVolume.element(E).assign(ae),this.tempSedimentAmount.element(E).assign(se)});const X=k(([_,C])=>{const D=le(C).toVar(),A=tt(_.x,_.y).toVar();return A.y.mul(D).add(A.x)});k(()=>{this.tempTerrainHeight.element(xe).addAssign(.5)});const ee=k(()=>{const _=le(xe).toVar(),C=le(_.modInt(g)).toVar(),D=le(_.div(g)).toVar(),A=le(N(C,D)).toVar();this.tempTerrainHeight.element(A).assign(this.terrainHeight.element(A)),this.tempWaterVolume.element(A).assign(this.waterVolume.element(A)),this.tempSedimentAmount.element(A).assign(this.sedimentAmount.element(A)),dt(),St(y,()=>{const $=u(N(C,D)).toVar(),Y=u(this.tempWaterVolume.element($).add(r.mul(o))).toVar(),E=u(this.tempSedimentAmount.element($)).toVar(),ae=u(this.tempTerrainHeight.element($)).toVar(),se=b(b(this.tempTerrainHeight.element(N(C.add(1),D)).sub(this.tempTerrainHeight.element(N(C.sub(1),D))),this.tempTerrainHeight.element(N(C,D.add(1))).sub(this.tempTerrainHeight.element(N(C,D.sub(1))))).mul(.5)).toVar(),ie=u(st(se)).toVar();Qe(Y.greaterThan(0).and(ie.greaterThan(0)),()=>{const Ze=b(M(se,_)).toVar(),He=u(oe(Y,ie.mul(f).mul(o))).toVar(),$e=u(oe(Y,He)).toVar(),Ke=Xe(Xe(C,D).add(Xe(kt(Ze)))).toVar(),Pe=le(N(Ke.x,Ke.y)).toVar();this.tempWaterVolume.element(Pe).addAssign($e),Y.subAssign($e);const Re=u(ve(ie,p).mul($e).mul(h)).toVar();Qe(E.lessThan(Re),()=>{const _e=u(oe(Re.sub(E).mul(d),ae.sub(this.tempTerrainHeight.element(Pe)))).toVar();E.addAssign(_e),this.tempTerrainHeight.element($).assign(ae.sub(_e))}).Else(()=>{const _e=u(E.sub(Re).mul(l)).toVar();E.subAssign(_e),this.tempTerrainHeight.element($).assign(ae.add(_e))});const De=u(E.mul($e).div(Y)).toVar();this.tempSedimentAmount.element(Pe).addAssign(De),E.subAssign(De)}),Y.mulAssign(U(1,c.mul(o))),E.assign(ve(0,E)),this.tempWaterVolume.element($).assign(Y),this.tempSedimentAmount.element($).assign(E),dt(),this.terrainHeight.element($).assign(this.tempTerrainHeight.element($)),this.waterVolume.element($).assign(this.tempWaterVolume.element($)),this.sedimentAmount.element($).assign(this.tempSedimentAmount.element($)),dt()}),this.terrainHeight.element(A).assign(this.tempTerrainHeight.element(A)),this.waterVolume.element(A).assign(this.tempWaterVolume.element(A)),this.sedimentAmount.element(A).assign(this.tempSedimentAmount.element(A))}),fe=S().compute(n*n),de=ee().compute(n*n);s==null||s.GPURenderer.compute(fe),s==null||s.GPURenderer.computeAsync(de),this.Outputs[0].Value=k(([_])=>{if(this.Inputs[0].IsConnected){b(_.x,_.y).toVar();const C=xe.modInt(n),D=xe.div(n),A=tt(C,D);return this.terrainHeight.element(X(A,n)).toVar()}else return 0})}}class ki extends j{constructor(){super(...arguments);a(this,"Name","nodes.gradientNoise");a(this,"Outputs",[new G(!1,this,"Output")]);a(this,"Properties",[new P("Scale",10,0,100),new P("Offset X",0,0,100),new P("Offset Y",0,0,100)]);a(this,"IsRealtimeUpdate",!0);a(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value);this.Outputs[0].Value=k(([o])=>{const r=b(o.x,o.y).mul(t).toVar(),c=b(s,n).toVar();return r.addAssign(c),zt(r)})}}class Oi extends j{constructor(){super(...arguments);a(this,"Name","nodes.invert");a(this,"Inputs",[new G(!0,this,"Source")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate(),this.Outputs[0].Value=k(([t])=>{var n;if(!this.Inputs[0].IsConnected)return u(0);const s=(n=this.Inputs[0].Links[0].In)==null?void 0:n.Value(t);return u(1).sub(s)})}}class Li extends j{constructor(){super(...arguments);a(this,"Name","nodes.mountain");a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Scale",3.55,0,100,0,"Noise Transform","%"),new P("Octaves Count",10,1,50,1,"Noise Params",""),new P("Offset X",-.08,-100,100,0,"Noise Transform",""),new P("Offset Y",-.54,-100,100,0,"Noise Transform",""),new P("Falloff",3,0,20,0,"Mountain",""),new P("Height",1,0,1,0,"Mountain",""),new P("Position X",.5,0,1,0,"Mountain Transform",""),new P("Position Y",.5,0,1,0,"Mountain Transform","")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value),r=x(this.Properties[4].Value),c=x(this.Properties[5].Value),h=x(this.Properties[6].Value),d=x(this.Properties[7].Value);this.Outputs[0].Value=k(([l])=>{const f=b(l.x,l.y).toVar(),p=u(Yt(b(h,d),f)).mul(r).toVar(),y=B(u(1),u(0),p).toVar(),g=ot(Ce(y,0,1),2),w=f.sub(b(h,d).sub(.5)).toVar(),S=rt(w,s,b(n,o),t).toVar();return Ce(g.mul(S).mul(u(1.45).mul(c)),0,1)})}}class $i extends j{constructor(){super(...arguments);a(this,"Name","nodes.redistribution");a(this,"Inputs",[new G(!0,this,"Source")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Exponent",1,1,10)]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value);this.Outputs[0].Value=k(([s])=>{var o;return this.Inputs[0].IsConnected?((o=this.Inputs[0].Links[0].In)==null?void 0:o.Value(s)).pow(t):u(0)})}}class Ri extends j{constructor(){super(...arguments);a(this,"Name","nodes.terrace");a(this,"Inputs",[new G(!0,this,"Param 1")]);a(this,"Outputs",[new G(!1,this,"Output")]);a(this,"Properties",[new P("Smoothness",.1,0,1),new P("Count",3,0,100,1)]);a(this,"IsRealtimeUpdate",!0);a(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value);this.Outputs[0].Value=k(([n])=>{var o;if(this.Inputs[0].IsConnected){const c=((o=this.Inputs[0].Links[0].In)==null?void 0:o.Value)(n).toVar();if(this.Properties[1].Value==0)return c;const h=u(1).div(s).toVar(),d=Ye(c.div(h)).toVar(),l=c.sub(d.mul(h)).div(h).toVar(),f=oe(u(2).mul(l),u(1)).toVar(),p=d.add(f).mul(h).toVar(),y=ft(1,u(s)),g=Ye(c.div(y)),w=Se(c.div(y)),S=g.mul(y).add(We(0,1,w).mul(y));return B(p,S,t)}else return 0})}}class Di extends j{constructor(){super(...arguments);a(this,"Name","nodes.voronoi");a(this,"Outputs",[new G(!1,this,"Output"),new G(!1,this,"Cells"),new G(!1,this,"Bubbles")]);a(this,"Properties",[new P("Scale",10,1,100,0,"Transform","%"),new P("OffsetX",0,0,100,0,"Transform",""),new P("OffsetY",0,0,100,0,"Transform",""),new P("Angle",5,0,100,0,"Noise","")]);a(this,"IsRealtimeUpdate",!0);a(this,"DefaultOutput",0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value);this.Outputs[0].Value=k(([r])=>{const c=b(r.x,r.y).toVar(),h=b(s,n).toVar();c.addAssign(h);const d=ct({UV:c,angleOffset:o,cellDensity:t}).toVar();return ot(d.x,2)}),this.Outputs[1].Value=k(([r])=>{const c=b(r.x,r.y).toVar(),h=b(s,n).toVar();return c.addAssign(h),ct({UV:c,angleOffset:o,cellDensity:t}).toVar().y}),this.Outputs[2].Value=k(([r])=>{const c=b(r.x,r.y).toVar(),h=b(s,n).toVar();c.addAssign(h);const d=ct({UV:c,angleOffset:o,cellDensity:t}).toVar();return ks(ot(d.x,2))})}}class Ti extends j{constructor(){super(...arguments);a(this,"Name","nodes.transform");a(this,"Inputs",[new G(!0,this,"Input")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Properties",[new P("Scale X",1,0,100,0,"Scale",""),new P("Scale Y",1,0,100,0,"Scale",""),new P("Position X",0,-100,100,0,"Position",""),new P("Position Y",0,-100,100,0,"Position",""),new P("Midpoint X",.5,0,1,0,"Rotation",""),new P("Midpoint Y",.5,0,1,0,"Rotation",""),new P("Angle",0,-360,360,0,"Rotation","")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value),r=x(this.Properties[4].Value),c=x(this.Properties[5].Value),h=x(this.Properties[6].Value);this.Outputs[0].Value=k(([d])=>{var N;const l=b(d.x,d.y).toVar(),f=b(t,s).toVar(),p=b(n,o).toVar(),y=b(r,c).toVar(),g=h.mul(Et.div(180)).toVar(),w=b(nt(g).mul(l.x.sub(y.x)).add(pe(g).mul(l.y.sub(y.y))).add(y.x),nt(g).mul(l.y.sub(y.y)).sub(pe(g).mul(l.x.sub(y.x))).add(y.y));return l.assign(w),l.addAssign(p),l.mulAssign(f),(N=this.Inputs[0].Links[0].In)==null?void 0:N.Value(l).toVar()})}}class Ai extends j{constructor(){super(...arguments);a(this,"Inputs",[new G(!0,this,"Input")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Name","nodes.tile");a(this,"Properties",[new P("Tile Count",1,0,100,1),new P("Angle Threshold",0,0,360,0)]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value),s=x(this.Properties[1].Value);this.Outputs[0].Value=k(([n])=>{var d;var o=b(n).toVar(),r=s.mul(Et.div(180));const c=Pi(o,t,r).toVar();return(d=this.Inputs[0].Links[0].In)==null?void 0:d.Value(c).toVar()})}}class Gi extends j{constructor(){super(...arguments);a(this,"Inputs",[new G(!0,this,"Input")]);a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Name","nodes.height");a(this,"IsRealtimeUpdate",!0);a(this,"Properties",[new P("Height",1,0,100,0,"","%")])}Calculate(){this.BaseCalculate();const t=x(this.Properties[0].Value);this.Outputs[0].Value=k(([s])=>{var r;if(!this.Inputs[0].IsConnected)return u(0);var n=b(s).toVar();return((r=this.Inputs[0].Links[0].In)==null?void 0:r.Value(n).toVar()).mul(t.mul(.01))})}}class Xi extends j{constructor(){super(...arguments);a(this,"Name","nodes.distortion");a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Inputs",[new G(!0,this,"Input")]);a(this,"Properties",[new P("Distortion",0,0,100,0,"Distortion",""),new P("Octaves",10,0,100,1,"Distortion",""),new P("Scale",10,0,100,0,"Distortion",""),new P("Offset X",0,-100,100,0,"Distortion",""),new P("Offset Y",0,-100,100,0,"Distortion","")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();var t=x(this.Properties[0].Value),s=x(this.Properties[1].Value),n=x(this.Properties[2].Value),o=x(this.Properties[3].Value),r=x(this.Properties[4].Value);this.Outputs[0].Value=k(([c])=>{var h;if(this.Inputs[0].IsConnected){const d=(h=this.Inputs[0].Links[0].In)==null?void 0:h.Value,l=b(c.x,c.y).toVar(),f=b(rt(l.mul(2).mul(.5),s,b(o,r),n)).mul(t).mul(.2);return d(l.add(f)).toVar()}else return 0})}}class Bi extends j{constructor(){super(...arguments);a(this,"Name","nodes.dune");a(this,"Outputs",[new G(!1,this,"Result")]);a(this,"Inputs",[]);a(this,"Properties",[new P("Scale",0,0,0,0,"Tramsform","%"),new P("Height",0,0,0,0,"Tramsform","%"),new P("Wind Direction",0,0,0,0,"Tramsform","%"),new P("Octaves",0,0,0,0,"Noise","%"),new P("Sand Roughness",0,0,0,0,"Noise","%"),new P("Seed",0,0,0,0,"Random","%"),new P("Time",0,0,0,0,"Random","%")]);a(this,"IsRealtimeUpdate",!0)}Calculate(){this.BaseCalculate();const t=x(this.Properties[6].Value),s=x(this.Properties[5].Value),n=x(this.Properties[0].Value),o=x(this.Properties[1].Value),r=x(this.Properties[4].Value),c=x(this.Properties[2].Value);x(this.Properties[3].Value);const h=k(([y])=>{const g=y.toVar();return g.assign(b(Ie(g,b(127.1,311.7)),Ie(g,b(269.5,183.3)))),u(-1).add(J(2,Se(pe(g.x.add(g.y)).mul(u(43758.5453123)))))}),d=k(([y])=>{const g=Ye(y),w=Se(y),S=w.mul(w).mul(U(3,J(2,w))),N=h(g),M=h(g.add(b(1,0))),X=h(g.add(b(0,1))),ee=h(g.add(b(1,1)));return B(B(N,M,S.x),B(X,ee,S.x),S.y)}),l=k(([y,g,w])=>{const S=u(0),N=u(1),M=u(1),X=u(0);return St(g,({i:ee})=>{S.addAssign(N.mul(d(y.mul(M).add(s)))),X.addAssign(N),N.mulAssign(w),M.mulAssign(2)}),S.div(X)}),f=k(([y,g])=>U(1,Ee(pe(y.mul(3.14159).mul(g))))),p=k(([y,g])=>{const w=b(nt(g),pe(g)),S=l(y.mul(n).add(w.mul(.5)),4,.5);b(w.y.negate(),w.x);const N=pe(y.x.mul(n).mul(.3).add(d(y.mul(2)).mul(2))).mul(pe(y.y.mul(n).mul(.2))).mul(.3),M=S.mul(.7).add(N.mul(.3));M.assign(B(M,f(M,1.5),.4));const X=l(y.mul(n).mul(4),2,.3).mul(r);return M.add(X.mul(.1))});this.Outputs[0].Value=k(([y])=>{const g=y,w=b(t.mul(.01),0),S=p(g.mul(b(2,1)).add(w),c);return S.assign(S.mul(.5).add(.5).mul(o)),S})}}function Yi(){Z.registerStr("nodes.buffer","",Me),Z.registerStr("nodes.fake","",Ci),Z.registerStr("nodes.constant","nodeCategories.testNodes",yi),Z.registerStr("nodes.perlinNoise","nodeCategories.testNodes",en),Z.registerStr("nodes.mountain","nodeCategories.testNodes",Li),Z.registerStr("nodes.terrace","nodeCategories.testNodes",Ri),Z.registerStr("nodes.combine","nodeCategories.testNodes",Vi),Z.registerStr("nodes.clamp","nodeCategories.testNodes",wi),Z.registerStr("nodes.invert","nodeCategories.testNodes",Oi),Z.registerStr("nodes.redistribution","nodeCategories.testNodes",$i),Z.registerStr("nodes.gradientNoise","nodeCategories.testNodes",ki),Z.registerStr("nodes.voronoi","nodeCategories.testNodes",Di),Z.registerStr("nodes.crater","nodeCategories.testNodes",Ii),Z.registerStr("nodes.falloff","nodeCategories.testNodes",Ni),Z.registerStr("nodes.fastErosion","nodeCategories.testNodes",Mi),Z.registerStr("nodes.cracks","nodeCategories.testNodes",Si),Z.registerStr("nodes.transform","nodeCategories.testNodes",Ti),Z.registerStr("nodes.tile","nodeCategories.testNodes",Ai),Z.registerStr("nodes.height","nodeCategories.testNodes",Gi),Z.registerStr("nodes.distortion","nodeCategories.testNodes",Xi),Z.registerStr("nodes.dune","nodeCategories.testNodes",Bi)}const Ei={en:{"":"",logo:"Mashuk",windows:{thirdPreview:"3D Preview",secondPreview:"2D Preview",properties:"Node properties",graph:"Graph",nodesList:"Nodes list"},tt:{undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",delete:"Delete node/selected",fullscreen:"Fullscreen",save:"Save",load:"Load",presets:"Presets",resetView:"Reset view",resetParams:"Reset node parameters to default",lockPreview:"Lock Preview",unlockPreview:"Unlock Preview",mesh_resolution:"Resolution",new:"New project",settings:"Settings",menu:"Menu",resolutionWarning:"Warning! Selecting a high resolution will increase video memory consumption and processing speed.",build:"Build"},hints:{graphLmb:"LMB: Select/Drag node",graphWheel:"Wheel: Zoom/Drag work space",placeHere:"PLACE HERE"},nodes:{constant:"Constant",perlinNoise:"Perlin Noise",mountain:"Mountain",terrace:"Terrace",combine:"Combine",clamp:"Clamp",invert:"Invert",redistribution:"Redistribution",gradientNoise:"Gradient Noise",voronoi:"Voronoi",crater:"Crater",falloff:"Falloff",fastErosion:"Fast Erosion",cracks:"Cracks",transform:"Transform",tile:"Tile",height:"Height",distortion:"Distortion",dune:"Dunes"},nodeCategories:{testNodes:"Test nodes"}},ru:{logo:"Машук",windows:{thirdPreview:"3D Просмотр",secondPreview:"2D Просмотр",properties:"Параметры узла",graph:"Граф",nodesList:"Список узлов"},tt:{undo:"Отменить",redo:"Повторить",copy:"Копировать",paste:"Вставить",delete:"Удалить узел/выделенные",fullscreen:"На весь экран",save:"Сохранить",load:"Загрузить",presets:"Предустановки",resetView:"Сбросить вид",resetParams:"Сбросить параметры узла до значений по умолчанию",lockPreview:"Закрепить отображение",unlockPreview:"Открепить отображение",mesh_resolution:"Разрешение",new:"Новый проект",settings:"Настройки",menu:"Меню",resolutionWarning:"Внимание! Выбор высокого разрешения влечет за собой увеличение потребления видеопамяти и скорости обработки",build:"Сборка"},hints:{graphLmb:"ЛКМ: Выделить/Передвинуть узел",graphWheel:"Колесо мыши: Приближение/Перемещение рабочей области",placeHere:"РАЗМЕСТИТЕ СЗЕСЬ"},nodes:{constant:"Константа",perlinNoise:"Шум Перлина",mountain:"Гора",terrace:"Террасы",combine:"Комбинирование",clamp:"Ограничение",invert:"Инверсия",redistribution:"Перераспределение",gradientNoise:"Градиентный Шум",voronoi:"Шум Вороного",crater:"Кратер",falloff:"Спад",fastErosion:"Быстрая Эрозия",cracks:"Трещины",transform:"Преобразование",tile:"Плитка",height:"Высота",distortion:"Искажения",dune:"Дюны"},nodeCategories:{testNodes:"Тестовые узлы"}}};yt.options.themes.tooltip.delay.show=0;yt.options.distance=10;ss.add(Os,ns);const Hi=os({legacy:!1,locale:"en",fallbackLocale:"en",messages:Ei}),Le=is(Ts);Le.component("font-awesome-icon",as);Le.use(rs());Le.use(gi);Le.use(yt);Le.use(Hi);Le.use(ls);Le.mount("#app");Yi();
